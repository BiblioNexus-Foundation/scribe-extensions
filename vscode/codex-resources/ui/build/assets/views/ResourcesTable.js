import{r as f,j as e,a as l,v as n,M as d,k as y,l as w,V as p}from"../index.js";const T=()=>{var h;const{resourcesTypes:s}=S(),c=l.useRef(!1),[t,r]=l.useState(((h=s[0])==null?void 0:h.value)??""),{resourceTableData:o}=N(),{downloadedResources:R}=_();l.useEffect(()=>{n.postMessage({type:d.SET_CURRENT_RESOURCE_TYPE,payload:{resourceType:t}})},[t]),l.useEffect(()=>{if(s.length!==0&&!c.current){c.current=!0,r(s[0].value);return}},[s]);const x=(a,u)=>{n.postMessage({type:d.DOWNLOAD_RESOURCE,payload:{fullResource:a.fullResource,resourceType:u}})},j=a=>{a&&n.postMessage({type:d.OPEN_RESOURCE,payload:{resource:a}})},{importedOfflineResource:i,handleImportResource:m,handleAddResource:E}=D();return e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between w-full",children:["Filter Resources",e.jsx(y,{className:"w-1/2",onInput:a=>{r(a.target.value)},children:s.map(a=>e.jsx(w,{onClick:()=>r(a.value),children:a.label}))})]}),i?e.jsxs("div",{className:"flex flex-col",children:[e.jsx("h1",{children:"Selected Resource:"}),e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("p",{children:["Name: ",i.metadata.name]}),e.jsxs("p",{children:["ID: ",i.metadata.id]}),e.jsxs("p",{children:["Version: ",i.metadata.version]}),e.jsxs("p",{children:["Path: ",i.path]}),e.jsx(p,{onClick:()=>E(t),children:e.jsx("i",{className:"codicon codicon-cloud-upload"})})]})]}):e.jsxs("div",{className:"flex justify-between mt-2",children:[e.jsx("div",{className:"min-w-2",children:"Import Resources"}),e.jsx(p,{onClick:()=>{m({selectedResourceType:t})},className:"min-w-28",children:e.jsx("i",{className:"codicon codicon-cloud-upload"})})]}),e.jsxs("table",{className:"table-auto w-full",children:[e.jsx("thead",{className:"font-semibold",children:e.jsxs("tr",{children:[e.jsx("td",{children:"Resource"}),e.jsx("td",{children:"Owner"}),e.jsx("td",{children:"Version"}),e.jsx("td",{})]})}),e.jsx("tbody",{className:"gap-3",children:o==null?void 0:o.map(a=>e.jsxs("tr",{children:[e.jsx("td",{children:a.name}),e.jsx("td",{children:a.owner.avatarUrl?e.jsx("img",{src:a.owner.avatarUrl,alt:a.owner.name,className:"w-8 h-8 rounded-lg object-contain"}):a.owner.name}),e.jsx("td",{title:`Released on : ${new Date(a.version.releaseDate).toLocaleDateString()}`,children:a.version.tag}),e.jsx("td",{className:"flex items-center justify-center px-2",children:R.find(u=>u.id===a.id)?e.jsx(p,{title:"Open Resource",appearance:"primary",className:"w-full",onClick:()=>j(R.find(u=>u.id===a.id)),children:e.jsx("i",{className:"codicon codicon-eye"})}):e.jsx(p,{title:"Download Resource",appearance:"secondary",className:"w-full",onClick:()=>x(a,a.resourceType),children:e.jsx("i",{className:"codicon codicon-cloud-download"})})})]}))})]})]})};f(e.jsx(T,{}));const S=()=>{const[s,c]=l.useState([]);return l.useEffect(()=>{n.setMessageListeners(t=>{switch(t.data.type){case"SET_RESOURCES_TYPES":c(t.data.payload.resourcesTypes??[]);break}}),n.postMessage({type:d.INIT_DATA,payload:{}})},[]),{resourcesTypes:s,setResourcesTypes:c}},N=()=>{const[s,c]=l.useState([]);return l.useEffect(()=>{n.setMessageListeners(t=>{switch(t.data.type){case"SET_RESOURCE_TABLE_DATA":c(t.data.payload.tableData??[]);break}})},[]),{resourceTableData:s}},_=()=>{const[s,c]=l.useState([]);return l.useEffect(()=>{n.setMessageListeners(t=>{switch(t.data.type){case"SET_DOWNLOADED_RESOURCES":c(t.data.payload.downloadedResources??[]);break}})},[]),{downloadedResources:s}},D=()=>{const[s,c]=l.useState(null),t=({selectedResourceType:o})=>{n.postMessage({type:d.GET_OFFLINE_RESOURCE_IMPORT_URI,payload:{selectedResourceType:o}})},r=o=>{n.postMessage({type:d.ADD_OFFLINE_RESOURCE,payload:{path:s==null?void 0:s.path,fsPath:s==null?void 0:s.fsPath,metadata:s==null?void 0:s.metadata,selectedResourceType:o}}),c(null)};return l.useEffect(()=>{n.setMessageListeners(o=>{switch(o.data.type){case d.SET_OFFLINE_RESOURCE_IMPORT_URI:c(o.data.payload??null);break}})},[]),{importedOfflineResource:s,handleImportResource:t,handleAddResource:r}};
