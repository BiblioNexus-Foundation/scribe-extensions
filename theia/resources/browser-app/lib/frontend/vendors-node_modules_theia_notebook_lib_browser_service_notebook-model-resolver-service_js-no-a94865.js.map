{"version":3,"file":"vendors-node_modules_theia_notebook_lib_browser_service_notebook-model-resolver-service_js-no-a94865.js","mappings":"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CnC;;;;;;;;;;;AC5DY;;AAEb,8CAA6C;AAC7C;AACA,CAAC,EAAC;;AAEF,iBAAiB,mBAAO,CAAC,6EAAa;;AAEtC;;AAEA,uCAAuC,uCAAuC;;AAE9E,kBAAe;AACf;;;;;;;;;;ACba;;AAEb,8CAA6C;AAC7C;AACA,CAAC,EAAC;;AAEF,oDAAoD,gBAAgB,sBAAsB,OAAO,2BAA2B,0BAA0B,yDAAyD,iCAAiC;;AAEhP,iCAAiC,2CAA2C,gBAAgB,kBAAkB,OAAO,2BAA2B,wDAAwD,gCAAgC,uDAAuD,+DAA+D,yDAAyD,qEAAqE,6DAA6D,wBAAwB;;AAEjjB,aAAa,mBAAO,CAAC,6CAAO;;AAE5B;;AAEA,iBAAiB,mBAAO,CAAC,uDAAY;;AAErC,wBAAwB,mBAAO,CAAC,0FAAmB;;AAEnD;;AAEA,uCAAuC,uCAAuC;;AAE9E,+CAA+C,iBAAiB,qBAAqB,oCAAoC,6DAA6D,sBAAsB;;AAE5M,kDAAkD,0CAA0C;;AAE5F,kDAAkD,aAAa,yFAAyF;;AAExJ,2CAA2C,+DAA+D,uGAAuG,yEAAyE,eAAe,0EAA0E,GAAG;;AAEtX;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA,GAAG;AACH;AACA;AACA;;;AAGA;AACA;AACA,OAAO;;AAEP;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA,mBAAmB,mCAAmC;AACtD;AACA;AACA;AACA,GAAG;;AAEH;AACA,CAAC;;AAED,kBAAe;;;AAGf;AACA;AACA;AACA;AACA;AACA,0CAA0C;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","sources":["webpack:///../node_modules/@theia/monaco/src/browser/simple-monaco-editor.ts?","webpack:///../node_modules/@theia/notebook/src/browser/contributions/cell-operations.ts?","webpack:///../node_modules/@theia/notebook/src/browser/contributions/notebook-actions-contribution.ts?","webpack:///../node_modules/@theia/notebook/src/browser/contributions/notebook-cell-actions-contribution.ts?","webpack:///../node_modules/@theia/notebook/src/browser/contributions/notebook-context-keys.ts?","webpack:///../node_modules/@theia/notebook/src/browser/contributions/notebook-preferences.ts?","webpack:///../node_modules/@theia/notebook/src/browser/notebook-editor-widget.tsx?","webpack:///../node_modules/@theia/notebook/src/browser/notebook-open-handler.ts?","webpack:///../node_modules/@theia/notebook/src/browser/notebook-output-utils.ts?","webpack:///../node_modules/@theia/notebook/src/browser/notebook-renderer-registry.ts?","webpack:///../node_modules/@theia/notebook/src/browser/notebook-type-registry.ts?","webpack:///../node_modules/@theia/notebook/src/browser/renderers/cell-output-webview.ts?","webpack:///../node_modules/@theia/notebook/src/browser/service/notebook-clipboard-service.ts?","webpack:///../node_modules/@theia/notebook/src/browser/service/notebook-context-manager.ts?","webpack:///../node_modules/@theia/notebook/src/browser/service/notebook-editor-widget-service.ts?","webpack:///../node_modules/@theia/notebook/src/browser/service/notebook-execution-service.ts?","webpack:///../node_modules/@theia/notebook/src/browser/service/notebook-execution-state-service.ts?","webpack:///../node_modules/@theia/notebook/src/browser/service/notebook-kernel-history-service.ts?","webpack:///../node_modules/@theia/notebook/src/browser/service/notebook-kernel-quick-pick-service.ts?","webpack:///../node_modules/@theia/notebook/src/browser/service/notebook-kernel-service.ts?","webpack:///../node_modules/@theia/notebook/src/browser/service/notebook-model-resolver-service.ts?","webpack:///../node_modules/@theia/notebook/src/browser/service/notebook-monaco-text-model-service.ts?","webpack:///../node_modules/@theia/notebook/src/browser/service/notebook-options.ts?","webpack:///../node_modules/@theia/notebook/src/browser/service/notebook-renderer-messaging-service.ts?","webpack:///../node_modules/@theia/notebook/src/browser/service/notebook-service.ts?","webpack:///../node_modules/@theia/notebook/src/browser/view-model/notebook-cell-model.ts?","webpack:///../node_modules/@theia/notebook/src/browser/view-model/notebook-cell-output-model.ts?","webpack:///../node_modules/@theia/notebook/src/browser/view-model/notebook-model.ts?","webpack:///../node_modules/@theia/notebook/src/browser/view/notebook-cell-editor.tsx?","webpack:///../node_modules/@theia/notebook/src/browser/view/notebook-cell-list-view.tsx?","webpack:///../node_modules/@theia/notebook/src/browser/view/notebook-cell-toolbar-factory.tsx?","webpack:///../node_modules/@theia/notebook/src/browser/view/notebook-cell-toolbar.tsx?","webpack:///../node_modules/@theia/notebook/src/browser/view/notebook-code-cell-view.tsx?","webpack:///../node_modules/@theia/notebook/src/browser/view/notebook-main-toolbar.tsx?","webpack:///../node_modules/@theia/notebook/src/browser/view/notebook-markdown-cell-view.tsx?","webpack:///../node_modules/@theia/notebook/src/browser/view/notebook-viewport-service.ts?","webpack:///../node_modules/react-perfect-scrollbar/lib/index.js?","webpack:///../node_modules/react-perfect-scrollbar/lib/scrollbar.js?"],"sourcesContent":["// *****************************************************************************\n// Copyright (C) 2023 TypeFox and others.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\n\nimport { EditorServiceOverrides, MonacoEditor, MonacoEditorServices } from './monaco-editor';\n\nimport { CodeEditorWidget, ICodeEditorWidgetOptions } from '@theia/monaco-editor-core/esm/vs/editor/browser/widget/codeEditorWidget';\nimport { IInstantiationService } from '@theia/monaco-editor-core/esm/vs/platform/instantiation/common/instantiation';\nimport { StandaloneServices } from '@theia/monaco-editor-core/esm/vs/editor/standalone/browser/standaloneServices';\nimport { ServiceCollection } from '@theia/monaco-editor-core/esm/vs/platform/instantiation/common/serviceCollection';\nimport { Disposable, DisposableCollection, Emitter, TextDocumentContentChangeDelta, URI } from '@theia/core';\nimport { MonacoEditorModel } from './monaco-editor-model';\nimport { Dimension, EditorMouseEvent, MouseTarget, Position, TextDocumentChangeEvent } from '@theia/editor/lib/browser';\nimport * as monaco from '@theia/monaco-editor-core';\nimport { ElementExt } from '@theia/core/shared/@phosphor/domutils';\n\nexport class SimpleMonacoEditor extends MonacoEditorServices implements Disposable {\n\n    protected editor: CodeEditorWidget;\n    protected readonly toDispose = new DisposableCollection();\n\n    protected readonly onCursorPositionChangedEmitter = new Emitter<Position>();\n    protected readonly onSelectionChangedEmitter = new Emitter<Range>();\n    protected readonly onFocusChangedEmitter = new Emitter<boolean>();\n    protected readonly onDocumentContentChangedEmitter = new Emitter<TextDocumentChangeEvent>();\n    readonly onDocumentContentChanged = this.onDocumentContentChangedEmitter.event;\n    protected readonly onMouseDownEmitter = new Emitter<EditorMouseEvent>();\n    protected readonly onLanguageChangedEmitter = new Emitter<string>();\n    readonly onLanguageChanged = this.onLanguageChangedEmitter.event;\n    protected readonly onScrollChangedEmitter = new Emitter<void>();\n    readonly onEncodingChanged = this.document.onDidChangeEncoding;\n    protected readonly onResizeEmitter = new Emitter<Dimension | null>();\n    readonly onDidResize = this.onResizeEmitter.event;\n    readonly onDidChangeReadOnly = this.document.onDidChangeReadOnly;\n\n    constructor(\n        readonly uri: URI,\n        readonly document: MonacoEditorModel,\n        readonly node: HTMLElement,\n        services: MonacoEditorServices,\n        options?: MonacoEditor.IOptions,\n        override?: EditorServiceOverrides,\n        widgetOptions?: ICodeEditorWidgetOptions\n    ) {\n        super(services);\n        this.toDispose.pushAll([\n            this.onCursorPositionChangedEmitter,\n            this.onSelectionChangedEmitter,\n            this.onFocusChangedEmitter,\n            this.onDocumentContentChangedEmitter,\n            this.onMouseDownEmitter,\n            this.onLanguageChangedEmitter,\n            this.onScrollChangedEmitter\n        ]);\n        this.toDispose.push(this.create({\n            ...MonacoEditor.createReadOnlyOptions(document.readOnly),\n            ...options\n        }, override, widgetOptions));\n        this.addHandlers(this.editor);\n        this.editor.setModel(document.textEditorModel);\n    }\n\n    getControl(): CodeEditorWidget {\n        return this.editor;\n    }\n\n    protected create(options?: MonacoEditor.IOptions, override?: EditorServiceOverrides, widgetOptions?: ICodeEditorWidgetOptions): Disposable {\n        const combinedOptions = {\n            ...options,\n            lightbulb: { enabled: true },\n            fixedOverflowWidgets: true,\n            automaticLayout: true,\n            scrollbar: {\n                useShadows: false,\n                verticalHasArrows: false,\n                horizontalHasArrows: false,\n                verticalScrollbarSize: 10,\n                horizontalScrollbarSize: 10,\n                ...options?.scrollbar,\n            }\n        };\n        const instantiator = this.getInstantiatorWithOverrides(override);\n        return this.editor = instantiator.createInstance(CodeEditorWidget, this.node, {\n            ...combinedOptions,\n            dimension: {\n                width: 0,\n                height: 0\n            },\n        }, widgetOptions ?? {});\n    }\n\n    protected addHandlers(codeEditor: CodeEditorWidget): void {\n        this.toDispose.push(codeEditor.onDidChangeModelLanguage(e =>\n            this.fireLanguageChanged(e.newLanguage)\n        ));\n        this.toDispose.push(codeEditor.onDidChangeConfiguration(() => this.refresh()));\n        this.toDispose.push(codeEditor.onDidChangeModel(() => this.refresh()));\n        this.toDispose.push(codeEditor.onDidChangeModelContent(e => {\n            this.refresh();\n            this.onDocumentContentChangedEmitter.fire({ document: this.document, contentChanges: e.changes.map(this.mapModelContentChange.bind(this)) });\n        }));\n        this.toDispose.push(codeEditor.onMouseDown(e => {\n            const { element, position, range } = e.target;\n            this.onMouseDownEmitter.fire({\n                target: {\n                    ...(e.target as unknown as MouseTarget),\n                    element: element || undefined,\n                    mouseColumn: this.m2p.asPosition(undefined, e.target.mouseColumn).character,\n                    range: range && this.m2p.asRange(range) || undefined,\n                    position: position && this.m2p.asPosition(position.lineNumber, position.column) || undefined,\n                    detail: undefined\n                },\n                event: e.event.browserEvent\n            });\n        }));\n        this.toDispose.push(codeEditor.onDidScrollChange(e => {\n            this.onScrollChangedEmitter.fire(undefined);\n        }));\n        this.toDispose.push(this.onDidChangeReadOnly(readOnly => {\n            codeEditor.updateOptions(MonacoEditor.createReadOnlyOptions(readOnly));\n        }));\n    }\n\n    setLanguage(languageId: string): void {\n        monaco.editor.setModelLanguage(this.document.textEditorModel, languageId);\n    }\n\n    protected fireLanguageChanged(languageId: string): void {\n        this.onLanguageChangedEmitter.fire(languageId);\n    }\n\n    protected getInstantiatorWithOverrides(override?: EditorServiceOverrides): IInstantiationService {\n        const instantiator = StandaloneServices.get(IInstantiationService);\n        if (override) {\n            const overrideServices = new ServiceCollection(...override);\n            return instantiator.createChild(overrideServices);\n        }\n        return instantiator;\n    }\n\n    protected mapModelContentChange(change: monaco.editor.IModelContentChange): TextDocumentContentChangeDelta {\n        return {\n            range: this.m2p.asRange(change.range),\n            rangeLength: change.rangeLength,\n            text: change.text\n        };\n    }\n\n    refresh(): void {\n        this.autoresize();\n    }\n\n    resizeToFit(): void {\n        this.autoresize();\n        // eslint-disable-next-line no-null/no-null\n        this.onResizeEmitter.fire(null);\n    }\n\n    setSize(dimension: Dimension): void {\n        this.resize(dimension);\n        this.onResizeEmitter.fire(dimension);\n    }\n\n    protected autoresize(): void {\n        this.resize();\n    }\n\n    protected resize(dimension?: Dimension): void {\n        if (this.node) {\n            const layoutSize = this.computeLayoutSize(this.node, dimension);\n            this.editor.layout(layoutSize);\n        }\n    }\n\n    protected computeLayoutSize(hostNode: HTMLElement, dimension: monaco.editor.IDimension | undefined): monaco.editor.IDimension {\n        if (dimension && dimension.width >= 0 && dimension.height >= 0) {\n            return dimension;\n        }\n        const boxSizing = ElementExt.boxSizing(hostNode);\n\n        const width = (!dimension || dimension.width < 0) ?\n            this.getWidth(hostNode, boxSizing) :\n            dimension.width;\n\n        const height = (!dimension || dimension.height < 0) ?\n            this.getHeight(hostNode, boxSizing) :\n            dimension.height;\n\n        return { width, height };\n    }\n\n    protected getWidth(hostNode: HTMLElement, boxSizing: ElementExt.IBoxSizing): number {\n        return hostNode.offsetWidth - boxSizing.horizontalSum;\n    }\n\n    protected getHeight(hostNode: HTMLElement, boxSizing: ElementExt.IBoxSizing): number {\n        return this.editor.getContentHeight();\n    }\n\n    dispose(): void {\n        this.toDispose.dispose();\n    }\n\n}\n","// *****************************************************************************\n// Copyright (C) 2023 TypeFox and others.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\n\nimport { CellEditType, CellKind } from '../../common';\nimport { NotebookCellModel } from '../view-model/notebook-cell-model';\nimport { NotebookModel } from '../view-model/notebook-model';\n\n/**\n * a collection of different reusable notbook cell operations\n */\n\nexport function changeCellType(notebookModel: NotebookModel, cell: NotebookCellModel, type: CellKind): void {\n    if (cell.cellKind === type) {\n        return;\n    }\n    notebookModel.applyEdits([{\n        editType: CellEditType.Replace,\n        index: notebookModel.cells.indexOf(cell),\n        count: 1,\n        cells: [{\n            ...cell.getData(),\n            cellKind: type\n        }]\n    }], true);\n}\n","// *****************************************************************************\n// Copyright (C) 2023 TypeFox and others.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\n\nimport { Command, CommandContribution, CommandHandler, CommandRegistry, CompoundMenuNodeRole, MenuContribution, MenuModelRegistry, nls, URI } from '@theia/core';\nimport { inject, injectable } from '@theia/core/shared/inversify';\nimport { ApplicationShell, codicon, CommonCommands, KeybindingContribution, KeybindingRegistry } from '@theia/core/lib/browser';\nimport { NotebookModel } from '../view-model/notebook-model';\nimport { NotebookService } from '../service/notebook-service';\nimport { CellEditType, CellKind, NotebookCommand } from '../../common';\nimport { NotebookKernelQuickPickService } from '../service/notebook-kernel-quick-pick-service';\nimport { NotebookExecutionService } from '../service/notebook-execution-service';\nimport { NotebookEditorWidget } from '../notebook-editor-widget';\nimport { NotebookEditorWidgetService } from '../service/notebook-editor-widget-service';\nimport { NOTEBOOK_CELL_CURSOR_FIRST_LINE, NOTEBOOK_CELL_CURSOR_LAST_LINE, NOTEBOOK_CELL_FOCUSED, NOTEBOOK_EDITOR_FOCUSED, NOTEBOOK_HAS_OUTPUTS } from './notebook-context-keys';\nimport { NotebookClipboardService } from '../service/notebook-clipboard-service';\nimport { ContextKeyService } from '@theia/core/lib/browser/context-key-service';\n\nexport namespace NotebookCommands {\n    export const ADD_NEW_CELL_COMMAND = Command.toDefaultLocalizedCommand({\n        id: 'notebook.add-new-cell',\n        iconClass: codicon('add')\n    });\n\n    export const ADD_NEW_MARKDOWN_CELL_COMMAND = Command.toDefaultLocalizedCommand({\n        id: 'notebook.add-new-markdown-cell',\n        iconClass: codicon('add'),\n        tooltip: nls.localizeByDefault('Add Markdown Cell')\n    } as NotebookCommand);\n\n    export const ADD_NEW_CODE_CELL_COMMAND = Command.toDefaultLocalizedCommand({\n        id: 'notebook.add-new-code-cell',\n        iconClass: codicon('add'),\n        tooltip: nls.localizeByDefault('Add Code Cell')\n    } as NotebookCommand);\n\n    export const SELECT_KERNEL_COMMAND = Command.toDefaultLocalizedCommand({\n        id: 'notebook.selectKernel',\n        category: 'Notebook',\n        iconClass: codicon('server-environment')\n    });\n\n    export const EXECUTE_NOTEBOOK_COMMAND = Command.toDefaultLocalizedCommand({\n        id: 'notebook.execute',\n        category: 'Notebook',\n        iconClass: codicon('run-all')\n    });\n\n    export const CLEAR_ALL_OUTPUTS_COMMAND = Command.toDefaultLocalizedCommand({\n        id: 'notebook.clear-all-outputs',\n        category: 'Notebook',\n        iconClass: codicon('clear-all')\n    });\n\n    export const CHANGE_SELECTED_CELL = Command.toDefaultLocalizedCommand({\n        id: 'notebook.change-selected-cell',\n        category: 'Notebook',\n    });\n\n    export const CUT_SELECTED_CELL = Command.toDefaultLocalizedCommand({\n        id: 'notebook.cell.cut',\n        category: 'Notebook',\n    });\n\n    export const COPY_SELECTED_CELL = Command.toDefaultLocalizedCommand({\n        id: 'notebook.cell.copy',\n        category: 'Notebook',\n    });\n\n    export const PASTE_CELL = Command.toDefaultLocalizedCommand({\n        id: 'notebook.cell.paste',\n        category: 'Notebook',\n    });\n}\n\nexport enum CellChangeDirection {\n    Up = 'up',\n    Down = 'down'\n}\n\n@injectable()\nexport class NotebookActionsContribution implements CommandContribution, MenuContribution, KeybindingContribution {\n\n    @inject(NotebookService)\n    protected notebookService: NotebookService;\n\n    @inject(NotebookKernelQuickPickService)\n    protected notebookKernelQuickPickService: NotebookKernelQuickPickService;\n\n    @inject(NotebookExecutionService)\n    protected notebookExecutionService: NotebookExecutionService;\n\n    @inject(ApplicationShell)\n    protected shell: ApplicationShell;\n\n    @inject(NotebookEditorWidgetService)\n    protected notebookEditorWidgetService: NotebookEditorWidgetService;\n\n    @inject(NotebookClipboardService)\n    protected notebookClipboardService: NotebookClipboardService;\n\n    @inject(ContextKeyService)\n    protected contextKeyService: ContextKeyService;\n\n    registerCommands(commands: CommandRegistry): void {\n        commands.registerCommand(NotebookCommands.ADD_NEW_CELL_COMMAND, {\n            execute: (notebookModel: NotebookModel, cellKind: CellKind = CellKind.Markup, index?: number | 'above' | 'below') => {\n                notebookModel = notebookModel ?? this.notebookEditorWidgetService.focusedEditor?.model;\n\n                let insertIndex: number = 0;\n                if (typeof index === 'number' && index >= 0) {\n                    insertIndex = index;\n                } else if (notebookModel.selectedCell && typeof index === 'string') {\n                    // if index is -1 insert below otherwise at the index of the selected cell which is above the selected.\n                    insertIndex = notebookModel.cells.indexOf(notebookModel.selectedCell) + (index === 'below' ? 1 : 0);\n                }\n\n                let cellLanguage: string = 'markdown';\n                if (cellKind === CellKind.Code) {\n                    const firstCodeCell = notebookModel.cells.find(cell => cell.cellKind === CellKind.Code);\n                    cellLanguage = firstCodeCell?.language ?? 'plaintext';\n                }\n\n                notebookModel.applyEdits([{\n                    editType: CellEditType.Replace,\n                    index: insertIndex,\n                    count: 0,\n                    cells: [{\n                        cellKind,\n                        language: cellLanguage,\n                        source: '',\n                        outputs: [],\n                        metadata: {},\n                    }]\n                }], true);\n            }\n        });\n\n        commands.registerCommand(NotebookCommands.ADD_NEW_MARKDOWN_CELL_COMMAND, this.editableCommandHandler(\n            notebookModel => commands.executeCommand(NotebookCommands.ADD_NEW_CELL_COMMAND.id, notebookModel, CellKind.Markup, 'below')\n        ));\n\n        commands.registerCommand(NotebookCommands.ADD_NEW_CODE_CELL_COMMAND, this.editableCommandHandler(\n            notebookModel => commands.executeCommand(NotebookCommands.ADD_NEW_CELL_COMMAND.id, notebookModel, CellKind.Code, 'below')\n        ));\n\n        commands.registerCommand(NotebookCommands.SELECT_KERNEL_COMMAND, this.editableCommandHandler(\n            notebookModel => this.notebookKernelQuickPickService.showQuickPick(notebookModel)\n        ));\n\n        commands.registerCommand(NotebookCommands.EXECUTE_NOTEBOOK_COMMAND, this.editableCommandHandler(\n            notebookModel => this.notebookExecutionService.executeNotebookCells(notebookModel, notebookModel.cells)\n        ));\n\n        commands.registerCommand(NotebookCommands.CLEAR_ALL_OUTPUTS_COMMAND, this.editableCommandHandler(\n            notebookModel => notebookModel.applyEdits(notebookModel.cells.map(cell => ({\n                editType: CellEditType.Output,\n                handle: cell.handle, deleteCount: cell.outputs.length, outputs: []\n            })), false)\n        ));\n\n        commands.registerCommand(NotebookCommands.CHANGE_SELECTED_CELL,\n            {\n                execute: (change: number | CellChangeDirection) => {\n                    const focusedEditor = this.notebookEditorWidgetService.focusedEditor;\n                    const model = focusedEditor?.model;\n                    if (model && typeof change === 'number') {\n                        model.setSelectedCell(model.cells[change]);\n                    } else if (model && model.selectedCell) {\n                        const currentIndex = model.cells.indexOf(model.selectedCell);\n                        const shouldFocusEditor = this.contextKeyService.match('editorTextFocus');\n\n                        if (change === CellChangeDirection.Up && currentIndex > 0) {\n                            model.setSelectedCell(model.cells[currentIndex - 1]);\n                            if (model.selectedCell?.cellKind === CellKind.Code && shouldFocusEditor) {\n                                model.selectedCell.requestFocusEditor('lastLine');\n                            }\n                        } else if (change === CellChangeDirection.Down && currentIndex < model.cells.length - 1) {\n                            model.setSelectedCell(model.cells[currentIndex + 1]);\n                            if (model.selectedCell?.cellKind === CellKind.Code && shouldFocusEditor) {\n                                model.selectedCell.requestFocusEditor();\n                            }\n                        }\n\n                        if (model.selectedCell.cellKind === CellKind.Markup) {\n                            // since were losing focus from the cell editor, we need to focus the notebook editor again\n                            focusedEditor?.node.focus();\n                        }\n                    }\n                }\n            }\n        );\n\n        commands.registerHandler(CommonCommands.UNDO.id, {\n            isEnabled: () => {\n                const widget = this.shell.activeWidget;\n                return widget instanceof NotebookEditorWidget && !Boolean(widget.model?.readOnly);\n            },\n            execute: () => (this.shell.activeWidget as NotebookEditorWidget).undo()\n        });\n        commands.registerHandler(CommonCommands.REDO.id, {\n            isEnabled: () => {\n                const widget = this.shell.activeWidget;\n                return widget instanceof NotebookEditorWidget && !Boolean(widget.model?.readOnly);\n            },\n            execute: () => (this.shell.activeWidget as NotebookEditorWidget).redo()\n        });\n\n        commands.registerCommand(NotebookCommands.CUT_SELECTED_CELL, this.editableCommandHandler(\n            () => {\n                const model = this.notebookEditorWidgetService.focusedEditor?.model;\n                const selectedCell = model?.selectedCell;\n                if (selectedCell) {\n                    model.applyEdits([{ editType: CellEditType.Replace, index: model.cells.indexOf(selectedCell), count: 1, cells: [] }], true);\n                    this.notebookClipboardService.copyCell(selectedCell);\n                }\n            }));\n\n        commands.registerCommand(NotebookCommands.COPY_SELECTED_CELL, {\n            execute: () => {\n                const model = this.notebookEditorWidgetService.focusedEditor?.model;\n                const selectedCell = model?.selectedCell;\n                if (selectedCell) {\n                    this.notebookClipboardService.copyCell(selectedCell);\n                }\n            }\n        });\n\n        commands.registerCommand(NotebookCommands.PASTE_CELL, {\n            isEnabled: () => !Boolean(this.notebookEditorWidgetService.focusedEditor?.model?.readOnly),\n            isVisible: () => !Boolean(this.notebookEditorWidgetService.focusedEditor?.model?.readOnly),\n            execute: (position?: 'above') => {\n                const copiedCell = this.notebookClipboardService.getCell();\n                if (copiedCell) {\n                    const model = this.notebookEditorWidgetService.focusedEditor?.model;\n                    const insertIndex = model?.selectedCell ? model.cells.indexOf(model.selectedCell) + (position === 'above' ? 0 : 1) : 0;\n                    model?.applyEdits([{ editType: CellEditType.Replace, index: insertIndex, count: 0, cells: [copiedCell] }], true);\n                }\n            }\n        });\n\n    }\n\n    protected editableCommandHandler(execute: (notebookModel: NotebookModel) => void): CommandHandler {\n        return {\n            isEnabled: (item: URI | NotebookModel) => this.withModel(item, model => !Boolean(model?.readOnly), false),\n            isVisible: (item: URI | NotebookModel) => this.withModel(item, model => !Boolean(model?.readOnly), false),\n            execute: (uri: URI | NotebookModel) => {\n                this.withModel(uri, execute, undefined);\n            }\n        };\n    }\n\n    protected withModel<T>(item: URI | NotebookModel, execute: (notebookModel: NotebookModel) => T, defaultValue: T): T {\n        if (item instanceof URI) {\n            const model = this.notebookService.getNotebookEditorModel(item);\n            if (!model) {\n                return defaultValue;\n            }\n            item = model;\n        }\n        return execute(item);\n    }\n\n    registerMenus(menus: MenuModelRegistry): void {\n        // independent submenu for plugins to add commands\n        menus.registerIndependentSubmenu(NotebookMenus.NOTEBOOK_MAIN_TOOLBAR, 'Notebook Main Toolbar');\n        // Add Notebook Cell items\n        menus.registerSubmenu(NotebookMenus.NOTEBOOK_MAIN_TOOLBAR_CELL_ADD_GROUP, 'Add Notebook Cell', { role: CompoundMenuNodeRole.Group });\n        menus.registerMenuAction(NotebookMenus.NOTEBOOK_MAIN_TOOLBAR_CELL_ADD_GROUP, {\n            commandId: NotebookCommands.ADD_NEW_CODE_CELL_COMMAND.id,\n            label: nls.localizeByDefault('Code'),\n            icon: codicon('add'),\n        });\n        menus.registerMenuAction(NotebookMenus.NOTEBOOK_MAIN_TOOLBAR_CELL_ADD_GROUP, {\n            commandId: NotebookCommands.ADD_NEW_MARKDOWN_CELL_COMMAND.id,\n            label: nls.localizeByDefault('Markdown'),\n            icon: codicon('add'),\n        });\n\n        // Execution related items\n        menus.registerSubmenu(NotebookMenus.NOTEBOOK_MAIN_TOOLBAR_EXECUTION_GROUP, 'Cell Execution', { role: CompoundMenuNodeRole.Group });\n        menus.registerMenuAction(NotebookMenus.NOTEBOOK_MAIN_TOOLBAR_EXECUTION_GROUP, {\n            commandId: NotebookCommands.EXECUTE_NOTEBOOK_COMMAND.id,\n            label: nls.localizeByDefault('Run All'),\n            icon: codicon('run-all'),\n            order: '10'\n        });\n        menus.registerMenuAction(NotebookMenus.NOTEBOOK_MAIN_TOOLBAR_EXECUTION_GROUP, {\n            commandId: NotebookCommands.CLEAR_ALL_OUTPUTS_COMMAND.id,\n            label: nls.localizeByDefault('Clear All Outputs'),\n            icon: codicon('clear-all'),\n            order: '30',\n            when: NOTEBOOK_HAS_OUTPUTS\n        });\n\n        menus.registerIndependentSubmenu(NotebookMenus.NOTEBOOK_MAIN_TOOLBAR_HIDDEN_ITEMS_CONTEXT_MENU, '');\n    }\n\n    registerKeybindings(keybindings: KeybindingRegistry): void {\n        keybindings.registerKeybindings(\n            {\n                command: NotebookCommands.CHANGE_SELECTED_CELL.id,\n                keybinding: 'up',\n                args: CellChangeDirection.Up,\n                when: `(!editorTextFocus || ${NOTEBOOK_CELL_CURSOR_FIRST_LINE}) && !suggestWidgetVisible && ${NOTEBOOK_EDITOR_FOCUSED} && ${NOTEBOOK_CELL_FOCUSED}`\n            },\n            {\n                command: NotebookCommands.CHANGE_SELECTED_CELL.id,\n                keybinding: 'down',\n                args: CellChangeDirection.Down,\n                when: `(!editorTextFocus || ${NOTEBOOK_CELL_CURSOR_LAST_LINE}) && !suggestWidgetVisible && ${NOTEBOOK_EDITOR_FOCUSED} && ${NOTEBOOK_CELL_FOCUSED}`\n            },\n            {\n                command: NotebookCommands.CUT_SELECTED_CELL.id,\n                keybinding: 'ctrlcmd+x',\n                when: `!editorTextFocus && ${NOTEBOOK_EDITOR_FOCUSED} && ${NOTEBOOK_CELL_FOCUSED}`\n            },\n            {\n                command: NotebookCommands.COPY_SELECTED_CELL.id,\n                keybinding: 'ctrlcmd+c',\n                when: `!editorTextFocus && ${NOTEBOOK_EDITOR_FOCUSED} && ${NOTEBOOK_CELL_FOCUSED}`\n            },\n            {\n                command: NotebookCommands.PASTE_CELL.id,\n                keybinding: 'ctrlcmd+v',\n                when: `!editorTextFocus && ${NOTEBOOK_EDITOR_FOCUSED}`\n            },\n        );\n    }\n\n}\n\nexport namespace NotebookMenus {\n    export const NOTEBOOK_MAIN_TOOLBAR = 'notebook/toolbar';\n    export const NOTEBOOK_MAIN_TOOLBAR_CELL_ADD_GROUP = [NOTEBOOK_MAIN_TOOLBAR, 'cell-add-group'];\n    export const NOTEBOOK_MAIN_TOOLBAR_EXECUTION_GROUP = [NOTEBOOK_MAIN_TOOLBAR, 'cell-execution-group'];\n    export const NOTEBOOK_MAIN_TOOLBAR_HIDDEN_ITEMS_CONTEXT_MENU = 'notebook-main-toolbar-hidden-items-context-menu';\n}\n","// *****************************************************************************\n// Copyright (C) 2023 TypeFox and others.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\n\nimport { Command, CommandContribution, CommandHandler, CommandRegistry, CompoundMenuNodeRole, MenuContribution, MenuModelRegistry, nls } from '@theia/core';\nimport { codicon, Key, KeybindingContribution, KeybindingRegistry, KeyCode, KeyModifier } from '@theia/core/lib/browser';\nimport { inject, injectable, postConstruct } from '@theia/core/shared/inversify';\nimport { NotebookModel } from '../view-model/notebook-model';\nimport { NotebookCellModel } from '../view-model/notebook-cell-model';\nimport {\n    NOTEBOOK_CELL_MARKDOWN_EDIT_MODE, NOTEBOOK_CELL_TYPE,\n    NotebookContextKeys, NOTEBOOK_CELL_EXECUTING, NOTEBOOK_EDITOR_FOCUSED,\n    NOTEBOOK_CELL_FOCUSED\n} from './notebook-context-keys';\nimport { ContextKeyService } from '@theia/core/lib/browser/context-key-service';\nimport { NotebookExecutionService } from '../service/notebook-execution-service';\nimport { NotebookCellOutputModel } from '../view-model/notebook-cell-output-model';\nimport { CellEditType, CellKind } from '../../common';\nimport { NotebookEditorWidgetService } from '../service/notebook-editor-widget-service';\nimport { NotebookCommands } from './notebook-actions-contribution';\nimport { changeCellType } from './cell-operations';\nimport { EditorLanguageQuickPickService } from '@theia/editor/lib/browser/editor-language-quick-pick-service';\n\nexport namespace NotebookCellCommands {\n    /** Parameters: notebookModel: NotebookModel | undefined, cell: NotebookCellModel */\n    export const EDIT_COMMAND = Command.toDefaultLocalizedCommand({\n        id: 'notebook.cell.edit',\n        iconClass: codicon('edit')\n    });\n    /** Parameters: notebookModel: NotebookModel | undefined, cell: NotebookCellModel */\n    export const STOP_EDIT_COMMAND = Command.toDefaultLocalizedCommand({\n        id: 'notebook.cell.stop-edit',\n        iconClass: codicon('check')\n    });\n    /** Parameters: notebookModel: NotebookModel, cell: NotebookCellModel */\n    export const DELETE_COMMAND = Command.toDefaultLocalizedCommand({\n        id: 'notebook.cell.delete',\n        iconClass: codicon('trash')\n    });\n    /** Parameters: notebookModel: NotebookModel, cell: NotebookCellModel */\n    export const SPLIT_CELL_COMMAND = Command.toDefaultLocalizedCommand({\n        id: 'notebook.cell.split-cell',\n        iconClass: codicon('split-vertical'),\n    });\n    /** Parameters: notebookModel: NotebookModel, cell: NotebookCellModel */\n    export const EXECUTE_SINGLE_CELL_COMMAND = Command.toDefaultLocalizedCommand({\n        id: 'notebook.cell.execute-cell',\n        iconClass: codicon('play'),\n    });\n    /** Parameters: notebookModel: NotebookModel, cell: NotebookCellModel */\n    export const EXECUTE_SINGLE_CELL_AND_FOCUS_NEXT_COMMAND = Command.toDefaultLocalizedCommand({\n        id: 'notebook.cell.execute-cell-and-focus-next',\n    });\n\n    export const EXECUTE_ABOVE_CELLS_COMMAND = Command.toDefaultLocalizedCommand({\n        id: 'notebookActions.executeAbove',\n        label: 'Execute Above Cells',\n        iconClass: codicon('run-above')\n    });\n\n    export const EXECUTE_CELL_AND_BELOW_COMMAND = Command.toDefaultLocalizedCommand({\n        id: 'notebookActions.executeBelow',\n        label: 'Execute Cell and Below',\n        iconClass: codicon('run-below')\n    });\n    /** Parameters: notebookModel: NotebookModel, cell: NotebookCellModel */\n    export const STOP_CELL_EXECUTION_COMMAND = Command.toDefaultLocalizedCommand({\n        id: 'notebook.cell.stop-cell-execution',\n        iconClass: codicon('stop'),\n    });\n    /** Parameters: notebookModel: NotebookModel | undefined, cell: NotebookCellModel */\n    export const CLEAR_OUTPUTS_COMMAND = Command.toDefaultLocalizedCommand({\n        id: 'notebook.cell.clear-outputs',\n        label: 'Clear Cell Outputs',\n    });\n    /** Parameters: notebookModel: NotebookModel | undefined, cell: NotebookCellModel | undefined, output: NotebookCellOutputModel */\n    export const CHANGE_OUTPUT_PRESENTATION_COMMAND = Command.toDefaultLocalizedCommand({\n        id: 'notebook.cell.change-presentation',\n        label: 'Change Presentation',\n    });\n\n    export const INSERT_NEW_CELL_ABOVE_COMMAND = Command.toDefaultLocalizedCommand({\n        id: 'notebook.cell.insertCodeCellAboveAndFocusContainer',\n        label: 'Insert Code Cell Above and Focus Container'\n    });\n\n    export const INSERT_NEW_CELL_BELOW_COMMAND = Command.toDefaultLocalizedCommand({\n        id: 'notebook.cell.insertCodeCellBelowAndFocusContainer',\n        label: 'Insert Code Cell Below and Focus Container'\n    });\n\n    export const INSERT_MARKDOWN_CELL_ABOVE_COMMAND = Command.toLocalizedCommand({\n        id: 'notebook.cell.insertMarkdownCellAbove',\n        label: 'Insert Markdown Cell Above'\n    });\n    export const INSERT_MARKDOWN_CELL_BELOW_COMMAND = Command.toLocalizedCommand({\n        id: 'notebook.cell.insertMarkdownCellBelow',\n        label: 'Insert Markdown Cell Below'\n    });\n\n    export const TO_CODE_CELL_COMMAND = Command.toLocalizedCommand({\n        id: 'notebook.cell.changeToCode',\n        label: 'Change Cell to Code'\n    });\n\n    export const TO_MARKDOWN_CELL_COMMAND = Command.toLocalizedCommand({\n        id: 'notebook.cell.changeToMarkdown',\n        label: 'Change Cell to Mardown'\n    });\n\n    export const TOGGLE_CELL_OUTPUT = Command.toDefaultLocalizedCommand({\n        id: 'notebook.cell.toggleOutputs',\n        category: 'Notebook',\n        label: 'Collapse Cell Output',\n    });\n\n    export const CHANGE_CELL_LANGUAGE = Command.toDefaultLocalizedCommand({\n        id: 'notebook.cell.changeLanguage',\n        category: 'Notebook',\n        label: 'Change Cell Language',\n    });\n\n    export const TOGGLE_LINE_NUMBERS = Command.toDefaultLocalizedCommand({\n        id: 'notebook.cell.toggleLineNumbers',\n        category: 'Notebook',\n        label: 'Show Cell Line Numbers',\n    });\n\n}\n\n@injectable()\nexport class NotebookCellActionContribution implements MenuContribution, CommandContribution, KeybindingContribution {\n\n    @inject(ContextKeyService)\n    protected contextKeyService: ContextKeyService;\n\n    @inject(NotebookExecutionService)\n    protected notebookExecutionService: NotebookExecutionService;\n\n    @inject(NotebookEditorWidgetService)\n    protected notebookEditorWidgetService: NotebookEditorWidgetService;\n\n    @inject(EditorLanguageQuickPickService)\n    protected languageQuickPickService: EditorLanguageQuickPickService;\n\n    @postConstruct()\n    protected init(): void {\n        NotebookContextKeys.initNotebookContextKeys(this.contextKeyService);\n    }\n\n    registerMenus(menus: MenuModelRegistry): void {\n        menus.registerMenuAction(NotebookCellActionContribution.ACTION_MENU, {\n            commandId: NotebookCellCommands.EDIT_COMMAND.id,\n            icon: NotebookCellCommands.EDIT_COMMAND.iconClass,\n            when: `${NOTEBOOK_CELL_TYPE} == 'markdown' && !${NOTEBOOK_CELL_MARKDOWN_EDIT_MODE}`,\n            label: nls.localizeByDefault('Edit Cell'),\n            order: '10'\n        });\n        menus.registerMenuAction(NotebookCellActionContribution.ACTION_MENU, {\n            commandId: NotebookCellCommands.STOP_EDIT_COMMAND.id,\n            icon: NotebookCellCommands.STOP_EDIT_COMMAND.iconClass,\n            when: `${NOTEBOOK_CELL_TYPE} == 'markdown' && ${NOTEBOOK_CELL_MARKDOWN_EDIT_MODE}`,\n            label: nls.localizeByDefault('Stop Editing Cell'),\n            order: '10'\n        });\n\n        menus.registerMenuAction(NotebookCellActionContribution.ACTION_MENU, {\n            commandId: NotebookCellCommands.EXECUTE_ABOVE_CELLS_COMMAND.id,\n            icon: NotebookCellCommands.EXECUTE_ABOVE_CELLS_COMMAND.iconClass,\n            when: `${NOTEBOOK_CELL_TYPE} == 'code'`,\n            label: nls.localizeByDefault('Execute Above Cells'),\n            order: '10'\n        });\n\n        menus.registerMenuAction(NotebookCellActionContribution.ACTION_MENU, {\n            commandId: NotebookCellCommands.EXECUTE_CELL_AND_BELOW_COMMAND.id,\n            icon: NotebookCellCommands.EXECUTE_CELL_AND_BELOW_COMMAND.iconClass,\n            when: `${NOTEBOOK_CELL_TYPE} == 'code'`,\n            label: nls.localizeByDefault('Execute Cell and Below'),\n            order: '20'\n        });\n\n        // menus.registerMenuAction(NotebookCellActionContribution.ACTION_MENU, {\n        //     commandId: NotebookCellCommands.SPLIT_CELL_COMMAND.id,\n        //     icon: NotebookCellCommands.SPLIT_CELL_COMMAND.iconClass,\n        //     label: nls.localizeByDefault('Split Cell'),\n        //     order: '20'\n        // });\n\n        menus.registerMenuAction(NotebookCellActionContribution.ACTION_MENU, {\n            commandId: NotebookCellCommands.DELETE_COMMAND.id,\n            icon: NotebookCellCommands.DELETE_COMMAND.iconClass,\n            label: nls.localizeByDefault('Delete Cell'),\n            order: '999'\n        });\n\n        menus.registerSubmenu(\n            NotebookCellActionContribution.ADDITIONAL_ACTION_MENU,\n            nls.localizeByDefault('More'),\n            {\n                icon: codicon('ellipsis'),\n                role: CompoundMenuNodeRole.Submenu,\n                order: '30'\n            }\n        );\n\n        menus.registerIndependentSubmenu(NotebookCellActionContribution.CONTRIBUTED_CELL_ACTION_MENU, '', { role: CompoundMenuNodeRole.Flat });\n        // since contributions are adding to an independent submenu we have to manually add it to the more submenu\n        menus.getMenu(NotebookCellActionContribution.ADDITIONAL_ACTION_MENU).addNode(menus.getMenuNode(NotebookCellActionContribution.CONTRIBUTED_CELL_ACTION_MENU));\n\n        // code cell sidebar menu\n        menus.registerMenuAction(NotebookCellActionContribution.CODE_CELL_SIDEBAR_MENU, {\n            commandId: NotebookCellCommands.EXECUTE_SINGLE_CELL_COMMAND.id,\n            icon: NotebookCellCommands.EXECUTE_SINGLE_CELL_COMMAND.iconClass,\n            label: nls.localizeByDefault('Execute Cell'),\n            when: `!${NOTEBOOK_CELL_EXECUTING}`\n        });\n        menus.registerMenuAction(NotebookCellActionContribution.CODE_CELL_SIDEBAR_MENU, {\n            commandId: NotebookCellCommands.STOP_CELL_EXECUTION_COMMAND.id,\n            icon: NotebookCellCommands.STOP_CELL_EXECUTION_COMMAND.iconClass,\n            label: nls.localizeByDefault('Stop Cell Execution'),\n            when: NOTEBOOK_CELL_EXECUTING\n        });\n\n        // Notebook Cell extra execution options\n        menus.registerIndependentSubmenu(NotebookCellActionContribution.CONTRIBUTED_CELL_EXECUTION_MENU,\n            nls.localizeByDefault('More...'),\n            { role: CompoundMenuNodeRole.Flat, icon: codicon('chevron-down') });\n        // menus.getMenu(NotebookCellActionContribution.CODE_CELL_SIDEBAR_MENU).addNode(menus.getMenuNode(NotebookCellActionContribution.CONTRIBUTED_CELL_EXECUTION_MENU));\n\n        // code cell output sidebar menu\n        menus.registerSubmenu(\n            NotebookCellActionContribution.ADDITIONAL_OUTPUT_SIDEBAR_MENU,\n            nls.localizeByDefault('More'),\n            {\n                icon: codicon('ellipsis'),\n                role: CompoundMenuNodeRole.Submenu\n            });\n        menus.registerMenuAction(NotebookCellActionContribution.ADDITIONAL_OUTPUT_SIDEBAR_MENU, {\n            commandId: NotebookCellCommands.CLEAR_OUTPUTS_COMMAND.id,\n            label: nls.localizeByDefault('Clear Cell Outputs'),\n        });\n        menus.registerMenuAction(NotebookCellActionContribution.ADDITIONAL_OUTPUT_SIDEBAR_MENU, {\n            commandId: NotebookCellCommands.CHANGE_OUTPUT_PRESENTATION_COMMAND.id,\n            label: nls.localizeByDefault('Change Presentation'),\n        });\n\n    }\n\n    registerCommands(commands: CommandRegistry): void {\n        commands.registerCommand(NotebookCellCommands.EDIT_COMMAND, this.editableCellCommandHandler((_, cell) => cell.requestFocusEditor()));\n        commands.registerCommand(NotebookCellCommands.STOP_EDIT_COMMAND, { execute: (_, cell: NotebookCellModel) => (cell ?? this.getSelectedCell()).requestBlurEditor() });\n        commands.registerCommand(NotebookCellCommands.DELETE_COMMAND,\n            this.editableCellCommandHandler((notebookModel, cell) => {\n                notebookModel.applyEdits([{\n                    editType: CellEditType.Replace,\n                    index: notebookModel.cells.indexOf(cell),\n                    count: 1,\n                    cells: []\n                }]\n                    , true);\n            }));\n        commands.registerCommand(NotebookCellCommands.SPLIT_CELL_COMMAND);\n\n        commands.registerCommand(NotebookCellCommands.EXECUTE_SINGLE_CELL_COMMAND, this.editableCellCommandHandler(\n            (notebookModel, cell) => {\n                this.notebookExecutionService.executeNotebookCells(notebookModel, [cell]);\n            })\n        );\n\n        commands.registerCommand(NotebookCellCommands.EXECUTE_SINGLE_CELL_AND_FOCUS_NEXT_COMMAND, this.editableCellCommandHandler(\n            (notebookModel, cell) => {\n                if (cell.cellKind === CellKind.Code) {\n                    commands.executeCommand(NotebookCellCommands.EXECUTE_SINGLE_CELL_COMMAND.id, notebookModel, cell);\n                } else {\n                    commands.executeCommand(NotebookCellCommands.STOP_EDIT_COMMAND.id, notebookModel, cell);\n                }\n                const index = notebookModel.cells.indexOf(cell);\n                if (index < notebookModel.cells.length - 1) {\n                    notebookModel.setSelectedCell(notebookModel.cells[index + 1]);\n                } else if (cell.cellKind === CellKind.Code) {\n                    commands.executeCommand(NotebookCellCommands.INSERT_NEW_CELL_BELOW_COMMAND.id);\n                } else {\n                    commands.executeCommand(NotebookCellCommands.INSERT_MARKDOWN_CELL_BELOW_COMMAND.id);\n                }\n            })\n        );\n\n        commands.registerCommand(NotebookCellCommands.EXECUTE_ABOVE_CELLS_COMMAND, this.editableCellCommandHandler(\n            (notebookModel, cell) => {\n                const index = notebookModel.cells.indexOf(cell);\n                if (index > 0) {\n                    this.notebookExecutionService.executeNotebookCells(notebookModel, notebookModel.cells.slice(0, index).filter(c => c.cellKind === CellKind.Code));\n                }\n            })\n        );\n\n        commands.registerCommand(NotebookCellCommands.EXECUTE_CELL_AND_BELOW_COMMAND, this.editableCellCommandHandler(\n            (notebookModel, cell) => {\n                const index = notebookModel.cells.indexOf(cell);\n                if (index < notebookModel.cells.length - 1) {\n                    this.notebookExecutionService.executeNotebookCells(notebookModel, notebookModel.cells.slice(index).filter(c => c.cellKind === CellKind.Code));\n                }\n            })\n        );\n\n        commands.registerCommand(NotebookCellCommands.STOP_CELL_EXECUTION_COMMAND, {\n            execute: (notebookModel: NotebookModel, cell: NotebookCellModel) => {\n                notebookModel = notebookModel ?? this.notebookEditorWidgetService.focusedEditor?.model;\n                cell = cell ?? this.getSelectedCell();\n                this.notebookExecutionService.cancelNotebookCells(notebookModel, [cell]);\n            }\n        });\n        commands.registerCommand(NotebookCellCommands.CLEAR_OUTPUTS_COMMAND, this.editableCellCommandHandler(\n            (notebook, cell) => (notebook ?? this.notebookEditorWidgetService.focusedEditor?.model)?.applyEdits([{\n                editType: CellEditType.Output,\n                handle: cell.handle,\n                outputs: [],\n                deleteCount: cell.outputs.length,\n                append: false\n            }], true)\n        ));\n        commands.registerCommand(NotebookCellCommands.CHANGE_OUTPUT_PRESENTATION_COMMAND, this.editableCellCommandHandler(\n            (_, __, output) => output?.requestOutputPresentationUpdate()\n        ));\n\n        const insertCommand = (type: CellKind, index: number | 'above' | 'below'): CommandHandler => this.editableCellCommandHandler(() =>\n            commands.executeCommand(NotebookCommands.ADD_NEW_CELL_COMMAND.id, undefined, type, index)\n        );\n        commands.registerCommand(NotebookCellCommands.INSERT_NEW_CELL_ABOVE_COMMAND, insertCommand(CellKind.Code, 'above'));\n        commands.registerCommand(NotebookCellCommands.INSERT_NEW_CELL_BELOW_COMMAND, insertCommand(CellKind.Code, 'below'));\n        commands.registerCommand(NotebookCellCommands.INSERT_MARKDOWN_CELL_ABOVE_COMMAND, insertCommand(CellKind.Markup, 'above'));\n        commands.registerCommand(NotebookCellCommands.INSERT_MARKDOWN_CELL_BELOW_COMMAND, insertCommand(CellKind.Markup, 'below'));\n\n        commands.registerCommand(NotebookCellCommands.TO_CODE_CELL_COMMAND, this.editableCellCommandHandler((notebookModel, cell) => {\n            changeCellType(notebookModel, cell, CellKind.Code);\n        }));\n        commands.registerCommand(NotebookCellCommands.TO_MARKDOWN_CELL_COMMAND, this.editableCellCommandHandler((notebookModel, cell) => {\n            changeCellType(notebookModel, cell, CellKind.Markup);\n        }));\n\n        commands.registerCommand(NotebookCellCommands.TOGGLE_CELL_OUTPUT, {\n            execute: () => {\n                const selectedCell = this.notebookEditorWidgetService.focusedEditor?.model?.selectedCell;\n                if (selectedCell) {\n                    selectedCell.outputVisible = !selectedCell.outputVisible;\n                }\n            }\n        });\n\n        commands.registerCommand(NotebookCellCommands.CHANGE_CELL_LANGUAGE, {\n            isVisible: () => !!this.notebookEditorWidgetService.focusedEditor?.model?.selectedCell,\n            execute: async (notebook?: NotebookModel, cell?: NotebookCellModel) => {\n                const selectedCell = cell ?? this.notebookEditorWidgetService.focusedEditor?.model?.selectedCell;\n                const activeNotebook = notebook ?? this.notebookEditorWidgetService.focusedEditor?.model;\n                if (selectedCell && activeNotebook) {\n                    const language = await this.languageQuickPickService.pickEditorLanguage(selectedCell.language);\n                    if (language?.value && language.value !== 'autoDetect') {\n                        this.notebookEditorWidgetService.focusedEditor?.model?.applyEdits([{\n                            editType: CellEditType.CellLanguage,\n                            index: activeNotebook.cells.indexOf(selectedCell),\n                            language: language.value.id\n                        }], true);\n                    }\n                }\n            }\n        });\n\n        commands.registerCommand(NotebookCellCommands.TOGGLE_LINE_NUMBERS, {\n            execute: () => {\n                const selectedCell = this.notebookEditorWidgetService.focusedEditor?.model?.selectedCell;\n                if (selectedCell) {\n                    const currentLineNumber = selectedCell.editorOptions?.lineNumbers;\n                    selectedCell.editorOptions = { ...selectedCell.editorOptions, lineNumbers: !currentLineNumber || currentLineNumber === 'off' ? 'on' : 'off' };\n                }\n            }\n        });\n\n    }\n\n    protected editableCellCommandHandler(execute: (notebookModel: NotebookModel, cell: NotebookCellModel, output?: NotebookCellOutputModel) => void): CommandHandler {\n        return {\n            isEnabled: (notebookModel: NotebookModel) => !Boolean(notebookModel?.readOnly),\n            isVisible: (notebookModel: NotebookModel) => !Boolean(notebookModel?.readOnly),\n            execute: (notebookModel: NotebookModel, cell: NotebookCellModel, output?: NotebookCellOutputModel) => {\n                notebookModel = notebookModel ?? this.notebookEditorWidgetService.focusedEditor?.model;\n                cell = cell ?? this.getSelectedCell();\n                execute(notebookModel, cell, output);\n            }\n        };\n    }\n\n    protected getSelectedCell(): NotebookCellModel | undefined {\n        return this.notebookEditorWidgetService.focusedEditor?.model?.selectedCell;\n    }\n\n    registerKeybindings(keybindings: KeybindingRegistry): void {\n        keybindings.registerKeybindings(\n            {\n                command: NotebookCellCommands.EDIT_COMMAND.id,\n                keybinding: 'Enter',\n                when: `!editorTextFocus && ${NOTEBOOK_EDITOR_FOCUSED} && ${NOTEBOOK_CELL_FOCUSED}`,\n            },\n            {\n                command: NotebookCellCommands.STOP_EDIT_COMMAND.id,\n                keybinding: KeyCode.createKeyCode({ first: Key.ENTER, modifiers: [KeyModifier.Alt] }).toString(),\n                when: `editorTextFocus && ${NOTEBOOK_EDITOR_FOCUSED}`,\n            },\n            {\n                command: NotebookCellCommands.STOP_EDIT_COMMAND.id,\n                keybinding: 'esc',\n                when: `editorTextFocus && ${NOTEBOOK_EDITOR_FOCUSED}`,\n            },\n            {\n                command: NotebookCellCommands.EXECUTE_SINGLE_CELL_COMMAND.id,\n                keybinding: KeyCode.createKeyCode({ first: Key.ENTER, modifiers: [KeyModifier.CtrlCmd] }).toString(),\n                when: `${NOTEBOOK_EDITOR_FOCUSED} && ${NOTEBOOK_CELL_FOCUSED} && ${NOTEBOOK_CELL_TYPE} == 'code'`,\n            },\n            {\n                command: NotebookCellCommands.EXECUTE_SINGLE_CELL_AND_FOCUS_NEXT_COMMAND.id,\n                keybinding: KeyCode.createKeyCode({ first: Key.ENTER, modifiers: [KeyModifier.Shift] }).toString(),\n                when: `${NOTEBOOK_EDITOR_FOCUSED} && ${NOTEBOOK_CELL_FOCUSED}`,\n            },\n            {\n                command: NotebookCellCommands.CLEAR_OUTPUTS_COMMAND.id,\n                keybinding: KeyCode.createKeyCode({ first: Key.KEY_O, modifiers: [KeyModifier.Alt] }).toString(),\n                when: `${NOTEBOOK_EDITOR_FOCUSED} && ${NOTEBOOK_CELL_FOCUSED} && ${NOTEBOOK_CELL_TYPE} == 'code'`,\n            },\n            {\n                command: NotebookCellCommands.CHANGE_OUTPUT_PRESENTATION_COMMAND.id,\n                keybinding: KeyCode.createKeyCode({ first: Key.KEY_P, modifiers: [KeyModifier.Alt] }).toString(),\n                when: `${NOTEBOOK_EDITOR_FOCUSED} && ${NOTEBOOK_CELL_FOCUSED} && ${NOTEBOOK_CELL_TYPE} == 'code'`,\n            },\n            {\n                command: NotebookCellCommands.TO_CODE_CELL_COMMAND.id,\n                keybinding: 'Y',\n                when: `!editorTextFocus && ${NOTEBOOK_EDITOR_FOCUSED} && ${NOTEBOOK_CELL_FOCUSED} && ${NOTEBOOK_CELL_TYPE} == 'markdown'`,\n            },\n            {\n                command: NotebookCellCommands.TO_MARKDOWN_CELL_COMMAND.id,\n                keybinding: 'M',\n                when: `!editorTextFocus && ${NOTEBOOK_EDITOR_FOCUSED} && ${NOTEBOOK_CELL_FOCUSED} && ${NOTEBOOK_CELL_TYPE} == 'code'`,\n            },\n        );\n    }\n}\n\nexport namespace NotebookCellActionContribution {\n    export const ACTION_MENU = ['notebook-cell-actions-menu'];\n    export const ADDITIONAL_ACTION_MENU = [...ACTION_MENU, 'more'];\n    export const CONTRIBUTED_CELL_ACTION_MENU = 'notebook/cell/title';\n    export const CONTRIBUTED_CELL_EXECUTION_MENU = 'notebook/cell/execute';\n    export const CODE_CELL_SIDEBAR_MENU = ['code-cell-sidebar-menu'];\n    export const OUTPUT_SIDEBAR_MENU = ['code-cell-output-sidebar-menu'];\n    export const ADDITIONAL_OUTPUT_SIDEBAR_MENU = [...OUTPUT_SIDEBAR_MENU, 'more'];\n\n}\n\n","// *****************************************************************************\n// Copyright (C) 2023 TypeFox and others.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\n/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { ContextKeyService } from '@theia/core/lib/browser/context-key-service';\n\nexport type NotebookCellExecutionStateContext = 'idle' | 'pending' | 'executing' | 'succeeded' | 'failed';\n\n/**\n * Context Keys for the Notebook Editor as defined by vscode in https://github.com/microsoft/vscode/blob/main/src/vs/workbench/contrib/notebook/common/notebookContextKeys.ts\n */\nexport const HAS_OPENED_NOTEBOOK = 'userHasOpenedNotebook';\nexport const KEYBINDING_CONTEXT_NOTEBOOK_FIND_WIDGET_FOCUSED = 'notebookFindWidgetFocused';\nexport const NOTEBOOK_EDITOR_FOCUSED = 'notebookEditorFocused';\nexport const NOTEBOOK_CELL_LIST_FOCUSED = 'notebookCellListFocused';\nexport const NOTEBOOK_OUTPUT_FOCUSED = 'notebookOutputFocused';\nexport const NOTEBOOK_OUTPUT_INPUT_FOCUSED = 'notebookOutputInputFocused';\nexport const NOTEBOOK_EDITOR_EDITABLE = 'notebookEditable';\nexport const NOTEBOOK_HAS_RUNNING_CELL = 'notebookHasRunningCell';\nexport const NOTEBOOK_USE_CONSOLIDATED_OUTPUT_BUTTON = 'notebookUseConsolidatedOutputButton';\nexport const NOTEBOOK_BREAKPOINT_MARGIN_ACTIVE = 'notebookBreakpointMargin';\nexport const NOTEBOOK_CELL_TOOLBAR_LOCATION = 'notebookCellToolbarLocation';\nexport const NOTEBOOK_CURSOR_NAVIGATION_MODE = 'notebookCursorNavigationMode';\nexport const NOTEBOOK_LAST_CELL_FAILED = 'notebookLastCellFailed';\nexport const NOTEBOOK_VIEW_TYPE = 'notebookType';\nexport const NOTEBOOK_CELL_TYPE = 'notebookCellType';\nexport const NOTEBOOK_CELL_EDITABLE = 'notebookCellEditable';\nexport const NOTEBOOK_CELL_FOCUSED = 'notebookCellFocused';\nexport const NOTEBOOK_CELL_EDITOR_FOCUSED = 'notebookCellEditorFocused';\nexport const NOTEBOOK_CELL_MARKDOWN_EDIT_MODE = 'notebookCellMarkdownEditMode';\nexport const NOTEBOOK_CELL_LINE_NUMBERS = 'notebookCellLineNumbers';\nexport const NOTEBOOK_CELL_EXECUTION_STATE = 'notebookCellExecutionState';\nexport const NOTEBOOK_CELL_EXECUTING = 'notebookCellExecuting';\nexport const NOTEBOOK_CELL_HAS_OUTPUTS = 'notebookCellHasOutputs';\nexport const NOTEBOOK_CELL_INPUT_COLLAPSED = 'notebookCellInputIsCollapsed';\nexport const NOTEBOOK_CELL_OUTPUT_COLLAPSED = 'notebookCellOutputIsCollapsed';\nexport const NOTEBOOK_CELL_RESOURCE = 'notebookCellResource';\nexport const NOTEBOOK_KERNEL = 'notebookKernel';\nexport const NOTEBOOK_KERNEL_COUNT = 'notebookKernelCount';\nexport const NOTEBOOK_KERNEL_SOURCE_COUNT = 'notebookKernelSourceCount';\nexport const NOTEBOOK_KERNEL_SELECTED = 'notebookKernelSelected';\nexport const NOTEBOOK_INTERRUPTIBLE_KERNEL = 'notebookInterruptibleKernel';\nexport const NOTEBOOK_MISSING_KERNEL_EXTENSION = 'notebookMissingKernelExtension';\nexport const NOTEBOOK_HAS_OUTPUTS = 'notebookHasOutputs';\n\nexport const NOTEBOOK_CELL_CURSOR_FIRST_LINE = 'cellEditorCursorPositionFirstLine';\nexport const NOTEBOOK_CELL_CURSOR_LAST_LINE = 'cellEditorCursorPositionLastLine';\n\nexport namespace NotebookContextKeys {\n    export function initNotebookContextKeys(service: ContextKeyService): void {\n        service.createKey(HAS_OPENED_NOTEBOOK, false);\n        service.createKey(KEYBINDING_CONTEXT_NOTEBOOK_FIND_WIDGET_FOCUSED, false);\n\n        // // Is Notebook\n        // export const NOTEBOOK_IS_ACTIVE_EDITOR = ContextKeyExpr.equals('activeEditor', NOTEBOOK_EDITOR_ID);\n        // export const INTERACTIVE_WINDOW_IS_ACTIVE_EDITOR = ContextKeyExpr.equals('activeEditor', INTERACTIVE_WINDOW_EDITOR_ID);\n\n        // Editor keys\n        service.createKey(NOTEBOOK_EDITOR_FOCUSED, false);\n        service.createKey(NOTEBOOK_CELL_LIST_FOCUSED, false);\n        service.createKey(NOTEBOOK_OUTPUT_FOCUSED, false);\n        service.createKey(NOTEBOOK_OUTPUT_INPUT_FOCUSED, false);\n        service.createKey(NOTEBOOK_EDITOR_EDITABLE, true);\n        service.createKey(NOTEBOOK_HAS_RUNNING_CELL, false);\n        service.createKey(NOTEBOOK_USE_CONSOLIDATED_OUTPUT_BUTTON, false);\n        service.createKey(NOTEBOOK_BREAKPOINT_MARGIN_ACTIVE, false);\n        service.createKey(NOTEBOOK_CELL_TOOLBAR_LOCATION, 'left');\n        service.createKey(NOTEBOOK_CURSOR_NAVIGATION_MODE, false);\n        service.createKey(NOTEBOOK_LAST_CELL_FAILED, false);\n\n        // Cell keys\n        service.createKey(NOTEBOOK_VIEW_TYPE, undefined);\n        service.createKey(NOTEBOOK_CELL_TYPE, undefined);\n        service.createKey(NOTEBOOK_CELL_EDITABLE, false);\n        service.createKey(NOTEBOOK_CELL_FOCUSED, false);\n        service.createKey(NOTEBOOK_CELL_EDITOR_FOCUSED, false);\n        service.createKey(NOTEBOOK_CELL_MARKDOWN_EDIT_MODE, false);\n        service.createKey(NOTEBOOK_CELL_LINE_NUMBERS, 'inherit');\n        service.createKey(NOTEBOOK_CELL_EXECUTION_STATE, undefined);\n        service.createKey(NOTEBOOK_CELL_EXECUTING, false);\n        service.createKey(NOTEBOOK_CELL_HAS_OUTPUTS, false);\n        service.createKey(NOTEBOOK_CELL_INPUT_COLLAPSED, false);\n        service.createKey(NOTEBOOK_CELL_OUTPUT_COLLAPSED, false);\n        service.createKey(NOTEBOOK_CELL_RESOURCE, '');\n        service.createKey(NOTEBOOK_CELL_CURSOR_FIRST_LINE, false);\n        service.createKey(NOTEBOOK_CELL_CURSOR_LAST_LINE, false);\n\n        // Kernels\n        service.createKey(NOTEBOOK_KERNEL, undefined);\n        service.createKey(NOTEBOOK_KERNEL_COUNT, 0);\n        service.createKey(NOTEBOOK_KERNEL_SOURCE_COUNT, 0);\n        service.createKey(NOTEBOOK_KERNEL_SELECTED, false);\n        service.createKey(NOTEBOOK_INTERRUPTIBLE_KERNEL, false);\n        service.createKey(NOTEBOOK_MISSING_KERNEL_EXTENSION, false);\n        service.createKey(NOTEBOOK_HAS_OUTPUTS, false);\n    }\n}\n","// *****************************************************************************\n// Copyright (C) 2024 TypeFox and others.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\n/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { nls } from '@theia/core';\nimport { PreferenceSchema } from '@theia/core/lib/browser';\n\nexport namespace NotebookPreferences {\n    export const NOTEBOOK_LINE_NUMBERS = 'notebook.lineNumbers';\n    export const OUTPUT_LINE_HEIGHT = 'notebook.output.lineHeight';\n    export const OUTPUT_FONT_SIZE = 'notebook.output.fontSize';\n    export const OUTPUT_FONT_FAMILY = 'notebook.output.fontFamily';\n    export const OUTPUT_SCROLLING = 'notebook.output.scrolling';\n    export const OUTPUT_WORD_WRAP = 'notebook.output.wordWrap';\n    export const OUTPUT_LINE_LIMIT = 'notebook.output.textLineLimit';\n}\n\nexport const notebookPreferenceSchema: PreferenceSchema = {\n    properties: {\n        [NotebookPreferences.NOTEBOOK_LINE_NUMBERS]: {\n            type: 'string',\n            enum: ['on', 'off'],\n            default: 'off',\n            description: nls.localizeByDefault('Controls the display of line numbers in the cell editor.')\n        },\n        [NotebookPreferences.OUTPUT_LINE_HEIGHT]: {\n            // eslint-disable-next-line max-len\n            markdownDescription: nls.localizeByDefault('Line height of the output text within notebook cells.\\n - When set to 0, editor line height is used.\\n - Values between 0 and 8 will be used as a multiplier with the font size.\\n - Values greater than or equal to 8 will be used as effective values.'),\n            type: 'number',\n            default: 0,\n            tags: ['notebookLayout', 'notebookOutputLayout']\n        },\n        [NotebookPreferences.OUTPUT_FONT_SIZE]: {\n            markdownDescription: nls.localizeByDefault('Font size for the output text within notebook cells. When set to 0, {0} is used.', '`#editor.fontSize#`'),\n            type: 'number',\n            default: 0,\n            tags: ['notebookLayout', 'notebookOutputLayout']\n        },\n        [NotebookPreferences.OUTPUT_FONT_FAMILY]: {\n            markdownDescription: nls.localizeByDefault('The font family of the output text within notebook cells. When set to empty, the {0} is used.', '`#editor.fontFamily#`'),\n            type: 'string',\n            tags: ['notebookLayout', 'notebookOutputLayout']\n        },\n        [NotebookPreferences.OUTPUT_SCROLLING]: {\n            markdownDescription: nls.localizeByDefault('Initially render notebook outputs in a scrollable region when longer than the limit.'),\n            type: 'boolean',\n            tags: ['notebookLayout', 'notebookOutputLayout'],\n            default: false\n        },\n        [NotebookPreferences.OUTPUT_WORD_WRAP]: {\n            markdownDescription: nls.localizeByDefault('Controls whether the lines in output should wrap.'),\n            type: 'boolean',\n            tags: ['notebookLayout', 'notebookOutputLayout'],\n            default: false\n        },\n        [NotebookPreferences.OUTPUT_LINE_LIMIT]: {\n            markdownDescription: nls.localizeByDefault(\n                'Controls how many lines of text are displayed in a text output. If {0} is enabled, this setting is used to determine the scroll height of the output.',\n                '`#notebook.output.scrolling#`'),\n            type: 'number',\n            default: 30,\n            tags: ['notebookLayout', 'notebookOutputLayout'],\n            minimum: 1,\n        },\n\n    }\n};\n","// *****************************************************************************\n// Copyright (C) 2023 TypeFox and others.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\n\nimport * as React from '@theia/core/shared/react';\nimport { CommandRegistry, MenuModelRegistry, URI } from '@theia/core';\nimport { ReactWidget, Navigatable, SaveableSource, Message, DelegatingSaveable, lock, unlock, animationFrame } from '@theia/core/lib/browser';\nimport { ReactNode } from '@theia/core/shared/react';\nimport { CellKind } from '../common';\nimport { CellRenderer as CellRenderer, NotebookCellListView } from './view/notebook-cell-list-view';\nimport { NotebookCodeCellRenderer } from './view/notebook-code-cell-view';\nimport { NotebookMarkdownCellRenderer } from './view/notebook-markdown-cell-view';\nimport { NotebookModel } from './view-model/notebook-model';\nimport { NotebookCellToolbarFactory } from './view/notebook-cell-toolbar-factory';\nimport { inject, injectable, interfaces, postConstruct } from '@theia/core/shared/inversify';\nimport { Emitter } from '@theia/core/shared/vscode-languageserver-protocol';\nimport { NotebookEditorWidgetService } from './service/notebook-editor-widget-service';\nimport { NotebookMainToolbarRenderer } from './view/notebook-main-toolbar';\nimport { Deferred } from '@theia/core/lib/common/promise-util';\nimport { MarkdownString } from '@theia/core/lib/common/markdown-rendering';\nimport { NotebookContextManager } from './service/notebook-context-manager';\nimport { NotebookViewportService } from './view/notebook-viewport-service';\nimport { NotebookCellCommands } from './contributions/notebook-cell-actions-contribution';\nconst PerfectScrollbar = require('react-perfect-scrollbar');\n\nexport const NotebookEditorWidgetContainerFactory = Symbol('NotebookEditorWidgetContainerFactory');\n\nexport function createNotebookEditorWidgetContainer(parent: interfaces.Container, props: NotebookEditorProps): interfaces.Container {\n    const child = parent.createChild();\n\n    child.bind(NotebookEditorProps).toConstantValue(props);\n\n    child.bind(NotebookContextManager).toSelf().inSingletonScope();\n    child.bind(NotebookMainToolbarRenderer).toSelf().inSingletonScope();\n    child.bind(NotebookCellToolbarFactory).toSelf().inSingletonScope();\n    child.bind(NotebookCodeCellRenderer).toSelf().inSingletonScope();\n    child.bind(NotebookMarkdownCellRenderer).toSelf().inSingletonScope();\n    child.bind(NotebookViewportService).toSelf().inSingletonScope();\n\n    child.bind(NotebookEditorWidget).toSelf();\n\n    return child;\n}\n\nexport const NotebookEditorProps = Symbol('NotebookEditorProps');\n\ninterface RenderMessage {\n    rendererId: string;\n    message: unknown;\n}\n\nexport interface NotebookEditorProps {\n    uri: URI,\n    readonly notebookType: string,\n    notebookData: Promise<NotebookModel>\n}\nexport const NOTEBOOK_EDITOR_ID_PREFIX = 'notebook:';\n\n@injectable()\nexport class NotebookEditorWidget extends ReactWidget implements Navigatable, SaveableSource {\n    static readonly ID = 'notebook';\n\n    readonly saveable = new DelegatingSaveable();\n\n    @inject(NotebookCellToolbarFactory)\n    protected readonly cellToolbarFactory: NotebookCellToolbarFactory;\n\n    @inject(CommandRegistry)\n    protected commandRegistry: CommandRegistry;\n\n    @inject(MenuModelRegistry)\n    protected menuRegistry: MenuModelRegistry;\n\n    @inject(NotebookEditorWidgetService)\n    protected notebookEditorService: NotebookEditorWidgetService;\n\n    @inject(NotebookMainToolbarRenderer)\n    protected notebookMainToolbarRenderer: NotebookMainToolbarRenderer;\n\n    @inject(NotebookContextManager)\n    protected notebookContextManager: NotebookContextManager;\n\n    @inject(NotebookCodeCellRenderer)\n    protected codeCellRenderer: NotebookCodeCellRenderer;\n    @inject(NotebookMarkdownCellRenderer)\n    protected markdownCellRenderer: NotebookMarkdownCellRenderer;\n    @inject(NotebookEditorProps)\n    protected readonly props: NotebookEditorProps;\n\n    @inject(NotebookViewportService)\n    protected readonly viewportService: NotebookViewportService;\n\n    protected readonly onDidChangeModelEmitter = new Emitter<void>();\n    readonly onDidChangeModel = this.onDidChangeModelEmitter.event;\n\n    protected readonly onDidChangeReadOnlyEmitter = new Emitter<boolean | MarkdownString>();\n    readonly onDidChangeReadOnly = this.onDidChangeReadOnlyEmitter.event;\n\n    protected readonly onPostKernelMessageEmitter = new Emitter<unknown>();\n    readonly onPostKernelMessage = this.onPostKernelMessageEmitter.event;\n\n    protected readonly onDidPostKernelMessageEmitter = new Emitter<unknown>();\n    readonly onDidPostKernelMessage = this.onDidPostKernelMessageEmitter.event;\n\n    protected readonly onPostRendererMessageEmitter = new Emitter<RenderMessage>();\n    readonly onPostRendererMessage = this.onPostRendererMessageEmitter.event;\n\n    protected readonly onDidReceiveKernelMessageEmitter = new Emitter<unknown>();\n    readonly onDidReceiveKernelMessage = this.onDidReceiveKernelMessageEmitter.event;\n\n    protected readonly onDidChangeOutputInputFocusEmitter = new Emitter<boolean>();\n    readonly onDidChangeOutputInputFocus = this.onDidChangeOutputInputFocusEmitter.event;\n\n    protected readonly renderers = new Map<CellKind, CellRenderer>();\n    protected _model?: NotebookModel;\n    protected _ready: Deferred<NotebookModel> = new Deferred();\n    protected scrollBarRef = React.createRef<{ updateScroll(): void }>();\n\n    get notebookType(): string {\n        return this.props.notebookType;\n    }\n\n    get ready(): Promise<NotebookModel> {\n        return this._ready.promise;\n    }\n\n    get model(): NotebookModel | undefined {\n        return this._model;\n    }\n\n    @postConstruct()\n    protected init(): void {\n        this.id = NOTEBOOK_EDITOR_ID_PREFIX + this.props.uri.toString();\n        this.node.tabIndex = -1;\n\n        this.scrollOptions = {\n            suppressScrollY: true\n        };\n\n        this.title.closable = true;\n        this.update();\n\n        this.toDispose.push(this.onDidChangeModelEmitter);\n        this.toDispose.push(this.onDidChangeReadOnlyEmitter);\n\n        this.renderers.set(CellKind.Markup, this.markdownCellRenderer);\n        this.renderers.set(CellKind.Code, this.codeCellRenderer);\n        this._ready.resolve(this.waitForData());\n        this.ready.then(model => {\n            if (model.cells.length === 1 && model.cells[0].source === '') {\n                this.commandRegistry.executeCommand(NotebookCellCommands.EDIT_COMMAND.id, model, model.cells[0]);\n                model.setSelectedCell(model.cells[0]);\n            }\n            model.cells.forEach(cell => cell.onWillBlurCellEditor(() => this.node.focus()));\n            model.onDidAddOrRemoveCell(e => e.newCellIds?.forEach(cellId => model.cells.find(cell => cell.handle === cellId)?.onWillBlurCellEditor(() => this.node.focus())));\n        });\n    }\n\n    protected async waitForData(): Promise<NotebookModel> {\n        this._model = await this.props.notebookData;\n        this.saveable.delegate = this._model;\n        this.toDispose.push(this._model);\n        this.toDispose.push(this._model.onDidChangeContent(() => {\n            // Update the scroll bar content after the content has changed\n            // Wait one frame to ensure that the content has been rendered\n            animationFrame().then(() => this.scrollBarRef.current?.updateScroll());\n        }));\n        this.toDispose.push(this._model.onDidChangeReadOnly(readOnly => {\n            if (readOnly) {\n                lock(this.title);\n            } else {\n                unlock(this.title);\n            }\n            this.onDidChangeReadOnlyEmitter.fire(readOnly);\n            this.update();\n        }));\n        if (this._model.readOnly) {\n            lock(this.title);\n        }\n        // Ensure that the model is loaded before adding the editor\n        this.notebookEditorService.addNotebookEditor(this);\n        this.update();\n        this.notebookContextManager.init(this);\n        return this._model;\n    }\n\n    protected override onActivateRequest(msg: Message): void {\n        super.onActivateRequest(msg);\n        this.node.focus();\n    }\n\n    getResourceUri(): URI | undefined {\n        return this.props.uri;\n    }\n\n    createMoveToUri(resourceUri: URI): URI | undefined {\n        return this.model?.uri.withPath(resourceUri.path);\n    }\n\n    undo(): void {\n        this._model?.undo();\n    }\n\n    redo(): void {\n        this._model?.redo();\n    }\n\n    protected render(): ReactNode {\n        if (this._model) {\n            return <div className='theia-notebook-main-container'>\n                {this.notebookMainToolbarRenderer.render(this._model, this.node)}\n                <div className='theia-notebook-viewport' ref={(ref: HTMLDivElement) => this.viewportService.viewportElement = ref}>\n                    <PerfectScrollbar className='theia-notebook-scroll-container'\n                        ref={this.scrollBarRef}\n                        onScrollY={(e: HTMLDivElement) => this.viewportService.onScroll(e)}>\n                        <NotebookCellListView renderers={this.renderers}\n                            notebookModel={this._model}\n                            toolbarRenderer={this.cellToolbarFactory}\n                            commandRegistry={this.commandRegistry} />\n                    </PerfectScrollbar>\n                </div>\n            </div >;\n        } else {\n            return <div className='theia-notebook-main-container'>\n                <div className='theia-notebook-main-loading-indicator'></div>\n            </div>;\n        }\n    }\n\n    protected override onCloseRequest(msg: Message): void {\n        super.onCloseRequest(msg);\n        this.notebookEditorService.removeNotebookEditor(this);\n    }\n\n    postKernelMessage(message: unknown): void {\n        this.onDidPostKernelMessageEmitter.fire(message);\n    }\n\n    postRendererMessage(rendererId: string, message: unknown): void {\n        this.onPostRendererMessageEmitter.fire({ rendererId, message });\n    }\n\n    recieveKernelMessage(message: unknown): void {\n        this.onDidReceiveKernelMessageEmitter.fire(message);\n    }\n\n    outputInputFocusChanged(focused: boolean): void {\n        this.onDidChangeOutputInputFocusEmitter.fire(focused);\n    }\n\n    override dispose(): void {\n        this.notebookContextManager.dispose();\n        this.onDidChangeModelEmitter.dispose();\n        this.onDidPostKernelMessageEmitter.dispose();\n        this.onDidReceiveKernelMessageEmitter.dispose();\n        this.onPostRendererMessageEmitter.dispose();\n        this.onDidChangeOutputInputFocusEmitter.dispose();\n        this.viewportService.dispose();\n        this._model?.dispose();\n        super.dispose();\n    }\n\n    protected override onAfterShow(msg: Message): void {\n        super.onAfterShow(msg);\n        this.notebookEditorService.notebookEditorFocusChanged(this, true);\n    }\n\n    protected override onAfterHide(msg: Message): void {\n        super.onAfterHide(msg);\n        this.notebookEditorService.notebookEditorFocusChanged(this, false);\n    }\n}\n","// *****************************************************************************\n// Copyright (C) 2023 TypeFox and others.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\n\nimport { URI, MaybePromise, Disposable } from '@theia/core';\nimport { NavigatableWidgetOpenHandler, WidgetOpenerOptions } from '@theia/core/lib/browser';\nimport { injectable } from '@theia/core/shared/inversify';\nimport { NotebookFileSelector, NotebookTypeDescriptor } from '../common/notebook-protocol';\nimport { NotebookEditorWidget } from './notebook-editor-widget';\nimport { match } from '@theia/core/lib/common/glob';\nimport { NotebookEditorWidgetOptions } from './notebook-editor-widget-factory';\n\nexport interface NotebookWidgetOpenerOptions extends WidgetOpenerOptions {\n    notebookType?: string;\n}\n\n@injectable()\nexport class NotebookOpenHandler extends NavigatableWidgetOpenHandler<NotebookEditorWidget> {\n\n    readonly id = NotebookEditorWidget.ID;\n\n    protected notebookTypes: NotebookTypeDescriptor[] = [];\n\n    registerNotebookType(notebookType: NotebookTypeDescriptor): Disposable {\n        this.notebookTypes.push(notebookType);\n        return Disposable.create(() => {\n            this.notebookTypes.splice(this.notebookTypes.indexOf(notebookType), 1);\n        });\n    }\n\n    canHandle(uri: URI, options?: NotebookWidgetOpenerOptions): MaybePromise<number> {\n        if (options?.notebookType) {\n            return this.canHandleType(uri, this.notebookTypes.find(type => type.type === options.notebookType));\n        }\n        return Math.max(...this.notebookTypes.map(type => this.canHandleType(uri, type)));\n    }\n\n    canHandleType(uri: URI, notebookType?: NotebookTypeDescriptor): number {\n        if (notebookType?.selector && this.matches(notebookType.selector, uri)) {\n            return this.calculatePriority(notebookType);\n        } else {\n            return 0;\n        }\n    }\n\n    protected calculatePriority(notebookType: NotebookTypeDescriptor | undefined): number {\n        if (!notebookType) {\n            return 0;\n        }\n        return notebookType.priority === 'option' ? 100 : 200;\n    }\n\n    protected findHighestPriorityType(uri: URI): NotebookTypeDescriptor | undefined {\n        const matchingTypes = this.notebookTypes\n            .filter(notebookType => notebookType.selector && this.matches(notebookType.selector, uri))\n            .map(notebookType => ({ descriptor: notebookType, priority: this.calculatePriority(notebookType) }));\n\n        if (matchingTypes.length === 0) {\n            return undefined;\n        }\n        let type = matchingTypes[0];\n        for (let i = 1; i < matchingTypes.length; i++) {\n            const notebookType = matchingTypes[i];\n            if (notebookType.priority > type.priority) {\n                type = notebookType;\n            }\n        }\n        return type.descriptor;\n    }\n\n    // Override for better options typing\n    override open(uri: URI, options?: NotebookWidgetOpenerOptions): Promise<NotebookEditorWidget> {\n        return super.open(uri, options);\n    }\n\n    protected override createWidgetOptions(uri: URI, options?: NotebookWidgetOpenerOptions): NotebookEditorWidgetOptions {\n        const widgetOptions = super.createWidgetOptions(uri, options);\n        if (options?.notebookType) {\n            return {\n                notebookType: options.notebookType,\n                ...widgetOptions\n            };\n        }\n        const notebookType = this.findHighestPriorityType(uri);\n        if (!notebookType) {\n            throw new Error('No notebook types registered for uri: ' + uri.toString());\n        }\n        return {\n            notebookType: notebookType.type,\n            ...widgetOptions\n        };\n    }\n\n    protected matches(selectors: readonly NotebookFileSelector[], resource: URI): boolean {\n        return selectors.some(selector => this.selectorMatches(selector, resource));\n    }\n\n    protected selectorMatches(selector: NotebookFileSelector, resource: URI): boolean {\n        return !!selector.filenamePattern\n            && match(selector.filenamePattern, resource.path.name + resource.path.ext);\n    }\n}\n","// *****************************************************************************\n// Copyright (C) 2023 TypeFox and others.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\n/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *  Copied from commit 18b2c92451b076943e5b508380e0eba66ba7d934 from file src\\vs\\workbench\\contrib\\notebook\\common\\notebookCommon.ts\n *--------------------------------------------------------------------------------------------*/\n\nimport { BinaryBuffer } from '@theia/core/lib/common/buffer';\n\nconst textDecoder = new TextDecoder();\n\n/**\n * Given a stream of individual stdout outputs, this function will return the compressed lines, escaping some of the common terminal escape codes.\n * E.g. some terminal escape codes would result in the previous line getting cleared, such if we had 3 lines and\n * last line contained such a code, then the result string would be just the first two lines.\n * @returns a single VSBuffer with the concatenated and compressed data, and whether any compression was done.\n */\nexport function compressOutputItemStreams(outputs: Uint8Array[]): { data: BinaryBuffer, didCompression: boolean } {\n    const buffers: Uint8Array[] = [];\n    let startAppending = false;\n\n    // Pick the first set of outputs with the same mime type.\n    for (const output of outputs) {\n        if ((buffers.length === 0 || startAppending)) {\n            buffers.push(output);\n            startAppending = true;\n        }\n    }\n\n    let didCompression = compressStreamBuffer(buffers);\n    const concatenated = BinaryBuffer.concat(buffers.map(buffer => BinaryBuffer.wrap(buffer)));\n    const data = formatStreamText(concatenated);\n    didCompression = didCompression || data.byteLength !== concatenated.byteLength;\n    return { data, didCompression };\n}\n\nexport const MOVE_CURSOR_1_LINE_COMMAND = `${String.fromCharCode(27)}[A`;\nconst MOVE_CURSOR_1_LINE_COMMAND_BYTES = MOVE_CURSOR_1_LINE_COMMAND.split('').map(c => c.charCodeAt(0));\nconst LINE_FEED = 10;\nfunction compressStreamBuffer(streams: Uint8Array[]): boolean {\n    let didCompress = false;\n    streams.forEach((stream, index) => {\n        if (index === 0 || stream.length < MOVE_CURSOR_1_LINE_COMMAND.length) {\n            return;\n        }\n\n        const previousStream = streams[index - 1];\n\n        // Remove the previous line if required.\n        const command = stream.subarray(0, MOVE_CURSOR_1_LINE_COMMAND.length);\n        if (command[0] === MOVE_CURSOR_1_LINE_COMMAND_BYTES[0] && command[1] === MOVE_CURSOR_1_LINE_COMMAND_BYTES[1] && command[2] === MOVE_CURSOR_1_LINE_COMMAND_BYTES[2]) {\n            const lastIndexOfLineFeed = previousStream.lastIndexOf(LINE_FEED);\n            if (lastIndexOfLineFeed === -1) {\n                return;\n            }\n\n            didCompress = true;\n            streams[index - 1] = previousStream.subarray(0, lastIndexOfLineFeed);\n            streams[index] = stream.subarray(MOVE_CURSOR_1_LINE_COMMAND.length);\n        }\n    });\n    return didCompress;\n}\n\nconst BACKSPACE_CHARACTER = '\\b'.charCodeAt(0);\nconst CARRIAGE_RETURN_CHARACTER = '\\r'.charCodeAt(0);\nfunction formatStreamText(buffer: BinaryBuffer): BinaryBuffer {\n    // We have special handling for backspace and carriage return characters.\n    // Don't unnecessary decode the bytes if we don't need to perform any processing.\n    if (!buffer.buffer.includes(BACKSPACE_CHARACTER) && !buffer.buffer.includes(CARRIAGE_RETURN_CHARACTER)) {\n        return buffer;\n    }\n    // Do the same thing jupyter is doing\n    return BinaryBuffer.fromString(fixCarriageReturn(fixBackspace(textDecoder.decode(buffer.buffer))));\n}\n\n/**\n * Took this from jupyter/notebook\n * https://github.com/jupyter/notebook/blob/b8b66332e2023e83d2ee04f83d8814f567e01a4e/notebook/static/base/js/utils.js\n * Remove characters that are overridden by backspace characters\n */\nfunction fixBackspace(txt: string): string {\n    let tmp = txt;\n    do {\n        txt = tmp;\n        // Cancel out anything-but-newline followed by backspace\n        tmp = txt.replace(/[^\\n]\\x08/gm, '');\n    } while (tmp.length < txt.length);\n    return txt;\n}\n\n/**\n * Remove chunks that should be overridden by the effect of carriage return characters\n * From https://github.com/jupyter/notebook/blob/master/notebook/static/base/js/utils.js\n */\nfunction fixCarriageReturn(txt: string): string {\n    txt = txt.replace(/\\r+\\n/gm, '\\n'); // \\r followed by \\n --> newline\n    while (txt.search(/\\r[^$]/g) > -1) {\n        const base = txt.match(/^(.*)\\r+/m)![1];\n        let insert = txt.match(/\\r+(.*)$/m)![1];\n        insert = insert + base.slice(insert.length, base.length);\n        txt = txt.replace(/\\r+.*$/m, '\\r').replace(/^.*\\r/m, insert);\n    }\n    return txt;\n}\n","// *****************************************************************************\n// Copyright (C) 2023 TypeFox and others.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\n/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { Disposable, Path } from '@theia/core';\nimport { injectable } from '@theia/core/shared/inversify';\nimport { NotebookRendererDescriptor } from '../common/notebook-protocol';\n\nexport interface NotebookRendererInfo {\n    readonly id: string;\n    readonly displayName: string;\n    readonly mimeTypes: string[];\n    readonly entrypoint: { readonly extends?: string; readonly uri: string };\n    readonly requiresMessaging: boolean;\n}\n\nexport interface NotebookPreloadInfo {\n    readonly type: string;\n    readonly entrypoint: string;\n}\n\n@injectable()\nexport class NotebookRendererRegistry {\n\n    private readonly _notebookRenderers: NotebookRendererInfo[] = [];\n\n    get notebookRenderers(): readonly NotebookRendererInfo[] {\n        return this._notebookRenderers;\n    }\n\n    private readonly _staticNotebookPreloads: NotebookPreloadInfo[] = [];\n\n    get staticNotebookPreloads(): readonly NotebookPreloadInfo[] {\n        return this._staticNotebookPreloads;\n    }\n\n    registerNotebookRenderer(type: NotebookRendererDescriptor, basePath: string): Disposable {\n        let entrypoint;\n        if (typeof type.entrypoint === 'string') {\n            entrypoint = {\n                uri: new Path(basePath).join(type.entrypoint).toString()\n            };\n        } else {\n            entrypoint = {\n                uri: new Path(basePath).join(type.entrypoint.path).toString(),\n                extends: type.entrypoint.extends\n            };\n        }\n\n        this._notebookRenderers.push({\n            ...type,\n            mimeTypes: type.mimeTypes || [],\n            requiresMessaging: type.requiresMessaging === 'always' || type.requiresMessaging === 'optional',\n            entrypoint\n        });\n        return Disposable.create(() => {\n            this._notebookRenderers.splice(this._notebookRenderers.findIndex(renderer => renderer.id === type.id), 1);\n        });\n    }\n\n    registerStaticNotebookPreload(type: string, entrypoint: string, basePath: string): Disposable {\n        const staticPreload = { type, entrypoint: new Path(basePath).join(entrypoint).toString() };\n        this._staticNotebookPreloads.push(staticPreload);\n        return Disposable.create(() => {\n            this._staticNotebookPreloads.splice(this._staticNotebookPreloads.indexOf(staticPreload), 1);\n        });\n    }\n}\n\n","// *****************************************************************************\n// Copyright (C) 2023 TypeFox and others.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\n\nimport { Disposable, DisposableCollection } from '@theia/core';\nimport { inject, injectable } from '@theia/core/shared/inversify';\nimport { OpenWithService } from '@theia/core/lib/browser';\nimport { NotebookTypeDescriptor } from '../common/notebook-protocol';\nimport { NotebookOpenHandler } from './notebook-open-handler';\n\n@injectable()\nexport class NotebookTypeRegistry {\n\n    @inject(OpenWithService)\n    protected readonly openWithService: OpenWithService;\n\n    @inject(NotebookOpenHandler)\n    protected readonly notebookOpenHandler: NotebookOpenHandler;\n\n    private readonly _notebookTypes: NotebookTypeDescriptor[] = [];\n\n    get notebookTypes(): readonly NotebookTypeDescriptor[] {\n        return this._notebookTypes;\n    }\n\n    registerNotebookType(type: NotebookTypeDescriptor, providerName: string): Disposable {\n        const toDispose = new DisposableCollection();\n        toDispose.push(Disposable.create(() => {\n            this._notebookTypes.splice(this._notebookTypes.indexOf(type), 1);\n        }));\n        this._notebookTypes.push(type);\n        toDispose.push(this.notebookOpenHandler.registerNotebookType(type));\n        toDispose.push(this.openWithService.registerHandler({\n            id: type.type,\n            label: type.displayName,\n            providerName,\n            canHandle: uri => this.notebookOpenHandler.canHandleType(uri, type),\n            open: uri => this.notebookOpenHandler.open(uri, { notebookType: type.type })\n        }));\n        return toDispose;\n    }\n}\n","// *****************************************************************************\n// Copyright (C) 2023 TypeFox and others.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\n\nimport { Disposable } from '@theia/core';\nimport { NotebookCellModel } from '../view-model/notebook-cell-model';\nimport { NotebookModel } from '../view-model/notebook-model';\n\nexport const CellOutputWebviewFactory = Symbol('outputWebviewFactory');\n\nexport type CellOutputWebviewFactory = (cell: NotebookCellModel, notebook: NotebookModel) => Promise<CellOutputWebview>;\n\nexport interface CellOutputWebview extends Disposable {\n\n    readonly id: string;\n\n    render(): React.ReactNode;\n\n    attachWebview(): void;\n    isAttached(): boolean\n}\n","// *****************************************************************************\n// Copyright (C) 2024 Typefox and others.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\n\nimport { inject, injectable } from '@theia/core/shared/inversify';\nimport { ClipboardService } from '@theia/core/lib/browser/clipboard-service';\nimport { NotebookCellModel } from '../view-model/notebook-cell-model';\nimport { environment } from '@theia/core';\nimport { CellData } from '../../common';\n\n@injectable()\nexport class NotebookClipboardService {\n\n    protected copiedCell: CellData | undefined;\n\n    @inject(ClipboardService)\n    protected readonly clipboardService: ClipboardService;\n\n    copyCell(cell: NotebookCellModel): void {\n        this.copiedCell = cell.getData();\n\n        if (environment.electron.is()) {\n            this.clipboardService.writeText(cell.text);\n        }\n    }\n\n    getCell(): CellData | undefined {\n        return this.copiedCell;\n    }\n\n}\n","// *****************************************************************************\n// Copyright (C) 2024 TypeFox and others.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\n\nimport { inject, injectable } from '@theia/core/shared/inversify';\nimport { ContextKeyChangeEvent, ContextKeyService, ContextMatcher, ScopedValueStore } from '@theia/core/lib/browser/context-key-service';\nimport { DisposableCollection, Emitter } from '@theia/core';\nimport { NotebookKernelService } from './notebook-kernel-service';\nimport {\n    NOTEBOOK_CELL_EDITABLE,\n    NOTEBOOK_CELL_EXECUTING, NOTEBOOK_CELL_EXECUTION_STATE,\n    NOTEBOOK_CELL_FOCUSED, NOTEBOOK_CELL_MARKDOWN_EDIT_MODE,\n    NOTEBOOK_CELL_TYPE, NOTEBOOK_HAS_OUTPUTS, NOTEBOOK_KERNEL, NOTEBOOK_KERNEL_SELECTED,\n    NOTEBOOK_OUTPUT_INPUT_FOCUSED,\n    NOTEBOOK_VIEW_TYPE\n} from '../contributions/notebook-context-keys';\nimport { NotebookEditorWidget } from '../notebook-editor-widget';\nimport { NotebookCellModel } from '../view-model/notebook-cell-model';\nimport { CellKind, NotebookCellsChangeType } from '../../common';\nimport { NotebookExecutionStateService } from './notebook-execution-state-service';\n\n@injectable()\nexport class NotebookContextManager {\n    @inject(ContextKeyService) protected contextKeyService: ContextKeyService;\n\n    @inject(NotebookKernelService)\n    protected readonly notebookKernelService: NotebookKernelService;\n\n    @inject(NotebookExecutionStateService)\n    protected readonly executionStateService: NotebookExecutionStateService;\n\n    protected readonly toDispose = new DisposableCollection();\n\n    protected readonly onDidChangeContextEmitter = new Emitter<ContextKeyChangeEvent>();\n    readonly onDidChangeContext = this.onDidChangeContextEmitter.event;\n\n    protected _context?: HTMLElement;\n\n    scopedStore: ScopedValueStore;\n\n    get context(): HTMLElement | undefined {\n        return this._context;\n    }\n\n    protected cellContexts: Map<number, Record<string, unknown>> = new Map();\n\n    init(widget: NotebookEditorWidget): void {\n        this._context = widget.node;\n        this.scopedStore = this.contextKeyService.createScoped(widget.node);\n\n        this.toDispose.dispose();\n\n        this.scopedStore.setContext(NOTEBOOK_VIEW_TYPE, widget?.notebookType);\n\n        // Kernel related keys\n        const kernel = widget?.model ? this.notebookKernelService.getSelectedNotebookKernel(widget.model) : undefined;\n        this.scopedStore.setContext(NOTEBOOK_KERNEL_SELECTED, !!kernel);\n        this.scopedStore.setContext(NOTEBOOK_KERNEL, kernel?.id);\n        this.toDispose.push(this.notebookKernelService.onDidChangeSelectedKernel(e => {\n            if (e.notebook.toString() === widget?.getResourceUri()?.toString()) {\n                this.scopedStore.setContext(NOTEBOOK_KERNEL_SELECTED, !!e.newKernel);\n                this.scopedStore.setContext(NOTEBOOK_KERNEL, e.newKernel);\n                this.onDidChangeContextEmitter.fire(this.createContextKeyChangedEvent([NOTEBOOK_KERNEL_SELECTED, NOTEBOOK_KERNEL]));\n            }\n        }));\n\n        widget.model?.onDidChangeContent(events => {\n            if (events.some(e => e.kind === NotebookCellsChangeType.ModelChange || e.kind === NotebookCellsChangeType.Output)) {\n                this.scopedStore.setContext(NOTEBOOK_HAS_OUTPUTS, widget.model?.cells.some(cell => cell.outputs.length > 0));\n                this.onDidChangeContextEmitter.fire(this.createContextKeyChangedEvent([NOTEBOOK_HAS_OUTPUTS]));\n            }\n        });\n\n        this.scopedStore.setContext(NOTEBOOK_HAS_OUTPUTS, !!widget.model?.cells.find(cell => cell.outputs.length > 0));\n\n        // Cell Selection realted keys\n        this.scopedStore.setContext(NOTEBOOK_CELL_FOCUSED, !!widget.model?.selectedCell);\n        widget.model?.onDidChangeSelectedCell(e => {\n            this.selectedCellChanged(e.cell);\n            this.scopedStore.setContext(NOTEBOOK_CELL_FOCUSED, !!e);\n            this.onDidChangeContextEmitter.fire(this.createContextKeyChangedEvent([NOTEBOOK_CELL_FOCUSED]));\n        });\n\n        this.toDispose.push(this.executionStateService.onDidChangeExecution(e => {\n            if (e.notebook.toString() === widget.model?.uri.toString()) {\n                this.setCellContext(e.cellHandle, NOTEBOOK_CELL_EXECUTING, !!e.changed);\n                this.setCellContext(e.cellHandle, NOTEBOOK_CELL_EXECUTION_STATE, e.changed?.state ?? 'idle');\n                this.onDidChangeContextEmitter.fire(this.createContextKeyChangedEvent([NOTEBOOK_CELL_EXECUTING, NOTEBOOK_CELL_EXECUTION_STATE]));\n            }\n        }));\n\n        widget.onDidChangeOutputInputFocus(focus => {\n            this.scopedStore.setContext(NOTEBOOK_OUTPUT_INPUT_FOCUSED, focus);\n            this.onDidChangeContextEmitter.fire(this.createContextKeyChangedEvent([NOTEBOOK_OUTPUT_INPUT_FOCUSED]));\n        });\n\n        this.onDidChangeContextEmitter.fire(this.createContextKeyChangedEvent([NOTEBOOK_VIEW_TYPE, NOTEBOOK_KERNEL_SELECTED, NOTEBOOK_KERNEL]));\n    }\n\n    protected cellDisposables = new DisposableCollection();\n\n    selectedCellChanged(cell: NotebookCellModel | undefined): void {\n        this.cellDisposables.dispose();\n\n        this.scopedStore.setContext(NOTEBOOK_CELL_TYPE, cell ? cell.cellKind === CellKind.Code ? 'code' : 'markdown' : undefined);\n\n        if (cell) {\n            this.scopedStore.setContext(NOTEBOOK_CELL_MARKDOWN_EDIT_MODE, cell.editing);\n            this.scopedStore.setContext(NOTEBOOK_CELL_EDITABLE, cell.cellKind === CellKind.Markup && !cell.editing);\n            this.cellDisposables.push(cell.onDidRequestCellEditChange(cellEdit => {\n                this.scopedStore.setContext(NOTEBOOK_CELL_MARKDOWN_EDIT_MODE, cellEdit);\n                this.scopedStore.setContext(NOTEBOOK_CELL_EDITABLE, cell.cellKind === CellKind.Markup && !cellEdit);\n                this.onDidChangeContextEmitter.fire(this.createContextKeyChangedEvent([NOTEBOOK_CELL_MARKDOWN_EDIT_MODE]));\n            }));\n        }\n\n        this.onDidChangeContextEmitter.fire(this.createContextKeyChangedEvent([NOTEBOOK_CELL_TYPE]));\n\n    }\n\n    protected setCellContext(cellHandle: number, key: string, value: unknown): void {\n        let cellContext = this.cellContexts.get(cellHandle);\n        if (!cellContext) {\n            cellContext = {};\n            this.cellContexts.set(cellHandle, cellContext);\n        }\n\n        cellContext[key] = value;\n    }\n\n    getCellContext(cellHandle: number): ContextMatcher {\n        return this.contextKeyService.createOverlay(Object.entries(this.cellContexts.get(cellHandle) ?? {}));\n    }\n\n    onDidEditorTextFocus(focus: boolean): void {\n        this.scopedStore.setContext('inputFocus', focus);\n    }\n\n    createContextKeyChangedEvent(affectedKeys: string[]): ContextKeyChangeEvent {\n        return { affects: keys => affectedKeys.some(key => keys.has(key)) };\n    }\n\n    dispose(): void {\n        this.toDispose.dispose();\n    }\n}\n","// *****************************************************************************\n// Copyright (C) 2023 TypeFox and others.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\n\n/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { Emitter } from '@theia/core';\nimport { inject, injectable, postConstruct } from '@theia/core/shared/inversify';\nimport { ApplicationShell } from '@theia/core/lib/browser';\nimport { NotebookEditorWidget } from '../notebook-editor-widget';\nimport { ContextKeyService } from '@theia/core/lib/browser/context-key-service';\nimport { NOTEBOOK_EDITOR_FOCUSED } from '../contributions/notebook-context-keys';\n\n@injectable()\nexport class NotebookEditorWidgetService {\n\n    @inject(ApplicationShell)\n    protected applicationShell: ApplicationShell;\n\n    @inject(ContextKeyService)\n    protected contextKeyService: ContextKeyService;\n\n    protected readonly notebookEditors = new Map<string, NotebookEditorWidget>();\n\n    protected readonly onNotebookEditorAddEmitter = new Emitter<NotebookEditorWidget>();\n    protected readonly onNotebookEditorRemoveEmitter = new Emitter<NotebookEditorWidget>();\n    readonly onDidAddNotebookEditor = this.onNotebookEditorAddEmitter.event;\n    readonly onDidRemoveNotebookEditor = this.onNotebookEditorRemoveEmitter.event;\n\n    protected readonly onDidChangeFocusedEditorEmitter = new Emitter<NotebookEditorWidget | undefined>();\n    readonly onDidChangeFocusedEditor = this.onDidChangeFocusedEditorEmitter.event;\n\n    focusedEditor?: NotebookEditorWidget = undefined;\n\n    @postConstruct()\n    protected init(): void {\n        this.applicationShell.onDidChangeActiveWidget(event => {\n            this.notebookEditorFocusChanged(event.newValue as NotebookEditorWidget, event.newValue instanceof NotebookEditorWidget);\n        });\n    }\n\n    // --- editor management\n\n    addNotebookEditor(editor: NotebookEditorWidget): void {\n        if (this.notebookEditors.has(editor.id)) {\n            console.warn('Attempting to add duplicated notebook editor: ' + editor.id);\n        }\n        this.notebookEditors.set(editor.id, editor);\n        this.onNotebookEditorAddEmitter.fire(editor);\n        if (editor.isVisible) {\n            this.notebookEditorFocusChanged(editor, true);\n        }\n    }\n\n    removeNotebookEditor(editor: NotebookEditorWidget): void {\n        if (this.notebookEditors.has(editor.id)) {\n            this.notebookEditors.delete(editor.id);\n            this.onNotebookEditorRemoveEmitter.fire(editor);\n        } else {\n            console.warn('Attempting to remove not registered editor: ' + editor.id);\n        }\n    }\n\n    getNotebookEditor(editorId: string): NotebookEditorWidget | undefined {\n        return this.notebookEditors.get(editorId);\n    }\n\n    getNotebookEditors(): readonly NotebookEditorWidget[] {\n        return Array.from(this.notebookEditors.values());\n    }\n\n    notebookEditorFocusChanged(editor: NotebookEditorWidget, focus: boolean): void {\n        if (focus) {\n            if (editor !== this.focusedEditor) {\n                this.focusedEditor = editor;\n                this.contextKeyService.setContext(NOTEBOOK_EDITOR_FOCUSED, true);\n                this.onDidChangeFocusedEditorEmitter.fire(this.focusedEditor);\n            }\n        } else if (this.focusedEditor) {\n            this.focusedEditor = undefined;\n            this.contextKeyService.setContext(NOTEBOOK_EDITOR_FOCUSED, false);\n            this.onDidChangeFocusedEditorEmitter.fire(undefined);\n        }\n    }\n\n}\n","// *****************************************************************************\n// Copyright (C) 2023 TypeFox and others.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\n/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { inject, injectable } from '@theia/core/shared/inversify';\nimport { CellExecution, NotebookExecutionStateService } from '../service/notebook-execution-state-service';\nimport { CellKind, NotebookCellExecutionState } from '../../common';\nimport { NotebookCellModel } from '../view-model/notebook-cell-model';\nimport { NotebookModel } from '../view-model/notebook-model';\nimport { NotebookKernelService } from './notebook-kernel-service';\nimport { CommandService, Disposable } from '@theia/core';\nimport { NotebookKernelQuickPickService } from './notebook-kernel-quick-pick-service';\nimport { NotebookKernelHistoryService } from './notebook-kernel-history-service';\n\nexport interface CellExecutionParticipant {\n    onWillExecuteCell(executions: CellExecution[]): Promise<void>;\n}\n\n@injectable()\nexport class NotebookExecutionService {\n\n    @inject(NotebookExecutionStateService)\n    protected notebookExecutionStateService: NotebookExecutionStateService;\n\n    @inject(NotebookKernelService)\n    protected notebookKernelService: NotebookKernelService;\n\n    @inject(NotebookKernelHistoryService)\n    protected notebookKernelHistoryService: NotebookKernelHistoryService;\n\n    @inject(CommandService)\n    protected commandService: CommandService;\n\n    @inject(NotebookKernelQuickPickService)\n    protected notebookKernelQuickPickService: NotebookKernelQuickPickService;\n\n    protected readonly cellExecutionParticipants = new Set<CellExecutionParticipant>();\n\n    async executeNotebookCells(notebook: NotebookModel, cells: Iterable<NotebookCellModel>): Promise<void> {\n        const cellsArr = Array.from(cells)\n            .filter(c => c.cellKind === CellKind.Code);\n        if (!cellsArr.length) {\n            return;\n        }\n\n        // create cell executions\n        const cellExecutions: [NotebookCellModel, CellExecution][] = [];\n        for (const cell of cellsArr) {\n            const cellExe = this.notebookExecutionStateService.getCellExecution(cell.uri);\n            if (!cellExe) {\n                cellExecutions.push([cell, this.notebookExecutionStateService.getOrCreateCellExecution(notebook.uri, cell.handle)]);\n            }\n        }\n\n        const kernel = await this.notebookKernelHistoryService.resolveSelectedKernel(notebook);\n\n        if (!kernel) {\n            // clear all pending cell executions\n            cellExecutions.forEach(cellExe => cellExe[1].complete({}));\n            return;\n        }\n\n        // filter cell executions based on selected kernel\n        const validCellExecutions: CellExecution[] = [];\n        for (const [cell, cellExecution] of cellExecutions) {\n            if (!kernel.supportedLanguages.includes(cell.language)) {\n                cellExecution.complete({});\n            } else {\n                validCellExecutions.push(cellExecution);\n            }\n        }\n\n        // request execution\n        if (validCellExecutions.length > 0) {\n            const cellRemoveListener = notebook.onDidAddOrRemoveCell(e => {\n                if (e.rawEvent.changes.some(c => c.deleteCount > 0)) {\n                    const executionsToCancel = validCellExecutions.filter(exec => !notebook.cells.find(cell => cell.handle === exec.cellHandle));\n                    if (executionsToCancel.length > 0) {\n                        kernel.cancelNotebookCellExecution(notebook.uri, executionsToCancel.map(c => c.cellHandle));\n                        executionsToCancel.forEach(exec => exec.complete({}));\n                    }\n                }\n            });\n            await this.runExecutionParticipants(validCellExecutions);\n\n            this.notebookKernelService.selectKernelForNotebook(kernel, notebook);\n            await kernel.executeNotebookCellsRequest(notebook.uri, validCellExecutions.map(c => c.cellHandle));\n            // the connecting state can change before the kernel resolves executeNotebookCellsRequest\n            const unconfirmed = validCellExecutions.filter(exe => exe.state === NotebookCellExecutionState.Unconfirmed);\n            if (unconfirmed.length) {\n                unconfirmed.forEach(exe => exe.complete({}));\n            }\n\n            cellRemoveListener.dispose();\n\n        }\n    }\n\n    registerExecutionParticipant(participant: CellExecutionParticipant): Disposable {\n        this.cellExecutionParticipants.add(participant);\n        return Disposable.create(() => this.cellExecutionParticipants.delete(participant));\n    }\n\n    protected async runExecutionParticipants(executions: CellExecution[]): Promise<void> {\n        for (const participant of this.cellExecutionParticipants) {\n            await participant.onWillExecuteCell(executions);\n        }\n        return;\n    }\n\n    async cancelNotebookCellHandles(notebook: NotebookModel, cells: Iterable<number>): Promise<void> {\n        const cellsArr = Array.from(cells);\n        const kernel = this.notebookKernelService.getSelectedOrSuggestedKernel(notebook);\n        if (kernel) {\n            await kernel.cancelNotebookCellExecution(notebook.uri, cellsArr);\n        }\n    }\n\n    async cancelNotebookCells(notebook: NotebookModel, cells: Iterable<NotebookCellModel>): Promise<void> {\n        this.cancelNotebookCellHandles(notebook, Array.from(cells, cell => cell.handle));\n    }\n\n}\n","// *****************************************************************************\n// Copyright (C) 2023 TypeFox and others.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\n/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { Disposable, DisposableCollection, Emitter, URI, generateUuid } from '@theia/core';\nimport { inject, injectable } from '@theia/core/shared/inversify';\nimport { NotebookService } from './notebook-service';\nimport {\n    CellEditType, CellExecuteOutputEdit, CellExecuteOutputItemEdit, CellExecutionUpdateType,\n    CellUri, NotebookCellExecutionState, NotebookCellInternalMetadata\n} from '../../common';\nimport { CellPartialInternalMetadataEditByHandle, CellEditOperation } from '../notebook-types';\nimport { NotebookModel } from '../view-model/notebook-model';\n\nexport type CellExecuteUpdate = CellExecuteOutputEdit | CellExecuteOutputItemEdit | CellExecutionStateUpdate;\n\nexport interface CellExecutionComplete {\n    runEndTime?: number;\n    lastRunSuccess?: boolean;\n}\n\nexport interface CellExecutionStateUpdate {\n    editType: CellExecutionUpdateType.ExecutionState;\n    executionOrder?: number;\n    runStartTime?: number;\n    didPause?: boolean;\n    isPaused?: boolean;\n}\n\nexport enum NotebookExecutionType {\n    cell,\n    notebook\n}\n\nexport interface NotebookFailStateChangedEvent {\n    visible: boolean;\n    notebook: URI;\n}\n\nexport interface FailedCellInfo {\n    cellHandle: number;\n    disposable: Disposable;\n    visible: boolean;\n}\n\n@injectable()\nexport class NotebookExecutionStateService implements Disposable {\n\n    @inject(NotebookService)\n    protected notebookService: NotebookService;\n\n    protected toDispose: DisposableCollection = new DisposableCollection();\n\n    protected readonly executions = new Map<string, Map<number, CellExecution>>();\n\n    protected readonly onDidChangeExecutionEmitter = new Emitter<CellExecutionStateChangedEvent>();\n    onDidChangeExecution = this.onDidChangeExecutionEmitter.event;\n\n    protected readonly onDidChangeLastRunFailStateEmitter = new Emitter<NotebookFailStateChangedEvent>();\n    onDidChangeLastRunFailState = this.onDidChangeLastRunFailStateEmitter.event;\n\n    getOrCreateCellExecution(notebookUri: URI, cellHandle: number): CellExecution {\n        const notebook = this.notebookService.getNotebookEditorModel(notebookUri);\n\n        if (!notebook) {\n            throw new Error(`Notebook not found: ${notebookUri.toString()}`);\n        }\n\n        let execution = this.executions.get(notebookUri.toString())?.get(cellHandle);\n\n        if (!execution) {\n            execution = this.createNotebookCellExecution(notebook, cellHandle);\n            if (!this.executions.has(notebookUri.toString())) {\n                this.executions.set(notebookUri.toString(), new Map());\n            }\n            this.executions.get(notebookUri.toString())?.set(cellHandle, execution);\n            execution.initialize();\n            this.onDidChangeExecutionEmitter.fire(new CellExecutionStateChangedEvent(notebookUri, cellHandle, execution));\n        }\n\n        return execution;\n\n    }\n\n    protected createNotebookCellExecution(notebook: NotebookModel, cellHandle: number): CellExecution {\n        const notebookUri = notebook.uri;\n        const execution = new CellExecution(cellHandle, notebook);\n        execution.toDispose.push(execution.onDidUpdate(() => this.onDidChangeExecutionEmitter.fire(new CellExecutionStateChangedEvent(notebookUri, cellHandle, execution))));\n        execution.toDispose.push(execution.onDidComplete(lastRunSuccess => this.onCellExecutionDidComplete(notebookUri, cellHandle, execution, lastRunSuccess)));\n\n        return execution;\n    }\n\n    protected onCellExecutionDidComplete(notebookUri: URI, cellHandle: number, exe: CellExecution, lastRunSuccess?: boolean): void {\n        const notebookExecutions = this.executions.get(notebookUri.toString())?.get(cellHandle);\n        if (!notebookExecutions) {\n            throw new Error('Notebook Cell Execution not found while trying to complete it');\n        }\n\n        exe.dispose();\n        this.executions.get(notebookUri.toString())?.delete(cellHandle);\n\n        this.onDidChangeExecutionEmitter.fire(new CellExecutionStateChangedEvent(notebookUri, cellHandle));\n    }\n\n    getCellExecution(cellUri: URI): CellExecution | undefined {\n        const parsed = CellUri.parse(cellUri);\n        if (!parsed) {\n            throw new Error(`Not a cell URI: ${cellUri}`);\n        }\n\n        return this.executions.get(parsed.notebook.toString())?.get(parsed.handle);\n    }\n\n    dispose(): void {\n        this.onDidChangeExecutionEmitter.dispose();\n        this.onDidChangeLastRunFailStateEmitter.dispose();\n\n        this.executions.forEach(notebookExecutions => notebookExecutions.forEach(execution => execution.dispose()));\n    }\n\n}\n\nexport class CellExecution implements Disposable {\n    protected readonly onDidUpdateEmitter = new Emitter<void>();\n    readonly onDidUpdate = this.onDidUpdateEmitter.event;\n\n    protected readonly onDidCompleteEmitter = new Emitter<boolean | undefined>();\n    readonly onDidComplete = this.onDidCompleteEmitter.event;\n\n    toDispose = new DisposableCollection();\n\n    protected _state: NotebookCellExecutionState = NotebookCellExecutionState.Unconfirmed;\n    get state(): NotebookCellExecutionState {\n        return this._state;\n    }\n\n    get notebookURI(): URI {\n        return this.notebook.uri;\n    }\n\n    protected _didPause = false;\n    get didPause(): boolean {\n        return this._didPause;\n    }\n\n    protected _isPaused = false;\n    get isPaused(): boolean {\n        return this._isPaused;\n    }\n\n    constructor(\n        readonly cellHandle: number,\n        protected readonly notebook: NotebookModel,\n    ) {\n        console.debug(`CellExecution#ctor ${this.getCellLog()}`);\n    }\n\n    initialize(): void {\n        const startExecuteEdit: CellPartialInternalMetadataEditByHandle = {\n            editType: CellEditType.PartialInternalMetadata,\n            handle: this.cellHandle,\n            internalMetadata: {\n                executionId: generateUuid(),\n                runStartTime: undefined,\n                runEndTime: undefined,\n                lastRunSuccess: undefined,\n                executionOrder: undefined,\n                renderDuration: undefined,\n            }\n        };\n        this.applyCellExecutionEditsToNotebook([startExecuteEdit]);\n    }\n\n    protected getCellLog(): string {\n        return `${this.notebookURI.toString()}, ${this.cellHandle}`;\n    }\n\n    confirm(): void {\n        this._state = NotebookCellExecutionState.Pending;\n        this.onDidUpdateEmitter.fire();\n    }\n\n    update(updates: CellExecuteUpdate[]): void {\n        if (updates.some(u => u.editType === CellExecutionUpdateType.ExecutionState)) {\n            this._state = NotebookCellExecutionState.Executing;\n        }\n\n        if (!this._didPause && updates.some(u => u.editType === CellExecutionUpdateType.ExecutionState && u.didPause)) {\n            this._didPause = true;\n        }\n\n        const lastIsPausedUpdate = [...updates].reverse().find(u => u.editType === CellExecutionUpdateType.ExecutionState && typeof u.isPaused === 'boolean');\n        if (lastIsPausedUpdate) {\n            this._isPaused = (lastIsPausedUpdate as CellExecutionStateUpdate).isPaused!;\n        }\n\n        const cellModel = this.notebook.cells.find(c => c.handle === this.cellHandle);\n        if (!cellModel) {\n            console.debug(`CellExecution#update, updating cell not in notebook: ${this.notebook.uri.toString()}, ${this.cellHandle}`);\n        } else {\n            const edits = updates.map(update => updateToEdit(update, this.cellHandle));\n            this.applyCellExecutionEditsToNotebook(edits);\n        }\n\n        if (updates.some(u => u.editType === CellExecutionUpdateType.ExecutionState)) {\n            this.onDidUpdateEmitter.fire();\n        }\n\n    }\n\n    complete(completionData: CellExecutionComplete): void {\n        const cellModel = this.notebook.cells.find(c => c.handle === this.cellHandle);\n        if (!cellModel) {\n            console.debug(`CellExecution#complete, completing cell not in notebook: ${this.notebook.uri.toString()}, ${this.cellHandle}`);\n        } else {\n            const edit: CellEditOperation = {\n                editType: CellEditType.PartialInternalMetadata,\n                handle: this.cellHandle,\n                internalMetadata: {\n                    lastRunSuccess: completionData.lastRunSuccess,\n                    // eslint-disable-next-line no-null/no-null\n                    runStartTime: this._didPause ? null : cellModel.internalMetadata.runStartTime,\n                    // eslint-disable-next-line no-null/no-null\n                    runEndTime: this._didPause ? null : completionData.runEndTime,\n                }\n            };\n            this.applyCellExecutionEditsToNotebook([edit]);\n        }\n\n        this.onDidCompleteEmitter.fire(completionData.lastRunSuccess);\n\n    }\n\n    dispose(): void {\n        this.onDidUpdateEmitter.dispose();\n        this.onDidCompleteEmitter.dispose();\n        this.toDispose.dispose();\n    }\n\n    protected applyCellExecutionEditsToNotebook(edits: CellEditOperation[]): void {\n        this.notebook.applyEdits(edits, false);\n    }\n}\n\nexport class CellExecutionStateChangedEvent {\n    readonly type = NotebookExecutionType.cell;\n    constructor(\n        readonly notebook: URI,\n        readonly cellHandle: number,\n        readonly changed?: CellExecution\n    ) { }\n\n    affectsCell(cell: URI): boolean {\n        const parsedUri = CellUri.parse(cell);\n        return !!parsedUri && this.notebook.isEqual(parsedUri.notebook) && this.cellHandle === parsedUri.handle;\n    }\n\n    affectsNotebook(notebook: URI): boolean {\n        return this.notebook.toString() === notebook.toString();\n    }\n}\n\nexport function updateToEdit(update: CellExecuteUpdate, cellHandle: number): CellEditOperation {\n    if (update.editType === CellExecutionUpdateType.Output) {\n        return {\n            editType: CellEditType.Output,\n            handle: update.cellHandle,\n            append: update.append,\n            outputs: update.outputs,\n        };\n    } else if (update.editType === CellExecutionUpdateType.OutputItems) {\n        return {\n            editType: CellEditType.OutputItems,\n            items: update.items,\n            outputId: update.outputId,\n            append: update.append,\n        };\n    } else if (update.editType === CellExecutionUpdateType.ExecutionState) {\n        const newInternalMetadata: Partial<NotebookCellInternalMetadata> = {};\n        if (typeof update.executionOrder !== 'undefined') {\n            newInternalMetadata.executionOrder = update.executionOrder;\n        }\n        if (typeof update.runStartTime !== 'undefined') {\n            newInternalMetadata.runStartTime = update.runStartTime;\n        }\n        return {\n            editType: CellEditType.PartialInternalMetadata,\n            handle: cellHandle,\n            internalMetadata: newInternalMetadata\n        };\n    }\n\n    throw new Error('Unknown cell update type');\n}\n","// *****************************************************************************\n// Copyright (C) 2023 TypeFox and others.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\n/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { inject, injectable, postConstruct } from '@theia/core/shared/inversify';\nimport { StorageService } from '@theia/core/lib/browser';\nimport { NotebookKernel, NotebookTextModelLike, NotebookKernelService } from './notebook-kernel-service';\nimport { CommandService, Disposable } from '@theia/core';\nimport { NotebookModel } from '../view-model/notebook-model';\nimport { NotebookCommands } from '../contributions/notebook-actions-contribution';\n\ninterface KernelsList {\n    [viewType: string]: string[];\n}\n\ninterface MostRecentKernelsResult {\n    selected?: NotebookKernel,\n    all: NotebookKernel[]\n}\n\nconst MAX_KERNELS_IN_HISTORY = 5;\n\n@injectable()\nexport class NotebookKernelHistoryService implements Disposable {\n\n    @inject(StorageService)\n    protected storageService: StorageService;\n\n    @inject(NotebookKernelService)\n    protected notebookKernelService: NotebookKernelService;\n\n    @inject(CommandService)\n    protected commandService: CommandService;\n\n    protected static STORAGE_KEY = 'notebook.kernelHistory';\n    protected mostRecentKernelsMap: KernelsList = {};\n\n    @postConstruct()\n    protected init(): void {\n        this.loadState();\n    }\n\n    getKernels(notebook: NotebookTextModelLike): MostRecentKernelsResult {\n        const allAvailableKernels = this.notebookKernelService.getMatchingKernel(notebook);\n        const allKernels = allAvailableKernels.all;\n        const selectedKernel = allAvailableKernels.selected;\n        // We will suggest the only kernel\n        const suggested = allAvailableKernels.all.length === 1 ? allAvailableKernels.all[0] : undefined;\n        const mostRecentKernelIds = this.mostRecentKernelsMap[notebook.viewType] ? this.mostRecentKernelsMap[notebook.viewType].map(kernel => kernel[1]) : [];\n        const all = mostRecentKernelIds.map(kernelId => allKernels.find(kernel => kernel.id === kernelId)).filter(kernel => !!kernel) as NotebookKernel[];\n\n        return {\n            selected: selectedKernel ?? suggested,\n            all\n        };\n    }\n\n    async resolveSelectedKernel(notebook: NotebookModel): Promise<NotebookKernel | undefined> {\n        const alreadySelected = this.getKernels(notebook);\n\n        if (alreadySelected.selected) {\n            return alreadySelected.selected;\n        }\n\n        await this.commandService.executeCommand(NotebookCommands.SELECT_KERNEL_COMMAND.id, notebook);\n        const { selected } = this.getKernels(notebook);\n        return selected;\n    }\n\n    addMostRecentKernel(kernel: NotebookKernel): void {\n        const viewType = kernel.viewType;\n        const recentKernels = this.mostRecentKernelsMap[viewType] ?? [kernel.id];\n\n        if (recentKernels.length > MAX_KERNELS_IN_HISTORY) {\n            recentKernels.splice(MAX_KERNELS_IN_HISTORY);\n        }\n\n        this.mostRecentKernelsMap[viewType] = recentKernels;\n        this.saveState();\n    }\n\n    protected saveState(): void {\n        let notEmpty = false;\n        for (const kernels of Object.values(this.mostRecentKernelsMap)) {\n            notEmpty = notEmpty || Object.entries(kernels).length > 0;\n        }\n\n        this.storageService.setData(NotebookKernelHistoryService.STORAGE_KEY, notEmpty ? this.mostRecentKernelsMap : undefined);\n    }\n\n    protected async loadState(): Promise<void> {\n        const kernelMap = await this.storageService.getData(NotebookKernelHistoryService.STORAGE_KEY);\n        if (kernelMap) {\n            this.mostRecentKernelsMap = kernelMap as KernelsList;\n        } else {\n            this.mostRecentKernelsMap = {};\n        }\n    }\n\n    clear(): void {\n        this.mostRecentKernelsMap = {};\n        this.saveState();\n    }\n\n    dispose(): void {\n\n    }\n}\n","\n// *****************************************************************************\n// Copyright (C) 2023 TypeFox and others.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\n/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { ArrayUtils, CommandService, DisposableCollection, Event, nls, QuickInputButton, QuickInputService, QuickPickInput, QuickPickItem, URI, } from '@theia/core';\nimport { inject, injectable } from '@theia/core/shared/inversify';\nimport { NotebookKernelService, NotebookKernel, NotebookKernelMatchResult, SourceCommand } from './notebook-kernel-service';\nimport { NotebookModel } from '../view-model/notebook-model';\nimport { NotebookEditorWidget } from '../notebook-editor-widget';\nimport { codicon, OpenerService } from '@theia/core/lib/browser';\nimport { NotebookKernelHistoryService } from './notebook-kernel-history-service';\nimport { NotebookCommand, NotebookModelResource } from '../../common';\nimport debounce = require('@theia/core/shared/lodash.debounce');\n\nexport const JUPYTER_EXTENSION_ID = 'ms-toolsai.jupyter';\n\ntype KernelPick = QuickPickItem & { kernel: NotebookKernel };\nfunction isKernelPick(item: QuickPickInput<QuickPickItem>): item is KernelPick {\n    return 'kernel' in item;\n}\ntype GroupedKernelsPick = QuickPickItem & { kernels: NotebookKernel[]; source: string };\nfunction isGroupedKernelsPick(item: QuickPickInput<QuickPickItem>): item is GroupedKernelsPick {\n    return 'kernels' in item;\n}\ntype SourcePick = QuickPickItem & { action: SourceCommand };\nfunction isSourcePick(item: QuickPickInput<QuickPickItem>): item is SourcePick {\n    return 'action' in item;\n}\ntype InstallExtensionPick = QuickPickItem & { extensionIds: string[] };\n\ntype KernelSourceQuickPickItem = QuickPickItem & { command: NotebookCommand; documentation?: string };\nfunction isKernelSourceQuickPickItem(item: QuickPickItem): item is KernelSourceQuickPickItem {\n    return 'command' in item;\n}\n\nfunction supportAutoRun(item: QuickPickInput<KernelQuickPickItem>): item is QuickPickItem {\n    return 'autoRun' in item && !!item.autoRun;\n}\n\ntype KernelQuickPickItem = (QuickPickItem & { autoRun?: boolean }) | InstallExtensionPick | KernelPick | GroupedKernelsPick | SourcePick | KernelSourceQuickPickItem;\n\nconst KERNEL_PICKER_UPDATE_DEBOUNCE = 200;\n\nexport type KernelQuickPickContext =\n    { id: string; extension: string } |\n    { notebookEditorId: string } |\n    { id: string; extension: string; notebookEditorId: string } |\n    { ui?: boolean; notebookEditor?: NotebookEditorWidget };\n\nfunction toKernelQuickPick(kernel: NotebookKernel, selected: NotebookKernel | undefined): KernelPick {\n    const res: KernelPick = {\n        kernel,\n        label: kernel.label,\n        description: kernel.description,\n        detail: kernel.detail\n    };\n    if (kernel.id === selected?.id) {\n        if (!res.description) {\n            res.description = nls.localizeByDefault('Currently Selected');\n        } else {\n            res.description = nls.localizeByDefault('{0} - Currently Selected', res.description);\n        }\n    }\n    return res;\n}\n\n@injectable()\nexport class NotebookKernelQuickPickService {\n\n    @inject(NotebookKernelService)\n    protected readonly notebookKernelService: NotebookKernelService;\n    @inject(QuickInputService)\n    protected readonly quickInputService: QuickInputService;\n    @inject(CommandService)\n    protected readonly commandService: CommandService;\n\n    @inject(OpenerService)\n    protected openerService: OpenerService;\n\n    @inject(NotebookKernelHistoryService)\n    protected notebookKernelHistoryService: NotebookKernelHistoryService;\n\n    async showQuickPick(editor: NotebookModel, wantedId?: string, skipAutoRun?: boolean): Promise<boolean> {\n        const notebook = editor;\n        const matchResult = this.getMatchingResult(notebook);\n        const { selected, all } = matchResult;\n\n        let newKernel: NotebookKernel | undefined;\n        if (wantedId) {\n            for (const candidate of all) {\n                if (candidate.id === wantedId) {\n                    newKernel = candidate;\n                    break;\n                }\n            }\n            if (!newKernel) {\n                console.warn(`wanted kernel DOES NOT EXIST, wanted: ${wantedId}, all: ${all.map(k => k.id)}`);\n                return false;\n            }\n        }\n\n        if (newKernel) {\n            this.selectKernel(notebook, newKernel);\n            return true;\n        }\n\n        const quickPick = this.quickInputService.createQuickPick<KernelQuickPickItem>();\n        const quickPickItems = this.getKernelPickerQuickPickItems(matchResult);\n\n        if (quickPickItems.length === 1 && supportAutoRun(quickPickItems[0]) && !skipAutoRun) {\n            return this.handleQuickPick(editor, quickPickItems[0], quickPickItems as KernelQuickPickItem[]);\n        }\n\n        quickPick.items = quickPickItems;\n        quickPick.canSelectMany = false;\n        quickPick.placeholder = selected\n            ? nls.localizeByDefault(\"Change kernel for '{0}'\", 'current') // TODO get label for current notebook from a label provider\n            : nls.localizeByDefault(\"Select kernel for '{0}'\", 'current');\n\n        quickPick.busy = this.notebookKernelService.getKernelDetectionTasks(notebook).length > 0;\n\n        const kernelDetectionTaskListener = this.notebookKernelService.onDidChangeKernelDetectionTasks(() => {\n            quickPick.busy = this.notebookKernelService.getKernelDetectionTasks(notebook).length > 0;\n        });\n\n        const kernelChangeEventListener = debounce(\n            Event.any(\n                this.notebookKernelService.onDidChangeSourceActions,\n                this.notebookKernelService.onDidAddKernel,\n                this.notebookKernelService.onDidRemoveKernel,\n                this.notebookKernelService.onDidChangeNotebookAffinity\n            ),\n            KERNEL_PICKER_UPDATE_DEBOUNCE\n        )(async () => {\n            // reset quick pick progress\n            quickPick.busy = false;\n\n            const currentActiveItems = quickPick.activeItems;\n            const newMatchResult = this.getMatchingResult(notebook);\n            const newQuickPickItems = this.getKernelPickerQuickPickItems(newMatchResult);\n            quickPick.keepScrollPosition = true;\n\n            // recalculate active items\n            const activeItems: KernelQuickPickItem[] = [];\n            for (const item of currentActiveItems) {\n                if (isKernelPick(item)) {\n                    const kernelId = item.kernel.id;\n                    const sameItem = newQuickPickItems.find(pi => isKernelPick(pi) && pi.kernel.id === kernelId) as KernelPick | undefined;\n                    if (sameItem) {\n                        activeItems.push(sameItem);\n                    }\n                } else if (isSourcePick(item)) {\n                    const sameItem = newQuickPickItems.find(pi => isSourcePick(pi) && pi.action.command.id === item.action.command.id) as SourcePick | undefined;\n                    if (sameItem) {\n                        activeItems.push(sameItem);\n                    }\n                }\n            }\n\n            quickPick.items = newQuickPickItems;\n            quickPick.activeItems = activeItems;\n        }, this);\n\n        const pick = await new Promise<{ selected: KernelQuickPickItem | undefined; items: KernelQuickPickItem[] }>((resolve, reject) => {\n            quickPick.onDidAccept(() => {\n                const item = quickPick.selectedItems[0];\n                if (item) {\n                    resolve({ selected: item, items: quickPick.items as KernelQuickPickItem[] });\n                } else {\n                    resolve({ selected: undefined, items: quickPick.items as KernelQuickPickItem[] });\n                }\n\n                quickPick.hide();\n            });\n\n            quickPick.onDidHide(() => {\n                kernelDetectionTaskListener.dispose();\n                kernelChangeEventListener?.dispose();\n                quickPick.dispose();\n                resolve({ selected: undefined, items: quickPick.items as KernelQuickPickItem[] });\n            });\n            quickPick.show();\n        });\n\n        if (pick.selected) {\n            return this.handleQuickPick(editor, pick.selected, pick.items);\n        }\n\n        return false;\n    }\n\n    protected getKernelPickerQuickPickItems(matchResult: NotebookKernelMatchResult): QuickPickInput<KernelQuickPickItem>[] {\n        const quickPickItems: QuickPickInput<KernelQuickPickItem>[] = [];\n\n        if (matchResult.selected) {\n            const kernelItem = toKernelQuickPick(matchResult.selected, matchResult.selected);\n            quickPickItems.push(kernelItem);\n        }\n\n        // TODO use suggested here when kernel affinity is implemented. For now though show all kernels\n        matchResult.all.filter(kernel => kernel.id !== matchResult.selected?.id).map(kernel => toKernelQuickPick(kernel, matchResult.selected))\n            .forEach(kernel => {\n                quickPickItems.push(kernel);\n            });\n\n        const shouldAutoRun = quickPickItems.length === 0;\n\n        if (quickPickItems.length > 0) {\n            quickPickItems.push({\n                type: 'separator'\n            });\n        }\n\n        // select another kernel quick pick\n        quickPickItems.push({\n            id: 'selectAnother',\n            label: nls.localizeByDefault('Select Another Kernel...'),\n            autoRun: shouldAutoRun\n        });\n\n        return quickPickItems;\n    }\n\n    protected selectKernel(notebook: NotebookModel, kernel: NotebookKernel): void {\n        const currentInfo = this.notebookKernelService.getMatchingKernel(notebook);\n        if (currentInfo.selected) {\n            // there is already a selected kernel\n            this.notebookKernelHistoryService.addMostRecentKernel(currentInfo.selected);\n        }\n        this.notebookKernelService.selectKernelForNotebook(kernel, notebook);\n        this.notebookKernelHistoryService.addMostRecentKernel(kernel);\n    }\n\n    protected getMatchingResult(notebook: NotebookModel): NotebookKernelMatchResult {\n        const { selected, all } = this.notebookKernelHistoryService.getKernels(notebook);\n        const matchingResult = this.notebookKernelService.getMatchingKernel(notebook);\n        return {\n            selected: selected,\n            all: matchingResult.all,\n            suggestions: all,\n            hidden: []\n        };\n    }\n\n    protected async handleQuickPick(editor: NotebookModel, pick: KernelQuickPickItem, items: KernelQuickPickItem[]): Promise<boolean> {\n        if (pick.id === 'selectAnother') {\n            return this.displaySelectAnotherQuickPick(editor, items.length === 1 && items[0] === pick);\n        }\n\n        if (isKernelPick(pick)) {\n            const newKernel = pick.kernel;\n            this.selectKernel(editor, newKernel);\n            return true;\n        }\n\n        if (isSourcePick(pick)) {\n            // selected explicitly, it should trigger the execution?\n            pick.action.run(this.commandService);\n        }\n\n        return true;\n    }\n\n    protected async displaySelectAnotherQuickPick(editor: NotebookModel, kernelListEmpty: boolean): Promise<boolean> {\n        const notebook: NotebookModel = editor;\n        const disposables = new DisposableCollection();\n        const quickPick = this.quickInputService.createQuickPick<KernelQuickPickItem>();\n        const quickPickItem = await new Promise<KernelQuickPickItem | QuickInputButton | undefined>(resolve => {\n            // select from kernel sources\n            quickPick.title = kernelListEmpty ? nls.localizeByDefault('Select Kernel') : nls.localizeByDefault('Select Another Kernel');\n            quickPick.placeholder = nls.localizeByDefault('Type to choose a kernel source');\n            quickPick.busy = true;\n            // quickPick.buttons = [this.quickInputService.backButton];\n            quickPick.show();\n\n            disposables.push(quickPick.onDidTriggerButton(button => {\n                if (button === this.quickInputService.backButton) {\n                    resolve(button);\n                }\n            }));\n            quickPick.onDidTriggerItemButton(async e => {\n\n                if (isKernelSourceQuickPickItem(e.item) && e.item.documentation !== undefined) {\n                    const uri: URI | undefined = this.isUri(e.item.documentation) ? new URI(e.item.documentation) : await this.commandService.executeCommand(e.item.documentation);\n                    if (uri) {\n                        (await this.openerService.getOpener(uri, { openExternal: true })).open(uri, { openExternal: true });\n                    }\n                }\n            });\n            disposables.push(quickPick.onDidAccept(async () => {\n                resolve(quickPick.selectedItems[0]);\n            }));\n            disposables.push(quickPick.onDidHide(() => {\n                resolve(undefined);\n            }));\n\n            this.calculateKernelSources(editor).then(quickPickItems => {\n                quickPick.items = quickPickItems;\n                if (quickPick.items.length > 0) {\n                    quickPick.busy = false;\n                }\n            });\n\n            debounce(\n                Event.any(\n                    this.notebookKernelService.onDidChangeSourceActions,\n                    this.notebookKernelService.onDidAddKernel,\n                    this.notebookKernelService.onDidRemoveKernel\n                ),\n                KERNEL_PICKER_UPDATE_DEBOUNCE,\n            )(async () => {\n                quickPick.busy = true;\n                const quickPickItems = await this.calculateKernelSources(editor);\n                quickPick.items = quickPickItems;\n                quickPick.busy = false;\n            });\n        });\n\n        quickPick.hide();\n        disposables.dispose();\n\n        if (quickPickItem === this.quickInputService.backButton) {\n            return this.showQuickPick(editor, undefined, true);\n        }\n\n        if (quickPickItem) {\n            const selectedKernelPickItem = quickPickItem as KernelQuickPickItem;\n            if (isKernelSourceQuickPickItem(selectedKernelPickItem)) {\n                try {\n                    const selectedKernelId = await this.executeCommand<string>(notebook, selectedKernelPickItem.command);\n                    if (selectedKernelId) {\n                        const { all } = this.getMatchingResult(notebook);\n                        const notebookKernel = all.find(kernel => kernel.id === `ms-toolsai.jupyter/${selectedKernelId}`);\n                        if (notebookKernel) {\n                            this.selectKernel(notebook, notebookKernel);\n                            return true;\n                        }\n                        return true;\n                    } else {\n                        return this.displaySelectAnotherQuickPick(editor, false);\n                    }\n                } catch (ex) {\n                    console.error('Failed to select notebook kernel', ex);\n                    return false;\n                }\n            } else if (isKernelPick(selectedKernelPickItem)) {\n                this.selectKernel(notebook, selectedKernelPickItem.kernel);\n                return true;\n            } else if (isGroupedKernelsPick(selectedKernelPickItem)) {\n                await this.selectOneKernel(notebook, selectedKernelPickItem.source, selectedKernelPickItem.kernels);\n                return true;\n            } else if (isSourcePick(selectedKernelPickItem)) {\n                // selected explicitly, it should trigger the execution?\n                try {\n                    await selectedKernelPickItem.action.run(this.commandService);\n                    return true;\n                } catch (ex) {\n                    console.error('Failed to select notebook kernel', ex);\n                    return false;\n                }\n            }\n            // } else if (isSearchMarketplacePick(selectedKernelPickItem)) {\n            //     await this.showKernelExtension(\n            //         this.paneCompositePartService,\n            //         this.extensionWorkbenchService,\n            //         this.extensionService,\n            //         editor.textModel.viewType,\n            //         []\n            //     );\n            //     return true;\n            // } else if (isInstallExtensionPick(selectedKernelPickItem)) {\n            //     await this.showKernelExtension(\n            //         this.paneCompositePartService,\n            //         this.extensionWorkbenchService,\n            //         this.extensionService,\n            //         editor.textModel.viewType,\n            //         selectedKernelPickItem.extensionIds,\n            //     );\n            //     return true;\n            // }\n        }\n\n        return false;\n    }\n\n    protected isUri(value: string): boolean {\n        return /^(?<scheme>\\w[\\w\\d+.-]*):/.test(value);\n    }\n\n    protected async calculateKernelSources(editor: NotebookModel): Promise<QuickPickInput<KernelQuickPickItem>[]> {\n        const notebook: NotebookModel = editor;\n\n        const actions = await this.notebookKernelService.getKernelSourceActionsFromProviders(notebook);\n        const matchResult = this.getMatchingResult(notebook);\n\n        const others = matchResult.all.filter(item => item.extensionId !== JUPYTER_EXTENSION_ID);\n        const quickPickItems: QuickPickInput<KernelQuickPickItem>[] = [];\n\n        // group controllers by extension\n        for (const group of ArrayUtils.groupBy(others, (a, b) => a.extensionId === b.extensionId ? 0 : 1)) {\n            const source = group[0].extensionId;\n            if (group.length > 1) {\n                quickPickItems.push({\n                    label: source,\n                    kernels: group\n                });\n            } else {\n                quickPickItems.push({\n                    label: group[0].label,\n                    kernel: group[0]\n                });\n            }\n        }\n\n        const validActions = actions.filter(action => action.command);\n\n        quickPickItems.push(...validActions.map(action => {\n            const buttons = action.documentation ? [{\n                iconClass: codicon('info'),\n                tooltip: nls.localizeByDefault('Learn More'),\n            }] : [];\n            return {\n                id: typeof action.command! === 'string' ? action.command! : action.command!.id,\n                label: action.label,\n                description: action.description,\n                command: action.command,\n                documentation: action.documentation,\n                buttons\n            };\n        }));\n\n        return quickPickItems;\n    }\n\n    protected async selectOneKernel(notebook: NotebookModel, source: string, kernels: NotebookKernel[]): Promise<void> {\n        const quickPickItems: QuickPickInput<KernelPick>[] = kernels.map(kernel => toKernelQuickPick(kernel, undefined));\n        const quickPick = this.quickInputService.createQuickPick<KernelQuickPickItem>();\n        quickPick.items = quickPickItems;\n        quickPick.canSelectMany = false;\n\n        quickPick.title = nls.localizeByDefault('Select Kernel from {0}', source);\n\n        quickPick.onDidAccept(async () => {\n            if (quickPick.selectedItems && quickPick.selectedItems.length > 0 && isKernelPick(quickPick.selectedItems[0])) {\n                this.selectKernel(notebook, quickPick.selectedItems[0].kernel);\n            }\n\n            quickPick.hide();\n            quickPick.dispose();\n        });\n\n        quickPick.onDidHide(() => {\n            quickPick.dispose();\n        });\n\n        quickPick.show();\n    }\n\n    protected async executeCommand<T>(notebook: NotebookModel, command: NotebookCommand): Promise<T | undefined | void> {\n        const args = (command.arguments || []).concat([NotebookModelResource.create(notebook.uri)]);\n        return this.commandService.executeCommand(command.id, ...args);\n    }\n}\n","// *****************************************************************************\n// Copyright (C) 2023 TypeFox and others.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\n/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { Command, CommandService, Disposable, Emitter, Event, URI } from '@theia/core';\nimport { inject, injectable, postConstruct } from '@theia/core/shared/inversify';\nimport { StorageService } from '@theia/core/lib/browser';\nimport { NotebookKernelSourceAction } from '../../common';\nimport { NotebookModel } from '../view-model/notebook-model';\nimport { NotebookService } from './notebook-service';\n\nexport interface SelectedNotebookKernelChangeEvent {\n    notebook: URI;\n    oldKernel: string | undefined;\n    newKernel: string | undefined;\n}\n\nexport interface NotebookKernelMatchResult {\n    readonly selected: NotebookKernel | undefined;\n    readonly suggestions: NotebookKernel[];\n    readonly all: NotebookKernel[];\n    readonly hidden: NotebookKernel[];\n}\n\nexport interface NotebookKernelChangeEvent {\n    label?: true;\n    description?: true;\n    detail?: true;\n    supportedLanguages?: true;\n    hasExecutionOrder?: true;\n    hasInterruptHandler?: true;\n}\n\nexport interface NotebookKernel {\n    readonly id: string;\n    readonly viewType: string;\n    readonly onDidChange: Event<Readonly<NotebookKernelChangeEvent>>;\n    // ID of the extension providing this kernel\n    readonly extensionId: string;\n\n    readonly localResourceRoot: URI;\n    readonly preloadUris: URI[];\n    readonly preloadProvides: string[];\n\n    readonly handle: number;\n    label: string;\n    description?: string;\n    detail?: string;\n    supportedLanguages: string[];\n    implementsInterrupt?: boolean;\n    implementsExecutionOrder?: boolean;\n\n    executeNotebookCellsRequest(uri: URI, cellHandles: number[]): Promise<void>;\n    cancelNotebookCellExecution(uri: URI, cellHandles: number[]): Promise<void>;\n}\n\nexport const enum ProxyKernelState {\n    Disconnected = 1,\n    Connected = 2,\n    Initializing = 3\n}\n\nexport interface INotebookProxyKernelChangeEvent extends NotebookKernelChangeEvent {\n    connectionState?: true;\n}\n\nexport interface NotebookTextModelLike { uri: URI; viewType: string }\n\nclass KernelInfo {\n\n    protected static instanceCounter = 0;\n\n    score: number;\n    readonly kernel: NotebookKernel;\n    readonly handle: number;\n\n    constructor(kernel: NotebookKernel) {\n        this.kernel = kernel;\n        this.score = -1;\n        this.handle = KernelInfo.instanceCounter++;\n    }\n}\n\nexport interface NotebookSourceActionChangeEvent {\n    notebook?: URI;\n    viewType: string;\n}\n\nexport interface KernelSourceActionProvider {\n    readonly viewType: string;\n    onDidChangeSourceActions?: Event<void>;\n    provideKernelSourceActions(): Promise<NotebookKernelSourceAction[]>;\n}\n\nexport class SourceCommand implements Disposable {\n    execution: Promise<void> | undefined;\n    protected readonly onDidChangeStateEmitter = new Emitter<void>();\n    readonly onDidChangeState = this.onDidChangeStateEmitter.event;\n\n    constructor(\n        readonly command: Command,\n        readonly model: NotebookTextModelLike,\n    ) { }\n\n    async run(commandService: CommandService): Promise<void> {\n        if (this.execution) {\n            return this.execution;\n        }\n\n        this.execution = this.runCommand(commandService);\n        this.onDidChangeStateEmitter.fire();\n        await this.execution;\n        this.execution = undefined;\n        this.onDidChangeStateEmitter.fire();\n    }\n\n    protected async runCommand(commandService: CommandService): Promise<void> {\n        try {\n            await commandService.executeCommand(this.command.id, {\n                uri: this.model.uri,\n            });\n\n        } catch (error) {\n            console.warn(`Kernel source command failed: ${error}`);\n        }\n    }\n\n    dispose(): void {\n        this.onDidChangeStateEmitter.dispose();\n    }\n\n}\n\nconst NOTEBOOK_KERNEL_BINDING_STORAGE_KEY = 'notebook.kernel.bindings';\n@injectable()\nexport class NotebookKernelService {\n\n    @inject(NotebookService)\n    protected notebookService: NotebookService;\n\n    @inject(StorageService)\n    protected storageService: StorageService;\n\n    protected readonly kernels = new Map<string, KernelInfo>();\n\n    protected notebookBindings: Record<string, string> = {};\n\n    protected readonly kernelDetectionTasks = new Map<string, string[]>();\n    protected readonly onDidChangeKernelDetectionTasksEmitter = new Emitter<string>();\n    readonly onDidChangeKernelDetectionTasks = this.onDidChangeKernelDetectionTasksEmitter.event;\n\n    protected readonly onDidChangeSourceActionsEmitter = new Emitter<NotebookSourceActionChangeEvent>();\n    protected readonly kernelSourceActionProviders = new Map<string, KernelSourceActionProvider[]>();\n    readonly onDidChangeSourceActions: Event<NotebookSourceActionChangeEvent> = this.onDidChangeSourceActionsEmitter.event;\n\n    protected readonly onDidAddKernelEmitter = new Emitter<NotebookKernel>();\n    readonly onDidAddKernel: Event<NotebookKernel> = this.onDidAddKernelEmitter.event;\n\n    protected readonly onDidRemoveKernelEmitter = new Emitter<NotebookKernel>();\n    readonly onDidRemoveKernel: Event<NotebookKernel> = this.onDidRemoveKernelEmitter.event;\n\n    protected readonly onDidChangeSelectedNotebookKernelBindingEmitter = new Emitter<SelectedNotebookKernelChangeEvent>();\n    readonly onDidChangeSelectedKernel: Event<SelectedNotebookKernelChangeEvent> = this.onDidChangeSelectedNotebookKernelBindingEmitter.event;\n\n    protected readonly onDidChangeNotebookAffinityEmitter = new Emitter<void>();\n    readonly onDidChangeNotebookAffinity: Event<void> = this.onDidChangeNotebookAffinityEmitter.event;\n\n    @postConstruct()\n    init(): void {\n        this.notebookService.onDidAddNotebookDocument(model => this.tryAutoBindNotebook(model));\n        this.storageService.getData(NOTEBOOK_KERNEL_BINDING_STORAGE_KEY).then((value: Record<string, string> | undefined) => {\n            if (value) {\n                this.notebookBindings = value;\n            }\n        });\n    }\n\n    registerKernel(kernel: NotebookKernel): Disposable {\n        if (this.kernels.has(kernel.id)) {\n            throw new Error(`Notebook Controller with id '${kernel.id}' already exists`);\n        }\n\n        this.kernels.set(kernel.id, new KernelInfo(kernel));\n        this.onDidAddKernelEmitter.fire(kernel);\n\n        // auto associate the new kernel to existing notebooks it was\n        // associated to in the past.\n        for (const notebook of this.notebookService.getNotebookModels()) {\n            this.tryAutoBindNotebook(notebook, kernel);\n        }\n\n        return Disposable.create(() => {\n            if (this.kernels.delete(kernel.id)) {\n                this.onDidRemoveKernelEmitter.fire(kernel);\n            }\n        });\n    }\n\n    /**\n     * Helps to find the best matching kernel for a notebook.\n     * @param notebook notebook to get the matching kernel for\n     * @returns and object containing:\n     *  all kernels sorted to match the notebook best first (affinity ascending, score descending, label))\n     *  the selected kernel (if any)\n     *  specific suggested kernels (if any)\n     *  hidden kernels (if any)\n     */\n    getMatchingKernel(notebook: NotebookTextModelLike): NotebookKernelMatchResult {\n        const kernels: { kernel: NotebookKernel; instanceAffinity: number; score: number }[] = [];\n        for (const info of this.kernels.values()) {\n            const score = NotebookKernelService.score(info.kernel, notebook);\n            if (score) {\n                kernels.push({\n                    score,\n                    kernel: info.kernel,\n                    instanceAffinity: 1 /* vscode.NotebookControllerPriority.Default */,\n                });\n            }\n        }\n\n        kernels\n            .sort((a, b) => b.instanceAffinity - a.instanceAffinity || a.score - b.score || a.kernel.label.localeCompare(b.kernel.label));\n        const all = kernels.map(obj => obj.kernel);\n\n        // bound kernel\n        const selected = this.getSelectedNotebookKernel(notebook);\n        const suggestions = kernels.filter(item => item.instanceAffinity > 1).map(item => item.kernel); // TODO implement notebookAffinity\n        const hidden = kernels.filter(item => item.instanceAffinity < 0).map(item => item.kernel);\n        return { all, selected, suggestions, hidden };\n\n    }\n\n    getSelectedNotebookKernel(notebook: NotebookTextModelLike): NotebookKernel | undefined {\n        const selectedId = this.notebookBindings[`${notebook.viewType}/${notebook.uri}`];\n        return selectedId ? this.kernels.get(selectedId)?.kernel : undefined;\n    }\n\n    selectKernelForNotebook(kernel: NotebookKernel | undefined, notebook: NotebookTextModelLike): void {\n        const key = `${notebook.viewType}/${notebook.uri}`;\n        const oldKernel = this.notebookBindings[key];\n        if (oldKernel !== kernel?.id) {\n            if (kernel) {\n                this.notebookBindings[key] = kernel.id;\n            } else {\n                delete this.notebookBindings[key];\n            }\n            this.storageService.setData(NOTEBOOK_KERNEL_BINDING_STORAGE_KEY, this.notebookBindings);\n            this.onDidChangeSelectedNotebookKernelBindingEmitter.fire({ notebook: notebook.uri, oldKernel, newKernel: kernel?.id });\n        }\n    }\n\n    getSelectedOrSuggestedKernel(notebook: NotebookModel): NotebookKernel | undefined {\n        const info = this.getMatchingKernel(notebook);\n        if (info.selected) {\n            return info.selected;\n        }\n\n        return info.all.length === 1 ? info.all[0] : undefined;\n    }\n\n    getKernel(id: string): NotebookKernel | undefined {\n        return this.kernels.get(id)?.kernel;\n    }\n\n    protected static score(kernel: NotebookKernel, notebook: NotebookTextModelLike): number {\n        if (kernel.viewType === notebook.viewType) {\n            return 10;\n        } else if (kernel.viewType === '*') {\n            return 5;\n        } else {\n            return 0;\n        }\n    }\n\n    protected tryAutoBindNotebook(notebook: NotebookModel, onlyThisKernel?: NotebookKernel): void {\n\n        const id = this.notebookBindings[`${notebook.viewType}/${notebook.uri}`];\n        if (!id) {\n            // no kernel associated\n            return;\n        }\n        const existingKernel = this.kernels.get(id);\n        if (!existingKernel || !NotebookKernelService.score(existingKernel.kernel, notebook)) {\n            // associated kernel not known, not matching\n            return;\n        }\n        if (!onlyThisKernel || existingKernel.kernel === onlyThisKernel) {\n            this.onDidChangeSelectedNotebookKernelBindingEmitter.fire({ notebook: notebook.uri, oldKernel: undefined, newKernel: existingKernel.kernel.id });\n        }\n    }\n\n    registerNotebookKernelDetectionTask(notebookType: string): Disposable {\n        const all = this.kernelDetectionTasks.get(notebookType) ?? [];\n        all.push(notebookType);\n        this.kernelDetectionTasks.set(notebookType, all);\n        this.onDidChangeKernelDetectionTasksEmitter.fire(notebookType);\n        return Disposable.create(() => {\n            const allTasks = this.kernelDetectionTasks.get(notebookType) ?? [];\n            const taskIndex = allTasks.indexOf(notebookType);\n            if (taskIndex >= 0) {\n                allTasks.splice(taskIndex, 1);\n                this.kernelDetectionTasks.set(notebookType, allTasks);\n                this.onDidChangeKernelDetectionTasksEmitter.fire(notebookType);\n            }\n        });\n    }\n\n    getKernelDetectionTasks(notebook: NotebookTextModelLike): string[] {\n        return this.kernelDetectionTasks.get(notebook.viewType) ?? [];\n    }\n\n    registerKernelSourceActionProvider(viewType: string, provider: KernelSourceActionProvider): Disposable {\n        const providers = this.kernelSourceActionProviders.get(viewType) ?? [];\n        providers.push(provider);\n        this.kernelSourceActionProviders.set(viewType, providers);\n        this.onDidChangeSourceActionsEmitter.fire({ viewType: viewType });\n\n        const eventEmitterDisposable = provider.onDidChangeSourceActions?.(() => {\n            this.onDidChangeSourceActionsEmitter.fire({ viewType: viewType });\n        });\n\n        return Disposable.create(() => {\n            const sourceProviders = this.kernelSourceActionProviders.get(viewType) ?? [];\n            const providerIndex = sourceProviders.indexOf(provider);\n            if (providerIndex >= 0) {\n                sourceProviders.splice(providerIndex, 1);\n                this.kernelSourceActionProviders.set(viewType, sourceProviders);\n            }\n\n            eventEmitterDisposable?.dispose();\n        });\n    }\n\n    async getKernelSourceActionsFromProviders(notebook: NotebookTextModelLike): Promise<NotebookKernelSourceAction[]> {\n        const viewType = notebook.viewType;\n        const providers = this.kernelSourceActionProviders.get(viewType) ?? [];\n        const promises = providers.map(provider => provider.provideKernelSourceActions());\n        const allActions = await Promise.all(promises);\n        return allActions.flat();\n    }\n}\n","// *****************************************************************************\n// Copyright (C) 2023 TypeFox and others.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\n\nimport { Emitter, Resource, ResourceProvider, UNTITLED_SCHEME, URI } from '@theia/core';\nimport { inject, injectable } from '@theia/core/shared/inversify';\nimport { UriComponents } from '@theia/core/lib/common/uri';\nimport { FileService } from '@theia/filesystem/lib/browser/file-service';\nimport { NotebookData } from '../../common';\nimport { NotebookModel } from '../view-model/notebook-model';\nimport { NotebookService } from './notebook-service';\nimport { NotebookTypeRegistry } from '../notebook-type-registry';\nimport { NotebookFileSelector } from '../../common/notebook-protocol';\nimport { match } from '@theia/core/lib/common/glob';\n\nexport interface UntitledResource {\n    untitledResource: URI | undefined\n}\n\n@injectable()\nexport class NotebookModelResolverService {\n\n    @inject(FileService)\n    protected fileService: FileService;\n\n    @inject(ResourceProvider)\n    protected resourceProvider: ResourceProvider;\n\n    @inject(NotebookService)\n    protected notebookService: NotebookService;\n\n    @inject(NotebookTypeRegistry)\n    protected notebookTypeRegistry: NotebookTypeRegistry;\n\n    protected onDidChangeDirtyEmitter = new Emitter<NotebookModel>();\n    readonly onDidChangeDirty = this.onDidChangeDirtyEmitter.event;\n    protected onDidSaveNotebookEmitter = new Emitter<UriComponents>();\n    readonly onDidSaveNotebook = this.onDidSaveNotebookEmitter.event;\n\n    async resolve(resource: URI, viewType?: string): Promise<NotebookModel> {\n        const existingModel = this.notebookService.getNotebookEditorModel(resource);\n        if (!viewType) {\n            if (existingModel) {\n                return existingModel;\n            } else {\n                viewType = this.findViewTypeForResource(resource);\n            }\n        } else if (existingModel?.viewType === viewType) {\n            return existingModel;\n        }\n\n        if (!viewType) {\n            throw new Error(`Missing viewType for '${resource}'`);\n        }\n\n        const actualResource = await this.resourceProvider(resource);\n        const notebookData = await this.resolveExistingNotebookData(actualResource, viewType!);\n        const notebookModel = await this.notebookService.createNotebookModel(notebookData, viewType, actualResource);\n\n        notebookModel.onDirtyChanged(() => this.onDidChangeDirtyEmitter.fire(notebookModel));\n        notebookModel.onDidSaveNotebook(() => this.onDidSaveNotebookEmitter.fire(notebookModel.uri.toComponents()));\n\n        return notebookModel;\n    }\n\n    async resolveUntitledResource(arg: UntitledResource, viewType: string): Promise<NotebookModel> {\n        let resource: URI;\n        // let hasAssociatedFilePath = false;\n        arg = arg as UntitledResource;\n        if (!arg.untitledResource) {\n            const notebookTypeInfo = this.notebookTypeRegistry.notebookTypes.find(info => info.type === viewType);\n            if (!notebookTypeInfo) {\n                throw new Error('UNKNOWN view type: ' + viewType);\n            }\n\n            const suffix = this.getPossibleFileEnding(notebookTypeInfo.selector ?? []) ?? '';\n            for (let counter = 1; ; counter++) {\n                const candidate = new URI()\n                    .withScheme(UNTITLED_SCHEME)\n                    .withPath(`Untitled-notebook-${counter}${suffix}`)\n                    .withQuery(viewType);\n                if (!this.notebookService.getNotebookEditorModel(candidate)) {\n                    resource = candidate;\n                    break;\n                }\n            }\n        } else if (arg.untitledResource.scheme === UNTITLED_SCHEME) {\n            resource = arg.untitledResource;\n        } else {\n            throw new Error('Invalid untitled resource: ' + arg.untitledResource.toString() + ' untitled resources with associated file path are not supported yet');\n            // TODO implement associated file path support\n            // resource = arg.untitledResource.withScheme('untitled');\n            // hasAssociatedFilePath = true;\n        }\n\n        return this.resolve(resource, viewType);\n    }\n\n    async resolveExistingNotebookData(resource: Resource, viewType: string): Promise<NotebookData> {\n        if (resource.uri.scheme === 'untitled') {\n            return {\n                cells: [],\n                metadata: {}\n            };\n        } else {\n            const [dataProvider, contents] = await Promise.all([\n                this.notebookService.getNotebookDataProvider(viewType),\n                this.fileService.readFile(resource.uri)\n            ]);\n            const notebook = await dataProvider.serializer.toNotebook(contents.value);\n\n            return notebook;\n        }\n    }\n\n    protected getPossibleFileEnding(selectors: readonly NotebookFileSelector[]): string | undefined {\n        for (const selector of selectors) {\n            const ending = this.possibleFileEnding(selector);\n            if (ending) {\n                return ending;\n            }\n        }\n        return undefined;\n    }\n\n    protected possibleFileEnding(selector: NotebookFileSelector): string | undefined {\n\n        const pattern = /^.*(\\.[a-zA-Z0-9_-]+)$/;\n\n        const candidate = typeof selector === 'string' ? selector : selector.filenamePattern;\n\n        if (candidate) {\n            const matches = pattern.exec(candidate);\n            if (matches) {\n                return matches[1];\n            }\n        }\n\n        return undefined;\n    }\n\n    protected findViewTypeForResource(resource: URI): string | undefined {\n        return this.notebookTypeRegistry.notebookTypes.find(info =>\n            info.selector?.some(selector => selector.filenamePattern && match(selector.filenamePattern, resource.path.name + resource.path.ext))\n        )?.type;\n    }\n\n}\n","// *****************************************************************************\n// Copyright (C) 2024 TypeFox and others.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\n\nimport { ReferenceCollection, URI, Reference, Event } from '@theia/core';\nimport { inject, injectable } from '@theia/core/shared/inversify';\nimport { MonacoTextModelService } from '@theia/monaco/lib/browser/monaco-text-model-service';\nimport { MonacoEditorModel } from '@theia/monaco/lib/browser/monaco-editor-model';\nimport { NotebookModel } from '../view-model/notebook-model';\n\n/**\n * special service for creating monaco textmodels for notebook cells.\n * Its for optimization purposes since there is alot of overhead otherwise with calling the backend to create a document for each cell and other smaller things.\n */\n@injectable()\nexport class NotebookMonacoTextModelService {\n\n    @inject(MonacoTextModelService)\n    protected readonly monacoTextModelService: MonacoTextModelService;\n\n    protected readonly cellmodels = new ReferenceCollection<string, MonacoEditorModel>(\n        uri => this.monacoTextModelService.createUnmanagedModel(new URI(uri))\n    );\n\n    getOrCreateNotebookCellModelReference(uri: URI): Promise<Reference<MonacoEditorModel>> {\n        return this.cellmodels.acquire(uri.toString());\n    }\n\n    async createTextModelsForNotebook(notebook: NotebookModel): Promise<void> {\n        await Promise.all(notebook.cells.map(cell => cell.resolveTextModel()));\n    }\n\n    get onDidCreateNotebookCellModel(): Event<MonacoEditorModel> {\n        return this.cellmodels.onDidCreate;\n    }\n}\n","\n// *****************************************************************************\n// Copyright (C) 2024 TypeFox and others.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\n\nimport { inject, injectable, postConstruct } from '@theia/core/shared/inversify';\nimport { PreferenceService } from '@theia/core/lib/browser';\nimport { Emitter } from '@theia/core';\nimport { NotebookPreferences, notebookPreferenceSchema } from '../contributions/notebook-preferences';\nimport { EditorPreferences } from '@theia/editor/lib/browser';\nimport { BareFontInfo } from '@theia/monaco-editor-core/esm/vs/editor/common/config/fontInfo';\nimport { PixelRatio } from '@theia/monaco-editor-core/esm/vs/base/browser/browser';\n\nconst notebookOutputOptionsRelevantPreferences = [\n    'editor.fontSize',\n    'editor.fontFamily',\n    NotebookPreferences.NOTEBOOK_LINE_NUMBERS,\n    NotebookPreferences.OUTPUT_LINE_HEIGHT,\n    NotebookPreferences.OUTPUT_FONT_SIZE,\n    NotebookPreferences.OUTPUT_FONT_FAMILY,\n    NotebookPreferences.OUTPUT_SCROLLING,\n    NotebookPreferences.OUTPUT_WORD_WRAP,\n    NotebookPreferences.OUTPUT_LINE_LIMIT\n];\n\nexport interface NotebookOutputOptions {\n    // readonly outputNodePadding: number;\n    // readonly outputNodeLeftPadding: number;\n    // readonly previewNodePadding: number;\n    // readonly markdownLeftMargin: number;\n    // readonly leftMargin: number;\n    // readonly rightMargin: number;\n    // readonly runGutter: number;\n    // readonly dragAndDropEnabled: boolean;\n    readonly fontSize: number;\n    readonly outputFontSize?: number;\n    readonly fontFamily: string;\n    readonly outputFontFamily?: string;\n    // readonly markupFontSize: number;\n    // readonly markdownLineHeight: number;\n    readonly outputLineHeight: number;\n    readonly outputScrolling: boolean;\n    readonly outputWordWrap: boolean;\n    readonly outputLineLimit: number;\n    // readonly outputLinkifyFilePaths: boolean;\n    // readonly minimalError: boolean;\n\n}\n\n@injectable()\nexport class NotebookOptionsService {\n\n    @inject(PreferenceService)\n    protected readonly preferenceService: PreferenceService;\n\n    @inject(EditorPreferences)\n    protected readonly editorPreferences: EditorPreferences;\n\n    protected outputOptionsChangedEmitter = new Emitter<NotebookOutputOptions>();\n    onDidChangeOutputOptions = this.outputOptionsChangedEmitter.event;\n\n    protected fontInfo?: BareFontInfo;\n    get editorFontInfo(): BareFontInfo {\n        return this.getOrCreateMonacoFontInfo();\n    }\n\n    @postConstruct()\n    protected init(): void {\n        this.preferenceService.onPreferencesChanged(async preferenceChanges => {\n            if (notebookOutputOptionsRelevantPreferences.some(p => p in preferenceChanges)) {\n                this.outputOptionsChangedEmitter.fire(this.computeOutputOptions());\n            }\n        });\n    }\n\n    computeOutputOptions(): NotebookOutputOptions {\n        const outputLineHeight = this.getNotebookPreferenceWithDefault<number>(NotebookPreferences.OUTPUT_LINE_HEIGHT);\n\n        const fontSize = this.preferenceService.get<number>('editor.fontSize')!;\n        const outputFontSize = this.getNotebookPreferenceWithDefault<number>(NotebookPreferences.OUTPUT_FONT_SIZE);\n\n        return {\n            fontSize,\n            outputFontSize: outputFontSize,\n            fontFamily: this.preferenceService.get<string>('editor.fontFamily')!,\n            outputFontFamily: this.getNotebookPreferenceWithDefault<string>(NotebookPreferences.OUTPUT_FONT_FAMILY),\n            outputLineHeight: this.computeOutputLineHeight(outputLineHeight, outputFontSize ?? fontSize),\n            outputScrolling: this.getNotebookPreferenceWithDefault<boolean>(NotebookPreferences.OUTPUT_SCROLLING)!,\n            outputWordWrap: this.getNotebookPreferenceWithDefault<boolean>(NotebookPreferences.OUTPUT_WORD_WRAP)!,\n            outputLineLimit: this.getNotebookPreferenceWithDefault<number>(NotebookPreferences.OUTPUT_LINE_LIMIT)!\n        };\n    }\n\n    protected getNotebookPreferenceWithDefault<T>(key: string): T {\n        return this.preferenceService.get<T>(key, notebookPreferenceSchema.properties?.[key]?.default as T);\n    }\n\n    protected computeOutputLineHeight(lineHeight: number, outputFontSize: number): number {\n        const minimumLineHeight = 9;\n\n        if (lineHeight === 0) {\n            // use editor line height\n            lineHeight = this.editorFontInfo.lineHeight;\n        } else if (lineHeight < minimumLineHeight) {\n            // Values too small to be line heights in pixels are in ems.\n            let fontSize = outputFontSize;\n            if (fontSize === 0) {\n                fontSize = this.preferenceService.get<number>('editor.fontSize')!;\n            }\n\n            lineHeight = lineHeight * fontSize;\n        }\n\n        // Enforce integer, minimum constraints\n        lineHeight = Math.round(lineHeight);\n        if (lineHeight < minimumLineHeight) {\n            lineHeight = minimumLineHeight;\n        }\n\n        return lineHeight;\n    }\n\n    protected getOrCreateMonacoFontInfo(): BareFontInfo {\n        if (!this.fontInfo) {\n            this.fontInfo = this.createFontInfo();\n            this.editorPreferences.onPreferenceChanged(e => this.fontInfo = this.createFontInfo());\n        }\n        return this.fontInfo;\n    }\n\n    protected createFontInfo(): BareFontInfo {\n        return BareFontInfo.createFromRawSettings({\n            fontFamily: this.editorPreferences['editor.fontFamily'],\n            fontWeight: String(this.editorPreferences['editor.fontWeight']),\n            fontSize: this.editorPreferences['editor.fontSize'],\n            fontLigatures: this.editorPreferences['editor.fontLigatures'],\n            lineHeight: this.editorPreferences['editor.lineHeight'],\n            letterSpacing: this.editorPreferences['editor.letterSpacing'],\n        }, PixelRatio.value);\n    }\n\n}\n","// *****************************************************************************\n// Copyright (C) 2023 TypeFox and others.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\n/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { Emitter } from '@theia/core';\nimport { inject, injectable } from '@theia/core/shared/inversify';\nimport { Disposable } from '@theia/core/shared/vscode-languageserver-protocol';\nimport { NotebookEditorWidgetService } from './notebook-editor-widget-service';\n\ninterface RendererMessage {\n    editorId: string;\n    rendererId: string;\n    message: unknown\n};\n\nexport interface RendererMessaging extends Disposable {\n    /**\n     * Method called when a message is received. Should return a boolean\n     * indicating whether a renderer received it.\n     */\n    receiveMessage?: (rendererId: string, message: unknown) => Promise<boolean>;\n\n    /**\n     * Sends a message to an extension from a renderer.\n     */\n    postMessage(rendererId: string, message: unknown): void;\n}\n\n@injectable()\nexport class NotebookRendererMessagingService implements Disposable {\n\n    protected readonly postMessageEmitter = new Emitter<RendererMessage>();\n    readonly onPostMessage = this.postMessageEmitter.event;\n\n    protected readonly willActivateRendererEmitter = new Emitter<string>();\n    readonly onWillActivateRenderer = this.willActivateRendererEmitter.event;\n\n    @inject(NotebookEditorWidgetService)\n    protected readonly editorWidgetService: NotebookEditorWidgetService;\n\n    protected readonly activations = new Map<string /* rendererId */, undefined | RendererMessage[]>();\n    protected readonly scopedMessaging = new Map<string /* editorId */, RendererMessaging>();\n\n    receiveMessage(editorId: string | undefined, rendererId: string, message: unknown): Promise<boolean> {\n        if (editorId === undefined) {\n            const sends = [...this.scopedMessaging.values()].map(e => e.receiveMessage?.(rendererId, message));\n            return Promise.all(sends).then(values => values.some(value => !!value));\n        }\n\n        return this.scopedMessaging.get(editorId)?.receiveMessage?.(rendererId, message) ?? Promise.resolve(false);\n    }\n\n    prepare(rendererId: string): void {\n        if (this.activations.has(rendererId)) {\n            return;\n        }\n\n        const queue: RendererMessage[] = [];\n        this.activations.set(rendererId, queue);\n\n        Promise.all(this.willActivateRendererEmitter.fire(rendererId)).then(() => {\n            for (const message of queue) {\n                this.postMessageEmitter.fire(message);\n            }\n            this.activations.set(rendererId, undefined);\n        });\n    }\n\n    public getScoped(editorId: string): RendererMessaging {\n        const existing = this.scopedMessaging.get(editorId);\n        if (existing) {\n            return existing;\n        }\n\n        const messaging: RendererMessaging = {\n            postMessage: (rendererId, message) => this.postMessage(editorId, rendererId, message),\n            receiveMessage: async (rendererId, message) => {\n                this.editorWidgetService.getNotebookEditor(editorId)?.postRendererMessage(rendererId, message);\n                return true;\n            },\n            dispose: () => this.scopedMessaging.delete(editorId),\n        };\n\n        this.scopedMessaging.set(editorId, messaging);\n        return messaging;\n    }\n\n    protected postMessage(editorId: string, rendererId: string, message: unknown): void {\n        if (!this.activations.has(rendererId)) {\n            this.prepare(rendererId);\n        }\n\n        const activation = this.activations.get(rendererId);\n        const toSend = { rendererId, editorId, message };\n        if (activation === undefined) {\n            this.postMessageEmitter.fire(toSend);\n        } else {\n            activation.push(toSend);\n        }\n    }\n\n    dispose(): void {\n        this.postMessageEmitter.dispose();\n    }\n}\n","// *****************************************************************************\n// Copyright (C) 2023 TypeFox and others.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\n\nimport { Disposable, DisposableCollection, Emitter, Resource, URI } from '@theia/core';\nimport { inject, injectable } from '@theia/core/shared/inversify';\nimport { BinaryBuffer } from '@theia/core/lib/common/buffer';\nimport { NotebookData, TransientOptions } from '../../common';\nimport { NotebookModel, NotebookModelFactory, NotebookModelProps } from '../view-model/notebook-model';\nimport { FileService } from '@theia/filesystem/lib/browser/file-service';\nimport { NotebookCellModel, NotebookCellModelFactory, NotebookCellModelProps } from '../view-model/notebook-cell-model';\nimport { Deferred } from '@theia/core/lib/common/promise-util';\nimport { NotebookMonacoTextModelService } from './notebook-monaco-text-model-service';\nimport { CellEditOperation } from '../notebook-types';\n\nexport const NotebookProvider = Symbol('notebook provider');\n\nexport interface NotebookProviderInfo {\n    readonly notebookType: string,\n    readonly serializer: NotebookSerializer,\n}\n\nexport interface NotebookSerializer {\n    options: TransientOptions;\n    toNotebook(data: BinaryBuffer): Promise<NotebookData>;\n    fromNotebook(data: NotebookData): Promise<BinaryBuffer>;\n}\n\nexport interface NotebookWorkspaceEdit {\n    edits: {\n        resource: URI;\n        edit: CellEditOperation\n    }[]\n}\n\n@injectable()\nexport class NotebookService implements Disposable {\n\n    @inject(FileService)\n    protected fileService: FileService;\n\n    @inject(NotebookModelFactory)\n    protected notebookModelFactory: (props: NotebookModelProps) => NotebookModel;\n\n    @inject(NotebookCellModelFactory)\n    protected notebookCellModelFactory: (props: NotebookCellModelProps) => NotebookCellModel;\n\n    @inject(NotebookMonacoTextModelService)\n    protected textModelService: NotebookMonacoTextModelService;\n\n    protected willUseNotebookSerializerEmitter = new Emitter<string>();\n    readonly onWillUseNotebookSerializer = this.willUseNotebookSerializerEmitter.event;\n\n    protected readonly disposables = new DisposableCollection();\n\n    protected readonly notebookProviders = new Map<string, NotebookProviderInfo>();\n    protected readonly notebookModels = new Map<string, NotebookModel>();\n\n    protected readonly didRegisterNotebookSerializerEmitter = new Emitter<string>();\n    readonly onDidRegisterNotebookSerializer = this.didRegisterNotebookSerializerEmitter.event;\n\n    protected readonly didRemoveViewTypeEmitter = new Emitter<string>();\n    readonly onDidRemoveViewType = this.didRemoveViewTypeEmitter.event;\n\n    protected readonly willOpenNotebookTypeEmitter = new Emitter<string>();\n    readonly onWillOpenNotebook = this.willOpenNotebookTypeEmitter.event;\n\n    protected readonly didAddNotebookDocumentEmitter = new Emitter<NotebookModel>();\n    readonly onDidAddNotebookDocument = this.didAddNotebookDocumentEmitter.event;\n    protected readonly didRemoveNotebookDocumentEmitter = new Emitter<NotebookModel>();\n    readonly onDidRemoveNotebookDocument = this.didRemoveNotebookDocumentEmitter.event;\n\n    dispose(): void {\n        this.disposables.dispose();\n    }\n\n    protected readonly ready = new Deferred();\n\n    /**\n     * Marks the notebook service as ready. From this point on, the service will start dispatching the `onNotebookSerializer` event.\n     */\n    markReady(): void {\n        this.ready.resolve();\n    }\n\n    registerNotebookSerializer(viewType: string, serializer: NotebookSerializer): Disposable {\n        if (this.notebookProviders.has(viewType)) {\n            throw new Error(`notebook provider for viewtype '${viewType}' already exists`);\n        }\n\n        this.notebookProviders.set(viewType, { notebookType: viewType, serializer });\n        this.didRegisterNotebookSerializerEmitter.fire(viewType);\n\n        return Disposable.create(() => {\n            this.notebookProviders.delete(viewType);\n            this.didRemoveViewTypeEmitter.fire(viewType);\n        });\n    }\n\n    async createNotebookModel(data: NotebookData, viewType: string, resource: Resource): Promise<NotebookModel> {\n        const dataProvider = await this.getNotebookDataProvider(viewType);\n        const serializer = dataProvider.serializer;\n        const model = this.notebookModelFactory({ data, resource, viewType, serializer });\n        this.notebookModels.set(resource.uri.toString(), model);\n        // Resolve cell text models right after creating the notebook model\n        // This ensures that all text models are available in the plugin host\n        await this.textModelService.createTextModelsForNotebook(model);\n        this.didAddNotebookDocumentEmitter.fire(model);\n        model.onDidDispose(() => {\n            this.notebookModels.delete(resource.uri.toString());\n            this.didRemoveNotebookDocumentEmitter.fire(model);\n        });\n        return model;\n    }\n\n    async getNotebookDataProvider(viewType: string): Promise<NotebookProviderInfo> {\n        try {\n            return await this.waitForNotebookProvider(viewType);\n        } catch {\n            throw new Error(`No provider registered for view type: '${viewType}'`);\n        }\n    }\n\n    /**\n     * When the application starts up, notebook providers from plugins are not registered yet.\n     * It takes a few seconds for the plugin host to start so that notebook data providers can be registered.\n     * This methods waits until the notebook provider is registered.\n     */\n    protected waitForNotebookProvider(type: string): Promise<NotebookProviderInfo> {\n        const existing = this.notebookProviders.get(type);\n        if (existing) {\n            return Promise.resolve(existing);\n        }\n        const deferred = new Deferred<NotebookProviderInfo>();\n        // 20 seconds of timeout\n        const timeoutDuration = 20_000;\n\n        // Must declare these variables where they can be captured by the closure\n        let disposable: Disposable;\n        // eslint-disable-next-line\n        let timeout: ReturnType<typeof setTimeout>;\n\n        // eslint-disable-next-line\n        disposable = this.onDidRegisterNotebookSerializer(viewType => {\n            if (viewType === type) {\n                clearTimeout(timeout);\n                disposable.dispose();\n                const newProvider = this.notebookProviders.get(type);\n                if (!newProvider) {\n                    deferred.reject(new Error(`Notebook provider for type ${type} is invalid`));\n                } else {\n                    deferred.resolve(newProvider);\n                }\n            }\n        });\n        timeout = setTimeout(() => {\n            clearTimeout(timeout);\n            disposable.dispose();\n            deferred.reject(new Error(`Timed out while waiting for notebook serializer for type ${type} to be registered`));\n        }, timeoutDuration);\n\n        this.ready.promise.then(() => {\n            this.willUseNotebookSerializerEmitter.fire(type);\n        });\n\n        return deferred.promise;\n    }\n\n    getNotebookEditorModel(uri: URI): NotebookModel | undefined {\n        return this.notebookModels.get(uri.toString());\n    }\n\n    getNotebookModels(): Iterable<NotebookModel> {\n        return this.notebookModels.values();\n    }\n\n    async willOpenNotebook(type: string): Promise<void> {\n        return this.willOpenNotebookTypeEmitter.sequence(async listener => listener(type));\n    }\n\n    listNotebookDocuments(): NotebookModel[] {\n        return [...this.notebookModels.values()];\n    }\n\n    applyWorkspaceEdit(workspaceEdit: NotebookWorkspaceEdit): boolean {\n        try {\n            workspaceEdit.edits.forEach(edit => {\n                const notebook = this.getNotebookEditorModel(edit.resource);\n                notebook?.applyEdits([edit.edit], true);\n            });\n            return true;\n        } catch (e) {\n            console.error(e);\n            return false;\n        }\n    }\n}\n","// *****************************************************************************\n// Copyright (C) 2023 TypeFox and others.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\n/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { Disposable, DisposableCollection, Emitter, Event, URI } from '@theia/core';\nimport { inject, injectable, interfaces, postConstruct } from '@theia/core/shared/inversify';\nimport { MonacoEditorModel } from '@theia/monaco/lib/browser/monaco-editor-model';\nimport { type MonacoEditor } from '@theia/monaco/lib/browser/monaco-editor';\nimport {\n    CellKind, NotebookCellCollapseState, NotebookCellInternalMetadata,\n    NotebookCellMetadata, CellOutput, CellData, CellOutputItem\n} from '../../common';\nimport { NotebookCellOutputsSplice } from '../notebook-types';\nimport { NotebookMonacoTextModelService } from '../service/notebook-monaco-text-model-service';\nimport { NotebookCellOutputModel } from './notebook-cell-output-model';\nimport { PreferenceService } from '@theia/core/lib/browser';\nimport { NotebookPreferences } from '../contributions/notebook-preferences';\nimport { LanguageService } from '@theia/core/lib/browser/language-service';\n\nexport const NotebookCellModelFactory = Symbol('NotebookModelFactory');\nexport type NotebookCellModelFactory = (props: NotebookCellModelProps) => NotebookCellModel;\n\nexport type CellEditorFocusRequest = number | 'lastLine' | undefined;\n\nexport function createNotebookCellModelContainer(parent: interfaces.Container, props: NotebookCellModelProps): interfaces.Container {\n    const child = parent.createChild();\n\n    child.bind(NotebookCellModelProps).toConstantValue(props);\n    child.bind(NotebookCellModel).toSelf();\n\n    return child;\n}\n\nexport interface CellInternalMetadataChangedEvent {\n    readonly lastRunSuccessChanged?: boolean;\n}\n\nexport interface NotebookCell {\n    readonly uri: URI;\n    handle: number;\n    language: string;\n    cellKind: CellKind;\n    outputs: CellOutput[];\n    metadata: NotebookCellMetadata;\n    internalMetadata: NotebookCellInternalMetadata;\n    text: string;\n    onDidChangeOutputs?: Event<NotebookCellOutputsSplice>;\n    onDidChangeOutputItems?: Event<CellOutput>;\n    onDidChangeLanguage: Event<string>;\n    onDidChangeMetadata: Event<void>;\n    onDidChangeInternalMetadata: Event<CellInternalMetadataChangedEvent>;\n\n}\n\nconst NotebookCellModelProps = Symbol('NotebookModelProps');\nexport interface NotebookCellModelProps {\n    readonly uri: URI,\n    readonly handle: number,\n    source: string,\n    language: string,\n    readonly cellKind: CellKind,\n    outputs: CellOutput[],\n    metadata?: NotebookCellMetadata | undefined,\n    internalMetadata?: NotebookCellInternalMetadata | undefined,\n    readonly collapseState?: NotebookCellCollapseState | undefined,\n\n}\n\n@injectable()\nexport class NotebookCellModel implements NotebookCell, Disposable {\n\n    protected readonly onDidChangeOutputsEmitter = new Emitter<NotebookCellOutputsSplice>();\n    readonly onDidChangeOutputs: Event<NotebookCellOutputsSplice> = this.onDidChangeOutputsEmitter.event;\n\n    protected readonly onDidChangeOutputItemsEmitter = new Emitter<CellOutput>();\n    readonly onDidChangeOutputItems: Event<CellOutput> = this.onDidChangeOutputItemsEmitter.event;\n\n    protected readonly onDidChangeContentEmitter = new Emitter<'content' | 'language' | 'mime'>();\n    readonly onDidChangeContent: Event<'content' | 'language' | 'mime'> = this.onDidChangeContentEmitter.event;\n\n    protected readonly onDidChangeMetadataEmitter = new Emitter<void>();\n    readonly onDidChangeMetadata: Event<void> = this.onDidChangeMetadataEmitter.event;\n\n    protected readonly onDidChangeInternalMetadataEmitter = new Emitter<CellInternalMetadataChangedEvent>();\n    readonly onDidChangeInternalMetadata: Event<CellInternalMetadataChangedEvent> = this.onDidChangeInternalMetadataEmitter.event;\n\n    protected readonly onDidChangeLanguageEmitter = new Emitter<string>();\n    readonly onDidChangeLanguage: Event<string> = this.onDidChangeLanguageEmitter.event;\n\n    protected readonly onDidRequestCellEditChangeEmitter = new Emitter<boolean>();\n    readonly onDidRequestCellEditChange = this.onDidRequestCellEditChangeEmitter.event;\n\n    protected readonly onWillFocusCellEditorEmitter = new Emitter<CellEditorFocusRequest>();\n    readonly onWillFocusCellEditor = this.onWillFocusCellEditorEmitter.event;\n\n    protected readonly onWillBlurCellEditorEmitter = new Emitter<void>();\n    readonly onWillBlurCellEditor = this.onWillBlurCellEditorEmitter.event;\n\n    protected readonly onDidChangeEditorOptionsEmitter = new Emitter<MonacoEditor.IOptions>();\n    readonly onDidChangeEditorOptions: Event<MonacoEditor.IOptions> = this.onDidChangeEditorOptionsEmitter.event;\n\n    protected readonly outputVisibilityChangeEmitter = new Emitter<boolean>();\n    readonly onDidChangeOutputVisibility: Event<boolean> = this.outputVisibilityChangeEmitter.event;\n\n    @inject(NotebookCellModelProps)\n    protected readonly props: NotebookCellModelProps;\n\n    @inject(NotebookMonacoTextModelService)\n    protected readonly textModelService: NotebookMonacoTextModelService;\n\n    @inject(LanguageService)\n    protected readonly languageService: LanguageService;\n\n    @inject(PreferenceService)\n    protected readonly preferenceService: PreferenceService;\n\n    get outputs(): NotebookCellOutputModel[] {\n        return this._outputs;\n    }\n\n    protected _outputs: NotebookCellOutputModel[];\n\n    get metadata(): NotebookCellMetadata {\n        return this._metadata;\n    }\n\n    set metadata(newMetadata: NotebookCellMetadata) {\n        this._metadata = newMetadata;\n        this.onDidChangeMetadataEmitter.fire();\n    }\n\n    protected _metadata: NotebookCellMetadata;\n\n    protected toDispose = new DisposableCollection();\n\n    protected _internalMetadata: NotebookCellInternalMetadata;\n\n    get internalMetadata(): NotebookCellInternalMetadata {\n        return this._internalMetadata;\n    }\n\n    set internalMetadata(newInternalMetadata: NotebookCellInternalMetadata) {\n        const lastRunSuccessChanged = this._internalMetadata.lastRunSuccess !== newInternalMetadata.lastRunSuccess;\n        newInternalMetadata = {\n            ...newInternalMetadata,\n            ...{ runStartTimeAdjustment: computeRunStartTimeAdjustment(this._internalMetadata, newInternalMetadata) }\n        };\n        this._internalMetadata = newInternalMetadata;\n        this.onDidChangeInternalMetadataEmitter.fire({ lastRunSuccessChanged });\n\n    }\n\n    protected textModel?: MonacoEditorModel;\n\n    get text(): string {\n        return this.textModel && !this.textModel.isDisposed() ? this.textModel.getText() : this.source;\n    }\n\n    get source(): string {\n        return this.props.source;\n    }\n    set source(source: string) {\n        this.props.source = source;\n        this.textModel?.textEditorModel.setValue(source);\n    }\n    get language(): string {\n        return this.props.language;\n    }\n\n    set language(newLanguage: string) {\n        if (this.language === newLanguage) {\n            return;\n        }\n\n        if (this.textModel) {\n            this.textModel.setLanguageId(newLanguage);\n        }\n\n        this.props.language = newLanguage;\n        this.onDidChangeLanguageEmitter.fire(newLanguage);\n        this.onDidChangeContentEmitter.fire('language');\n    }\n\n    get languageName(): string {\n        return this.languageService.getLanguage(this.language)?.name ?? this.language;\n    }\n\n    get uri(): URI {\n        return this.props.uri;\n    }\n    get handle(): number {\n        return this.props.handle;\n    }\n    get cellKind(): CellKind {\n        return this.props.cellKind;\n    }\n\n    protected _editing: boolean = false;\n    get editing(): boolean {\n        return this._editing;\n    }\n\n    protected _editorOptions: MonacoEditor.IOptions = {};\n    get editorOptions(): Readonly<MonacoEditor.IOptions> {\n        return this._editorOptions;\n    }\n\n    set editorOptions(options: MonacoEditor.IOptions) {\n        this._editorOptions = options;\n        this.onDidChangeEditorOptionsEmitter.fire(options);\n    }\n\n    protected _outputVisible: boolean = true;\n    get outputVisible(): boolean {\n        return this._outputVisible;\n    }\n\n    set outputVisible(visible: boolean) {\n        if (this._outputVisible !== visible) {\n            this._outputVisible = visible;\n            this.outputVisibilityChangeEmitter.fire(visible);\n        }\n    }\n\n    @postConstruct()\n    protected init(): void {\n        this._outputs = this.props.outputs.map(op => new NotebookCellOutputModel(op));\n        this._metadata = this.props.metadata ?? {};\n        this._internalMetadata = this.props.internalMetadata ?? {};\n\n        this.editorOptions = {\n            lineNumbers: this.preferenceService.get(NotebookPreferences.NOTEBOOK_LINE_NUMBERS)\n        };\n        this.toDispose.push(this.preferenceService.onPreferenceChanged(e => {\n            if (e.preferenceName === NotebookPreferences.NOTEBOOK_LINE_NUMBERS) {\n                this.editorOptions = {\n                    ...this.editorOptions,\n                    lineNumbers: this.preferenceService.get(NotebookPreferences.NOTEBOOK_LINE_NUMBERS)\n                };\n            }\n        }));\n    }\n\n    dispose(): void {\n        this.onDidChangeOutputsEmitter.dispose();\n        this.onDidChangeOutputItemsEmitter.dispose();\n        this.onDidChangeContentEmitter.dispose();\n        this.onDidChangeMetadataEmitter.dispose();\n        this.onDidChangeInternalMetadataEmitter.dispose();\n        this.onDidChangeLanguageEmitter.dispose();\n        this.toDispose.dispose();\n    }\n\n    requestEdit(): void {\n        if (!this.textModel || !this.textModel.readOnly) {\n            this._editing = true;\n            this.onDidRequestCellEditChangeEmitter.fire(true);\n        }\n    }\n\n    requestStopEdit(): void {\n        this._editing = false;\n        this.onDidRequestCellEditChangeEmitter.fire(false);\n    }\n\n    requestFocusEditor(focusRequest?: CellEditorFocusRequest): void {\n        this.requestEdit();\n        this.onWillFocusCellEditorEmitter.fire(focusRequest);\n    }\n\n    requestBlurEditor(): void {\n        this.requestStopEdit();\n        this.onWillBlurCellEditorEmitter.fire();\n    }\n\n    spliceNotebookCellOutputs(splice: NotebookCellOutputsSplice): void {\n        if (splice.deleteCount > 0 && splice.newOutputs.length > 0) {\n            const commonLen = Math.min(splice.deleteCount, splice.newOutputs.length);\n            // update\n            for (let i = 0; i < commonLen; i++) {\n                const currentOutput = this.outputs[splice.start + i];\n                const newOutput = splice.newOutputs[i];\n\n                this.replaceOutputData(currentOutput.outputId, newOutput);\n            }\n\n            this.outputs.splice(splice.start + commonLen, splice.deleteCount - commonLen, ...splice.newOutputs.slice(commonLen).map(op => new NotebookCellOutputModel(op)));\n            this.onDidChangeOutputsEmitter.fire({ start: splice.start + commonLen, deleteCount: splice.deleteCount - commonLen, newOutputs: splice.newOutputs.slice(commonLen) });\n        } else {\n            this.outputs.splice(splice.start, splice.deleteCount, ...splice.newOutputs.map(op => new NotebookCellOutputModel(op)));\n            this.onDidChangeOutputsEmitter.fire(splice);\n        }\n    }\n\n    replaceOutputData(outputId: string, newOutputData: CellOutput): boolean {\n        const output = this.outputs.find(out => out.outputId === outputId);\n\n        if (!output) {\n            return false;\n        }\n\n        output.replaceData(newOutputData);\n        this.onDidChangeOutputItemsEmitter.fire(output);\n        return true;\n    }\n\n    changeOutputItems(outputId: string, append: boolean, items: CellOutputItem[]): boolean {\n        const output = this.outputs.find(out => out.outputId === outputId);\n\n        if (!output) {\n            return false;\n        }\n\n        if (append) {\n            output.appendData(items);\n        } else {\n            output.replaceData({ outputId: outputId, outputs: items, metadata: output.metadata });\n        }\n        this.onDidChangeOutputItemsEmitter.fire(output);\n        return true;\n    }\n\n    getData(): CellData {\n        return {\n            cellKind: this.cellKind,\n            language: this.language,\n            outputs: this.outputs.map(output => output.getData()),\n            source: this.text,\n            collapseState: this.props.collapseState,\n            internalMetadata: this.internalMetadata,\n            metadata: this.metadata\n        };\n    }\n\n    async resolveTextModel(): Promise<MonacoEditorModel> {\n        if (this.textModel) {\n            return this.textModel;\n        }\n\n        const ref = await this.textModelService.getOrCreateNotebookCellModelReference(this.uri);\n        this.textModel = ref.object;\n        this.toDispose.push(ref);\n        this.toDispose.push(this.textModel.onDidChangeContent(e => {\n            this.props.source = e.model.getText();\n        }));\n        return ref.object;\n    }\n\n    restartOutputRenderer(outputId: string): void {\n        const output = this.outputs.find(out => out.outputId === outputId);\n        if (output) {\n            this.onDidChangeOutputItemsEmitter.fire(output);\n        }\n    }\n}\n\nfunction computeRunStartTimeAdjustment(oldMetadata: NotebookCellInternalMetadata, newMetadata: NotebookCellInternalMetadata): number | undefined {\n    if (oldMetadata.runStartTime !== newMetadata.runStartTime && typeof newMetadata.runStartTime === 'number') {\n        const offset = Date.now() - newMetadata.runStartTime;\n        return offset < 0 ? Math.abs(offset) : 0;\n    } else {\n        return newMetadata.runStartTimeAdjustment;\n    }\n}\n","// *****************************************************************************\n// Copyright (C) 2023 TypeFox and others.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\n\nimport { Disposable, Emitter } from '@theia/core';\nimport { CellOutput, CellOutputItem, isTextStreamMime } from '../../common';\nimport { compressOutputItemStreams } from '../notebook-output-utils';\n\nexport class NotebookCellOutputModel implements Disposable {\n\n    private didChangeDataEmitter = new Emitter<void>();\n    readonly onDidChangeData = this.didChangeDataEmitter.event;\n\n    private requestOutputPresentationChangeEmitter = new Emitter<void>();\n    readonly onRequestOutputPresentationChange = this.requestOutputPresentationChangeEmitter.event;\n\n    get outputId(): string {\n        return this.rawOutput.outputId;\n    }\n\n    get outputs(): CellOutputItem[] {\n        return this.rawOutput.outputs || [];\n    }\n\n    get metadata(): Record<string, unknown> | undefined {\n        return this.rawOutput.metadata;\n    }\n\n    constructor(protected rawOutput: CellOutput) { }\n\n    replaceData(rawData: CellOutput): void {\n        this.rawOutput = rawData;\n        this.optimizeOutputItems();\n        this.didChangeDataEmitter.fire();\n    }\n\n    appendData(items: CellOutputItem[]): void {\n        this.rawOutput.outputs.push(...items);\n        this.optimizeOutputItems();\n        this.didChangeDataEmitter.fire();\n    }\n\n    dispose(): void {\n        this.didChangeDataEmitter.dispose();\n        this.requestOutputPresentationChangeEmitter.dispose();\n    }\n\n    requestOutputPresentationUpdate(): void {\n        this.requestOutputPresentationChangeEmitter.fire();\n    }\n\n    getData(): CellOutput {\n        return {\n            outputs: this.outputs,\n            metadata: this.metadata,\n            outputId: this.outputId\n        };\n    }\n\n    private optimizeOutputItems(): void {\n        if (this.outputs.length > 1 && this.outputs.every(item => isTextStreamMime(item.mime))) {\n            // Look for the mimes in the items, and keep track of their order.\n            // Merge the streams into one output item, per mime type.\n            const mimeOutputs = new Map<string, Uint8Array[]>();\n            const mimeTypes: string[] = [];\n            this.outputs.forEach(item => {\n                let items: Uint8Array[];\n                if (mimeOutputs.has(item.mime)) {\n                    items = mimeOutputs.get(item.mime)!;\n                } else {\n                    items = [];\n                    mimeOutputs.set(item.mime, items);\n                    mimeTypes.push(item.mime);\n                }\n                items.push(item.data.buffer);\n            });\n            this.outputs.length = 0;\n            mimeTypes.forEach(mime => {\n                const compressionResult = compressOutputItemStreams(mimeOutputs.get(mime)!);\n                this.outputs.push({\n                    mime,\n                    data: compressionResult.data\n                });\n            });\n        }\n    }\n\n}\n","// *****************************************************************************\n// Copyright (C) 2023 Typefox and others.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\n\nimport { Disposable, Emitter, Event, QueueableEmitter, Resource, URI } from '@theia/core';\nimport { Saveable, SaveOptions } from '@theia/core/lib/browser';\nimport {\n    CellData, CellEditType, CellUri, NotebookCellInternalMetadata,\n    NotebookCellMetadata,\n    NotebookCellsChangeType, NotebookCellTextModelSplice, NotebookData,\n    NotebookDocumentMetadata,\n} from '../../common';\nimport {\n    NotebookContentChangedEvent, NotebookModelWillAddRemoveEvent,\n    CellEditOperation, NullablePartialNotebookCellInternalMetadata,\n    NullablePartialNotebookCellMetadata\n} from '../notebook-types';\nimport { NotebookSerializer } from '../service/notebook-service';\nimport { FileService } from '@theia/filesystem/lib/browser/file-service';\nimport { NotebookCellModel, NotebookCellModelFactory } from './notebook-cell-model';\nimport { inject, injectable, interfaces, postConstruct } from '@theia/core/shared/inversify';\nimport { UndoRedoService } from '@theia/editor/lib/browser/undo-redo-service';\nimport { MarkdownString } from '@theia/core/lib/common/markdown-rendering';\nimport type { NotebookModelResolverService } from '../service/notebook-model-resolver-service';\nimport { BinaryBuffer } from '@theia/core/lib/common/buffer';\n\nexport const NotebookModelFactory = Symbol('NotebookModelFactory');\n\nexport function createNotebookModelContainer(parent: interfaces.Container, props: NotebookModelProps): interfaces.Container {\n    const child = parent.createChild();\n\n    child.bind(NotebookModelProps).toConstantValue(props);\n    child.bind(NotebookModel).toSelf();\n\n    return child;\n}\n\nexport const NotebookModelResolverServiceProxy = Symbol('NotebookModelResolverServiceProxy');\n\nconst NotebookModelProps = Symbol('NotebookModelProps');\nexport interface NotebookModelProps {\n    data: NotebookData;\n    resource: Resource;\n    viewType: string;\n    serializer: NotebookSerializer;\n}\n\nexport interface SelectedCellChangeEvent {\n    cell: NotebookCellModel | undefined;\n    scrollIntoView: boolean;\n}\n\n@injectable()\nexport class NotebookModel implements Saveable, Disposable {\n\n    protected readonly onDirtyChangedEmitter = new Emitter<void>();\n    readonly onDirtyChanged = this.onDirtyChangedEmitter.event;\n\n    protected readonly onDidSaveNotebookEmitter = new Emitter<void>();\n    readonly onDidSaveNotebook = this.onDidSaveNotebookEmitter.event;\n\n    protected readonly onDidAddOrRemoveCellEmitter = new Emitter<NotebookModelWillAddRemoveEvent>();\n    readonly onDidAddOrRemoveCell = this.onDidAddOrRemoveCellEmitter.event;\n\n    protected readonly onDidChangeContentEmitter = new QueueableEmitter<NotebookContentChangedEvent>();\n    readonly onDidChangeContent = this.onDidChangeContentEmitter.event;\n\n    protected readonly onContentChangedEmitter = new Emitter<void>();\n    readonly onContentChanged = this.onContentChangedEmitter.event;\n\n    protected readonly onDidChangeSelectedCellEmitter = new Emitter<SelectedCellChangeEvent>();\n    readonly onDidChangeSelectedCell = this.onDidChangeSelectedCellEmitter.event;\n\n    protected readonly onDidDisposeEmitter = new Emitter<void>();\n    readonly onDidDispose = this.onDidDisposeEmitter.event;\n\n    get onDidChangeReadOnly(): Event<boolean | MarkdownString> {\n        return this.props.resource.onDidChangeReadOnly ?? Event.None;\n    }\n\n    @inject(FileService)\n    protected readonly fileService: FileService;\n\n    @inject(UndoRedoService)\n    protected readonly undoRedoService: UndoRedoService;\n\n    @inject(NotebookModelProps)\n    protected props: NotebookModelProps;\n\n    @inject(NotebookCellModelFactory)\n    protected cellModelFactory: NotebookCellModelFactory;\n\n    @inject(NotebookModelResolverServiceProxy)\n    protected modelResolverService: NotebookModelResolverService;\n\n    protected nextHandle: number = 0;\n\n    protected _dirty = false;\n\n    set dirty(dirty: boolean) {\n        const oldState = this._dirty;\n        this._dirty = dirty;\n        if (oldState !== dirty) {\n            this.onDirtyChangedEmitter.fire();\n        }\n    }\n\n    get dirty(): boolean {\n        return this._dirty;\n    }\n\n    get readOnly(): boolean | MarkdownString {\n        return this.props.resource.readOnly ?? false;\n    }\n\n    selectedCell?: NotebookCellModel;\n    protected dirtyCells: NotebookCellModel[] = [];\n\n    cells: NotebookCellModel[];\n\n    get uri(): URI {\n        return this.props.resource.uri;\n    }\n\n    get viewType(): string {\n        return this.props.viewType;\n    }\n\n    metadata: NotebookDocumentMetadata = {};\n\n    @postConstruct()\n    initialize(): void {\n        this.dirty = false;\n\n        this.cells = this.props.data.cells.map((cell, index) => this.cellModelFactory({\n            uri: CellUri.generate(this.props.resource.uri, index),\n            handle: index,\n            source: cell.source,\n            language: cell.language,\n            cellKind: cell.cellKind,\n            outputs: cell.outputs,\n            metadata: cell.metadata,\n            internalMetadata: cell.internalMetadata,\n            collapseState: cell.collapseState\n        }));\n\n        this.addCellOutputListeners(this.cells);\n\n        this.metadata = this.props.data.metadata;\n\n        this.nextHandle = this.cells.length;\n    }\n\n    dispose(): void {\n        this.onDirtyChangedEmitter.dispose();\n        this.onDidSaveNotebookEmitter.dispose();\n        this.onDidAddOrRemoveCellEmitter.dispose();\n        this.onDidChangeContentEmitter.dispose();\n        this.onDidChangeSelectedCellEmitter.dispose();\n        this.cells.forEach(cell => cell.dispose());\n        this.onDidDisposeEmitter.fire();\n    }\n\n    async save(options?: SaveOptions): Promise<void> {\n        this.dirtyCells = [];\n        this.dirty = false;\n\n        const serializedNotebook = await this.serialize();\n        this.fileService.writeFile(this.uri, serializedNotebook);\n\n        this.onDidSaveNotebookEmitter.fire();\n    }\n\n    createSnapshot(): Saveable.Snapshot {\n        return {\n            read: () => JSON.stringify(this.getData())\n        };\n    }\n\n    serialize(): Promise<BinaryBuffer> {\n        return this.props.serializer.fromNotebook(this.getData());\n    }\n\n    async applySnapshot(snapshot: Saveable.Snapshot): Promise<void> {\n        const rawData = Saveable.Snapshot.read(snapshot);\n        if (!rawData) {\n            throw new Error('could not read notebook snapshot');\n        }\n        const data = JSON.parse(rawData) as NotebookData;\n        this.setData(data);\n    }\n\n    async revert(options?: Saveable.RevertOptions): Promise<void> {\n        if (!options?.soft) {\n            // Load the data from the file again\n            try {\n                const data = await this.modelResolverService.resolveExistingNotebookData(this.props.resource, this.props.viewType);\n                this.setData(data, false);\n            } catch (err) {\n                console.error('Failed to revert notebook', err);\n            }\n        }\n        this.dirty = false;\n    }\n\n    isDirty(): boolean {\n        return this.dirty;\n    }\n\n    cellDirtyChanged(cell: NotebookCellModel, dirtyState: boolean): void {\n        if (dirtyState) {\n            this.dirtyCells.push(cell);\n        } else {\n            this.dirtyCells.splice(this.dirtyCells.indexOf(cell), 1);\n        }\n\n        this.dirty = this.dirtyCells.length > 0;\n    }\n\n    setData(data: NotebookData, markDirty = true): void {\n        // Replace all cells in the model\n        this.dirtyCells = [];\n        this.replaceCells(0, this.cells.length, data.cells, false);\n        this.metadata = data.metadata;\n        this.dirty = markDirty;\n        this.onDidChangeContentEmitter.fire();\n    }\n\n    getData(): NotebookData {\n        return {\n            cells: this.cells.map(cell => cell.getData()),\n            metadata: this.metadata\n        };\n    }\n\n    undo(): void {\n        // TODO we probably need to check if a monaco editor is focused and if so, not undo\n        this.undoRedoService.undo(this.uri);\n    }\n\n    redo(): void {\n        // TODO see undo\n        this.undoRedoService.redo(this.uri);\n    }\n\n    setSelectedCell(cell: NotebookCellModel, scrollIntoView?: boolean): void {\n        if (this.selectedCell !== cell) {\n            this.selectedCell = cell;\n            this.onDidChangeSelectedCellEmitter.fire({ cell, scrollIntoView: scrollIntoView ?? true });\n        }\n    }\n\n    private addCellOutputListeners(cells: NotebookCellModel[]): void {\n        for (const cell of cells) {\n            cell.onDidChangeOutputs(() => {\n                this.dirty = true;\n            });\n        }\n    }\n\n    applyEdits(rawEdits: CellEditOperation[], computeUndoRedo: boolean): void {\n        const editsWithDetails = rawEdits.map((edit, index) => {\n            let cellIndex: number = -1;\n            if ('index' in edit) {\n                cellIndex = edit.index;\n            } else if ('handle' in edit) {\n                cellIndex = this.getCellIndexByHandle(edit.handle);\n            } else if ('outputId' in edit) {\n                cellIndex = this.cells.findIndex(cell => cell.outputs.some(output => output.outputId === edit.outputId));\n            }\n\n            return {\n                edit,\n                cellIndex,\n                end: edit.editType === CellEditType.Replace ? edit.index + edit.count : cellIndex,\n                originalIndex: index\n            };\n        });\n\n        for (const { edit, cellIndex } of editsWithDetails) {\n            const cell = this.cells[cellIndex];\n            if (cell) {\n                this.cellDirtyChanged(cell, true);\n            }\n\n            let scrollIntoView = true;\n            switch (edit.editType) {\n                case CellEditType.Replace:\n                    this.replaceCells(edit.index, edit.count, edit.cells, computeUndoRedo);\n                    scrollIntoView = edit.cells.length > 0;\n                    break;\n                case CellEditType.Output: {\n                    if (edit.append) {\n                        cell.spliceNotebookCellOutputs({ deleteCount: 0, newOutputs: edit.outputs, start: cell.outputs.length });\n                    } else {\n                        // could definitely be more efficient. See vscode __spliceNotebookCellOutputs2\n                        // For now, just replace the whole existing output with the new output\n                        cell.spliceNotebookCellOutputs({ start: 0, deleteCount: edit.deleteCount ?? cell.outputs.length, newOutputs: edit.outputs });\n                    }\n                    this.onDidChangeContentEmitter.queue({ kind: NotebookCellsChangeType.Output, index: cellIndex, outputs: cell.outputs, append: edit.append ?? false });\n                    break;\n                }\n                case CellEditType.OutputItems:\n                    cell.changeOutputItems(edit.outputId, !!edit.append, edit.items);\n                    this.onDidChangeContentEmitter.queue({\n                        kind: NotebookCellsChangeType.OutputItem, index: cellIndex, outputItems: edit.items,\n                        outputId: edit.outputId, append: edit.append ?? false\n                    });\n\n                    break;\n                case CellEditType.Metadata:\n                    this.changeCellMetadata(this.cells[cellIndex], edit.metadata, computeUndoRedo);\n                    break;\n                case CellEditType.PartialMetadata:\n                    this.changeCellMetadataPartial(this.cells[cellIndex], edit.metadata, computeUndoRedo);\n                    break;\n                case CellEditType.PartialInternalMetadata:\n                    this.changeCellInternalMetadataPartial(this.cells[cellIndex], edit.internalMetadata);\n                    break;\n                case CellEditType.CellLanguage:\n                    this.changeCellLanguage(this.cells[cellIndex], edit.language, computeUndoRedo);\n                    break;\n                case CellEditType.DocumentMetadata:\n                    this.updateNotebookMetadata(edit.metadata, computeUndoRedo);\n                    break;\n                case CellEditType.Move:\n                    this.moveCellToIndex(cellIndex, edit.length, edit.newIdx, computeUndoRedo);\n                    break;\n            }\n\n            // if selected cell is affected update it because it can potentially have been replaced\n            if (cell === this.selectedCell) {\n                this.setSelectedCell(this.cells[Math.min(cellIndex, this.cells.length - 1)], scrollIntoView);\n            }\n        }\n\n        this.onDidChangeContentEmitter.fire();\n        this.onContentChangedEmitter.fire();\n    }\n\n    protected replaceCells(start: number, deleteCount: number, newCells: CellData[], computeUndoRedo: boolean): void {\n        const cells = newCells.map(cell => {\n            const handle = this.nextHandle++;\n            return this.cellModelFactory({\n                uri: CellUri.generate(this.uri, handle),\n                handle: handle,\n                source: cell.source,\n                language: cell.language,\n                cellKind: cell.cellKind,\n                outputs: cell.outputs,\n                metadata: cell.metadata,\n                internalMetadata: cell.internalMetadata,\n                collapseState: cell.collapseState\n            });\n        });\n        this.addCellOutputListeners(cells);\n\n        const changes: NotebookCellTextModelSplice<NotebookCellModel>[] = [{ start, deleteCount, newItems: cells }];\n\n        const deletedCells = this.cells.splice(start, deleteCount, ...cells);\n\n        for (const cell of deletedCells) {\n            cell.dispose();\n        }\n\n        if (computeUndoRedo) {\n            this.undoRedoService.pushElement(this.uri,\n                async () => this.replaceCells(start, newCells.length, deletedCells.map(cell => cell.getData()), false),\n                async () => this.replaceCells(start, deleteCount, newCells, false));\n        }\n\n        this.onDidAddOrRemoveCellEmitter.fire({ rawEvent: { kind: NotebookCellsChangeType.ModelChange, changes }, newCellIds: cells.map(cell => cell.handle) });\n        this.onDidChangeContentEmitter.queue({ kind: NotebookCellsChangeType.ModelChange, changes });\n        if (cells.length > 0) {\n            this.setSelectedCell(cells[cells.length - 1]);\n            cells[cells.length - 1].requestEdit();\n        }\n    }\n\n    protected changeCellInternalMetadataPartial(cell: NotebookCellModel, internalMetadata: NullablePartialNotebookCellInternalMetadata): void {\n        const newInternalMetadata: NotebookCellInternalMetadata = {\n            ...cell.internalMetadata\n        };\n        let k: keyof NotebookCellInternalMetadata;\n        // eslint-disable-next-line guard-for-in\n        for (k in internalMetadata) {\n            newInternalMetadata[k] = (internalMetadata[k] ?? undefined) as never;\n        }\n\n        cell.internalMetadata = newInternalMetadata;\n        this.onDidChangeContentEmitter.queue({ kind: NotebookCellsChangeType.ChangeCellInternalMetadata, index: this.cells.indexOf(cell), internalMetadata: newInternalMetadata });\n    }\n\n    protected updateNotebookMetadata(metadata: NotebookDocumentMetadata, computeUndoRedo: boolean): void {\n        const oldMetadata = this.metadata;\n        if (computeUndoRedo) {\n            this.undoRedoService.pushElement(this.uri,\n                async () => this.updateNotebookMetadata(oldMetadata, false),\n                async () => this.updateNotebookMetadata(metadata, false)\n            );\n        }\n\n        this.metadata = metadata;\n        this.onDidChangeContentEmitter.queue({ kind: NotebookCellsChangeType.ChangeDocumentMetadata, metadata: this.metadata });\n    }\n\n    protected changeCellMetadataPartial(cell: NotebookCellModel, metadata: NullablePartialNotebookCellMetadata, computeUndoRedo: boolean): void {\n        const newMetadata: NotebookCellMetadata = {\n            ...cell.metadata\n        };\n        let k: keyof NullablePartialNotebookCellMetadata;\n        // eslint-disable-next-line guard-for-in\n        for (k in metadata) {\n            const value = metadata[k] ?? undefined;\n            newMetadata[k] = value as unknown;\n        }\n\n        this.changeCellMetadata(cell, newMetadata, computeUndoRedo);\n    }\n\n    protected changeCellMetadata(cell: NotebookCellModel, metadata: NotebookCellMetadata, computeUndoRedo: boolean): void {\n        const triggerDirtyChange = this.isCellMetadataChanged(cell.metadata, metadata);\n\n        if (triggerDirtyChange) {\n            if (computeUndoRedo) {\n                const oldMetadata = cell.metadata;\n                cell.metadata = metadata;\n                this.undoRedoService.pushElement(this.uri,\n                    async () => { cell.metadata = oldMetadata; },\n                    async () => { cell.metadata = metadata; }\n                );\n            }\n        }\n\n        cell.metadata = metadata;\n        this.onDidChangeContentEmitter.queue({ kind: NotebookCellsChangeType.ChangeCellMetadata, index: this.cells.indexOf(cell), metadata: cell.metadata });\n    }\n\n    protected changeCellLanguage(cell: NotebookCellModel, languageId: string, computeUndoRedo: boolean): void {\n        if (cell.language === languageId) {\n            return;\n        }\n\n        cell.language = languageId;\n\n        this.onDidChangeContentEmitter.queue({ kind: NotebookCellsChangeType.ChangeCellLanguage, index: this.cells.indexOf(cell), language: languageId });\n    }\n\n    protected moveCellToIndex(fromIndex: number, length: number, toIndex: number, computeUndoRedo: boolean): boolean {\n        if (computeUndoRedo) {\n            this.undoRedoService.pushElement(this.uri,\n                async () => { this.moveCellToIndex(toIndex, length, fromIndex, false); },\n                async () => { this.moveCellToIndex(fromIndex, length, toIndex, false); }\n            );\n        }\n\n        const cells = this.cells.splice(fromIndex, length);\n        this.cells.splice(toIndex, 0, ...cells);\n        this.onDidChangeContentEmitter.queue({ kind: NotebookCellsChangeType.Move, index: fromIndex, length, newIdx: toIndex, cells });\n\n        return true;\n    }\n\n    protected getCellIndexByHandle(handle: number): number {\n        return this.cells.findIndex(c => c.handle === handle);\n    }\n\n    protected isCellMetadataChanged(a: NotebookCellMetadata, b: NotebookCellMetadata): boolean {\n        const keys = new Set([...Object.keys(a || {}), ...Object.keys(b || {})]);\n        for (const key of keys) {\n            if (\n                (a[key as keyof NotebookCellMetadata] !== b[key as keyof NotebookCellMetadata])\n            ) {\n                return true;\n            }\n        }\n\n        return false;\n    }\n\n}\n","// *****************************************************************************\n// Copyright (C) 2023 TypeFox and others.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\n\nimport * as React from '@theia/core/shared/react';\nimport { NotebookModel } from '../view-model/notebook-model';\nimport { NotebookCellModel } from '../view-model/notebook-cell-model';\nimport { SimpleMonacoEditor } from '@theia/monaco/lib/browser/simple-monaco-editor';\nimport { MonacoEditor, MonacoEditorServices } from '@theia/monaco/lib/browser/monaco-editor';\nimport { MonacoEditorProvider } from '@theia/monaco/lib/browser/monaco-editor-provider';\nimport { IContextKeyService } from '@theia/monaco-editor-core/esm/vs/platform/contextkey/common/contextkey';\nimport { NotebookContextManager } from '../service/notebook-context-manager';\nimport { DisposableCollection, OS } from '@theia/core';\nimport { NotebookViewportService } from './notebook-viewport-service';\nimport { BareFontInfo } from '@theia/monaco-editor-core/esm/vs/editor/common/config/fontInfo';\nimport { NOTEBOOK_CELL_CURSOR_FIRST_LINE, NOTEBOOK_CELL_CURSOR_LAST_LINE } from '../contributions/notebook-context-keys';\nimport { EditorExtensionsRegistry } from '@theia/monaco-editor-core/esm/vs/editor/browser/editorExtensions';\n\ninterface CellEditorProps {\n    notebookModel: NotebookModel,\n    cell: NotebookCellModel,\n    monacoServices: MonacoEditorServices,\n    notebookContextManager: NotebookContextManager;\n    notebookViewportService?: NotebookViewportService,\n    fontInfo?: BareFontInfo;\n}\n\nconst DEFAULT_EDITOR_OPTIONS: MonacoEditor.IOptions = {\n    ...MonacoEditorProvider.inlineOptions,\n    minHeight: -1,\n    maxHeight: -1,\n    scrollbar: {\n        ...MonacoEditorProvider.inlineOptions.scrollbar,\n        alwaysConsumeMouseWheel: false\n    },\n    lineDecorationsWidth: 10,\n};\n\nexport class CellEditor extends React.Component<CellEditorProps, {}> {\n\n    protected editor?: SimpleMonacoEditor;\n    protected toDispose = new DisposableCollection();\n    protected container?: HTMLDivElement;\n\n    override componentDidMount(): void {\n        this.disposeEditor();\n        this.toDispose.push(this.props.cell.onWillFocusCellEditor(focusRequest => {\n            this.editor?.getControl().focus();\n            const lineCount = this.editor?.getControl().getModel()?.getLineCount();\n            if (focusRequest && lineCount) {\n                this.editor?.getControl().setPosition(focusRequest === 'lastLine' ?\n                    { lineNumber: lineCount, column: 1 } :\n                    { lineNumber: focusRequest, column: 1 },\n                    'keyboard');\n            }\n            const currentLine = this.editor?.getControl().getPosition()?.lineNumber;\n            this.props.notebookContextManager.scopedStore.setContext(NOTEBOOK_CELL_CURSOR_FIRST_LINE, currentLine === 1);\n            this.props.notebookContextManager.scopedStore.setContext(NOTEBOOK_CELL_CURSOR_LAST_LINE, currentLine === lineCount);\n\n        }));\n\n        this.toDispose.push(this.props.cell.onDidChangeEditorOptions(options => {\n            this.editor?.getControl().updateOptions(options);\n        }));\n\n        this.toDispose.push(this.props.cell.onDidChangeLanguage(language => {\n            this.editor?.setLanguage(language);\n        }));\n\n        this.toDispose.push(this.props.notebookModel.onDidChangeSelectedCell(e => {\n            if (e.cell !== this.props.cell && this.editor?.getControl().hasTextFocus()) {\n                this.props.notebookContextManager.context?.focus();\n            }\n        }));\n        if (!this.props.notebookViewportService || (this.container && this.props.notebookViewportService.isElementInViewport(this.container))) {\n            this.initEditor();\n        } else {\n            const disposable = this.props.notebookViewportService?.onDidChangeViewport(() => {\n                if (!this.editor && this.container && this.props.notebookViewportService!.isElementInViewport(this.container)) {\n                    this.initEditor();\n                    disposable.dispose();\n                }\n            });\n            this.toDispose.push(disposable);\n        }\n    }\n\n    override componentWillUnmount(): void {\n        this.disposeEditor();\n    }\n\n    protected disposeEditor(): void {\n        this.toDispose.dispose();\n        this.toDispose = new DisposableCollection();\n    }\n\n    protected async initEditor(): Promise<void> {\n        const { cell, notebookModel, monacoServices } = this.props;\n        if (this.container) {\n            const editorNode = this.container;\n            editorNode.style.height = '';\n            const editorModel = await cell.resolveTextModel();\n            const uri = cell.uri;\n            this.editor = new SimpleMonacoEditor(uri,\n                editorModel,\n                editorNode,\n                monacoServices,\n                { ...DEFAULT_EDITOR_OPTIONS, ...cell.editorOptions },\n                [[IContextKeyService, this.props.notebookContextManager.scopedStore]],\n                { contributions: EditorExtensionsRegistry.getEditorContributions().filter(c => c.id !== 'editor.contrib.findController') });\n            this.toDispose.push(this.editor);\n            this.editor.setLanguage(cell.language);\n            this.toDispose.push(this.editor.getControl().onDidContentSizeChange(() => {\n                editorNode.style.height = this.editor!.getControl().getContentHeight() + 7 + 'px';\n                this.editor!.setSize({ width: -1, height: this.editor!.getControl().getContentHeight() });\n            }));\n            this.toDispose.push(this.editor.onDocumentContentChanged(e => {\n                notebookModel.cellDirtyChanged(cell, true);\n            }));\n            this.toDispose.push(this.editor.getControl().onDidFocusEditorText(() => {\n                this.props.notebookContextManager.onDidEditorTextFocus(true);\n                this.props.notebookModel.setSelectedCell(cell, false);\n            }));\n            this.toDispose.push(this.editor.getControl().onDidBlurEditorText(() => {\n                this.props.notebookContextManager.onDidEditorTextFocus(false);\n            }));\n            this.toDispose.push(this.editor.getControl().onDidChangeCursorPosition(e => {\n                if (e.secondaryPositions.length === 0) {\n                    this.props.notebookContextManager.scopedStore.setContext(NOTEBOOK_CELL_CURSOR_FIRST_LINE, e.position.lineNumber === 1);\n                    this.props.notebookContextManager.scopedStore.setContext(NOTEBOOK_CELL_CURSOR_LAST_LINE,\n                        e.position.lineNumber === this.editor!.getControl().getModel()!.getLineCount());\n                } else {\n                    this.props.notebookContextManager.scopedStore.setContext(NOTEBOOK_CELL_CURSOR_FIRST_LINE, false);\n                    this.props.notebookContextManager.scopedStore.setContext(NOTEBOOK_CELL_CURSOR_LAST_LINE, false);\n                }\n            }));\n            if (cell.editing && notebookModel.selectedCell === cell) {\n                this.editor.getControl().focus();\n            }\n        }\n    }\n\n    protected setContainer(component: HTMLDivElement | null): void {\n        this.container = component ?? undefined;\n    };\n\n    protected handleResize = () => {\n        this.editor?.refresh();\n    };\n\n    protected estimateHeight(): string {\n        const lineHeight = this.props.fontInfo?.lineHeight ?? 20;\n        return this.props.cell.text.split(OS.backend.EOL).length * lineHeight + 10 + 7 + 'px';\n    }\n\n    override render(): React.ReactNode {\n        return <div className='theia-notebook-cell-editor' onResize={this.handleResize} id={this.props.cell.uri.toString()}\n            ref={container => this.setContainer(container)} style={{ height: this.editor ? undefined : this.estimateHeight() }}>\n        </div >;\n    }\n\n}\n","// *****************************************************************************\n// Copyright (C) 2023 TypeFox and others.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\nimport * as React from '@theia/core/shared/react';\nimport { CellEditType, CellKind } from '../../common';\nimport { NotebookCellModel } from '../view-model/notebook-cell-model';\nimport { NotebookModel } from '../view-model/notebook-model';\nimport { NotebookCellToolbarFactory } from './notebook-cell-toolbar-factory';\nimport { codicon } from '@theia/core/lib/browser';\nimport { CommandRegistry, DisposableCollection, nls } from '@theia/core';\nimport { NotebookCommands } from '../contributions/notebook-actions-contribution';\nimport { NotebookCellActionContribution } from '../contributions/notebook-cell-actions-contribution';\n\nexport interface CellRenderer {\n    render(notebookData: NotebookModel, cell: NotebookCellModel, index: number): React.ReactNode\n    renderDragImage(cell: NotebookCellModel): HTMLElement\n}\n\ninterface CellListProps {\n    renderers: Map<CellKind, CellRenderer>;\n    notebookModel: NotebookModel;\n    toolbarRenderer: NotebookCellToolbarFactory;\n    commandRegistry: CommandRegistry\n}\n\ninterface NotebookCellListState {\n    selectedCell?: NotebookCellModel;\n    scrollIntoView: boolean;\n    dragOverIndicator: { cell: NotebookCellModel, position: 'top' | 'bottom' } | undefined;\n}\n\nexport class NotebookCellListView extends React.Component<CellListProps, NotebookCellListState> {\n\n    protected toDispose = new DisposableCollection();\n\n    protected static dragGhost: HTMLElement | undefined;\n\n    constructor(props: CellListProps) {\n        super(props);\n        this.state = { selectedCell: props.notebookModel.selectedCell, dragOverIndicator: undefined, scrollIntoView: true };\n        this.toDispose.push(props.notebookModel.onDidAddOrRemoveCell(e => {\n            if (e.newCellIds && e.newCellIds.length > 0) {\n                this.setState({\n                    ...this.state,\n                    selectedCell: this.props.notebookModel.cells.find(model => model.handle === e.newCellIds![e.newCellIds!.length - 1]),\n                    scrollIntoView: true\n                });\n            } else {\n                this.setState({\n                    ...this.state,\n                    selectedCell: this.props.notebookModel.cells.find(cell => cell === this.state.selectedCell),\n                    scrollIntoView: false\n                });\n            }\n        }));\n\n        this.toDispose.push(props.notebookModel.onDidChangeSelectedCell(e => {\n            this.setState({\n                ...this.state,\n                selectedCell: e.cell,\n                scrollIntoView: e.scrollIntoView\n            });\n        }));\n    }\n\n    override componentWillUnmount(): void {\n        this.toDispose.dispose();\n    }\n\n    override render(): React.ReactNode {\n        return <ul className='theia-notebook-cell-list'>\n            {this.props.notebookModel.cells\n                .map((cell, index) =>\n                    <React.Fragment key={'cell-' + cell.handle}>\n                        <NotebookCellDivider\n                            isVisible={() => this.isEnabled()}\n                            onAddNewCell={(kind: CellKind) => this.onAddNewCell(kind, index)}\n                            onDrop={e => this.onDrop(e, index)}\n                            onDragOver={e => this.onDragOver(e, cell, 'top')} />\n                        {this.shouldRenderDragOverIndicator(cell, 'top') && <CellDropIndicator />}\n                        <li className={'theia-notebook-cell' + (this.state.selectedCell === cell ? ' focused' : '') + (this.isEnabled() ? ' draggable' : '')}\n                            onClick={e => {\n                                this.setState({ ...this.state, selectedCell: cell });\n                                this.props.notebookModel.setSelectedCell(cell, false);\n                            }}\n                            onDragStart={e => this.onDragStart(e, index, cell)}\n                            onDragEnd={e => {\n                                NotebookCellListView.dragGhost?.remove();\n                                this.setState({ ...this.state, dragOverIndicator: undefined });\n                            }}\n                            onDragOver={e => this.onDragOver(e, cell)}\n                            onDrop={e => this.onDrop(e, index)}\n                            draggable={true}\n                            ref={ref => cell === this.state.selectedCell && this.state.scrollIntoView && ref?.scrollIntoView({ block: 'nearest' })}>\n                            <div className={'theia-notebook-cell-marker' + (this.state.selectedCell === cell ? ' theia-notebook-cell-marker-selected' : '')}></div>\n                            <div className='theia-notebook-cell-content'>\n                                {this.renderCellContent(cell, index)}\n                            </div>\n                            {this.state.selectedCell === cell &&\n                                this.props.toolbarRenderer.renderCellToolbar(NotebookCellActionContribution.ACTION_MENU, cell, {\n                                    contextMenuArgs: () => [cell], commandArgs: () => [this.props.notebookModel]\n                                })\n                            }\n                        </li>\n                        {this.shouldRenderDragOverIndicator(cell, 'bottom') && <CellDropIndicator />}\n                    </React.Fragment>\n                )\n            }\n            <NotebookCellDivider\n                isVisible={() => this.isEnabled()}\n                onAddNewCell={(kind: CellKind) => this.onAddNewCell(kind, this.props.notebookModel.cells.length)}\n                onDrop={e => this.onDrop(e, this.props.notebookModel.cells.length - 1)}\n                onDragOver={e => this.onDragOver(e, this.props.notebookModel.cells[this.props.notebookModel.cells.length - 1], 'bottom')} />\n        </ul>;\n    }\n\n    renderCellContent(cell: NotebookCellModel, index: number): React.ReactNode {\n        const renderer = this.props.renderers.get(cell.cellKind);\n        if (!renderer) {\n            throw new Error(`No renderer found for cell type ${cell.cellKind}`);\n        }\n        return renderer.render(this.props.notebookModel, cell, index);\n    }\n\n    protected onDragStart(event: React.DragEvent<HTMLLIElement>, index: number, cell: NotebookCellModel): void {\n        event.stopPropagation();\n        if (!this.isEnabled()) {\n            event.preventDefault();\n            return;\n        }\n\n        NotebookCellListView.dragGhost = document.createElement('div');\n        NotebookCellListView.dragGhost.classList.add('theia-notebook-drag-ghost-image');\n        NotebookCellListView.dragGhost.appendChild(this.props.renderers.get(cell.cellKind)?.renderDragImage(cell) ?? document.createElement('div'));\n        document.body.appendChild(NotebookCellListView.dragGhost);\n        event.dataTransfer.setDragImage(NotebookCellListView.dragGhost, -10, 0);\n\n        event.dataTransfer.setData('text/theia-notebook-cell-index', index.toString());\n        event.dataTransfer.setData('text/plain', this.props.notebookModel.cells[index].source);\n    }\n\n    protected onDragOver(event: React.DragEvent<HTMLLIElement>, cell: NotebookCellModel, position?: 'top' | 'bottom'): void {\n        if (!this.isEnabled()) {\n            return;\n        }\n        event.preventDefault();\n        event.stopPropagation();\n        // show indicator\n        this.setState({ ...this.state, dragOverIndicator: { cell, position: position ?? event.nativeEvent.offsetY < event.currentTarget.clientHeight / 2 ? 'top' : 'bottom' } });\n    }\n\n    protected isEnabled(): boolean {\n        return !Boolean(this.props.notebookModel.readOnly);\n    }\n\n    protected onDrop(event: React.DragEvent<HTMLLIElement>, dropElementIndex: number): void {\n        if (!this.isEnabled()) {\n            this.setState({ dragOverIndicator: undefined });\n            return;\n        }\n        const index = parseInt(event.dataTransfer.getData('text/theia-notebook-cell-index'));\n        const isTargetBelow = index < dropElementIndex;\n        let newIdx = this.state.dragOverIndicator?.position === 'top' ? dropElementIndex : dropElementIndex + 1;\n        newIdx = isTargetBelow ? newIdx - 1 : newIdx;\n        if (index !== undefined && index !== dropElementIndex) {\n            this.props.notebookModel.applyEdits([{\n                editType: CellEditType.Move,\n                length: 1,\n                index,\n                newIdx\n            }], true);\n        }\n        this.setState({ ...this.state, dragOverIndicator: undefined });\n    }\n\n    protected onAddNewCell(kind: CellKind, index: number): void {\n        if (this.isEnabled()) {\n            this.props.commandRegistry.executeCommand(NotebookCommands.ADD_NEW_CELL_COMMAND.id,\n                this.props.notebookModel,\n                kind,\n                index\n            );\n        }\n    }\n\n    protected shouldRenderDragOverIndicator(cell: NotebookCellModel, position: 'top' | 'bottom'): boolean {\n        return this.isEnabled() &&\n            this.state.dragOverIndicator !== undefined &&\n            this.state.dragOverIndicator.cell === cell &&\n            this.state.dragOverIndicator.position === position;\n    }\n\n}\n\nexport interface NotebookCellDividerProps {\n    isVisible: () => boolean;\n    onAddNewCell: (type: CellKind) => void;\n    onDrop: (event: React.DragEvent<HTMLLIElement>) => void;\n    onDragOver: (event: React.DragEvent<HTMLLIElement>) => void;\n}\n\nexport function NotebookCellDivider({ isVisible, onAddNewCell, onDrop, onDragOver }: NotebookCellDividerProps): React.JSX.Element {\n    const [hover, setHover] = React.useState(false);\n\n    return <li className='theia-notebook-cell-divider' onMouseEnter={() => setHover(true)} onMouseLeave={() => setHover(false)} onDrop={onDrop} onDragOver={onDragOver}>\n        {hover && isVisible() && <div className='theia-notebook-add-cell-buttons'>\n            <button className='theia-notebook-add-cell-button' onClick={() => onAddNewCell(CellKind.Code)} title={nls.localizeByDefault('Add Code Cell')}>\n                <div className={codicon('add') + ' theia-notebook-add-cell-button-icon'} />\n                {nls.localizeByDefault('Code')}\n            </button>\n            <button className='theia-notebook-add-cell-button' onClick={() => onAddNewCell(CellKind.Markup)} title={nls.localizeByDefault('Add Markdown Cell')}>\n                <div className={codicon('add') + ' theia-notebook-add-cell-button-icon'} />\n                {nls.localizeByDefault('Markdown')}\n            </button>\n        </div>}\n    </li>;\n}\n\nfunction CellDropIndicator(): React.JSX.Element {\n    return <div className='theia-notebook-cell-drop-indicator' />;\n}\n","// *****************************************************************************\n// Copyright (C) 2023 TypeFox and others.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\n\nimport * as React from '@theia/core/shared/react';\nimport { CommandRegistry, CompoundMenuNodeRole, MenuModelRegistry, MenuNode } from '@theia/core';\nimport { inject, injectable } from '@theia/core/shared/inversify';\nimport { ContextKeyService } from '@theia/core/lib/browser/context-key-service';\nimport { NotebookCellSidebar, NotebookCellToolbar } from './notebook-cell-toolbar';\nimport { ContextMenuRenderer } from '@theia/core/lib/browser';\nimport { NotebookCellModel } from '../view-model/notebook-cell-model';\nimport { NotebookContextManager } from '../service/notebook-context-manager';\n\nexport interface NotebookCellToolbarItem {\n    id: string;\n    icon?: string;\n    label?: string;\n    onClick: (e: React.MouseEvent) => void;\n    isVisible: () => boolean;\n    contextKeys?: Set<string>\n}\n\nexport interface toolbarItemOptions {\n    contextMenuArgs?: () => unknown[];\n    commandArgs?: () => unknown[];\n}\n\n@injectable()\nexport class NotebookCellToolbarFactory {\n\n    @inject(MenuModelRegistry)\n    protected menuRegistry: MenuModelRegistry;\n\n    @inject(ContextKeyService)\n    protected contextKeyService: ContextKeyService;\n\n    @inject(ContextMenuRenderer)\n    protected readonly contextMenuRenderer: ContextMenuRenderer;\n\n    @inject(CommandRegistry)\n    protected readonly commandRegistry: CommandRegistry;\n\n    @inject(NotebookContextManager)\n    protected readonly notebookContextManager: NotebookContextManager;\n\n    renderCellToolbar(menuPath: string[], cell: NotebookCellModel, itemOptions: toolbarItemOptions): React.ReactNode {\n        return <NotebookCellToolbar getMenuItems={() => this.getMenuItems(menuPath, cell, itemOptions)}\n            onContextKeysChanged={this.notebookContextManager.onDidChangeContext} />;\n    }\n\n    renderSidebar(menuPath: string[], cell: NotebookCellModel, itemOptions: toolbarItemOptions): React.ReactNode {\n        return <NotebookCellSidebar getMenuItems={() => this.getMenuItems(menuPath, cell, itemOptions)}\n            onContextKeysChanged={this.notebookContextManager.onDidChangeContext} />;\n    }\n\n    private getMenuItems(menuItemPath: string[], cell: NotebookCellModel, itemOptions: toolbarItemOptions): NotebookCellToolbarItem[] {\n        const inlineItems: NotebookCellToolbarItem[] = [];\n        for (const menuNode of this.menuRegistry.getMenu(menuItemPath).children) {\n            if (!menuNode.when || this.notebookContextManager.getCellContext(cell.handle).match(menuNode.when, this.notebookContextManager.context)) {\n                if (menuNode.role === CompoundMenuNodeRole.Flat) {\n                    inlineItems.push(...menuNode.children?.map(child => this.createToolbarItem(child, itemOptions)) ?? []);\n                } else {\n                    inlineItems.push(this.createToolbarItem(menuNode, itemOptions));\n                }\n            }\n        }\n        return inlineItems;\n    }\n\n    private createToolbarItem(menuNode: MenuNode, itemOptions: toolbarItemOptions): NotebookCellToolbarItem {\n        const menuPath = menuNode.role === CompoundMenuNodeRole.Submenu ? this.menuRegistry.getPath(menuNode) : undefined;\n        return {\n            id: menuNode.id,\n            icon: menuNode.icon,\n            label: menuNode.label,\n            onClick: menuPath ?\n                e => this.contextMenuRenderer.render(\n                    {\n                        anchor: e.nativeEvent,\n                        menuPath,\n                        includeAnchorArg: false,\n                        args: itemOptions.contextMenuArgs?.(),\n                        context: this.notebookContextManager.context\n                    }) :\n                () => this.commandRegistry.executeCommand(menuNode.command!, ...(itemOptions.commandArgs?.() ?? [])),\n            isVisible: () => menuPath ? true : Boolean(this.commandRegistry.getVisibleHandler(menuNode.command!, ...(itemOptions.commandArgs?.() ?? []))),\n            contextKeys: menuNode.when ? this.contextKeyService.parseKeys(menuNode.when) : undefined\n        };\n    }\n}\n","// *****************************************************************************\n// Copyright (C) 2023 TypeFox and others.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\nimport * as React from '@theia/core/shared/react';\nimport { ACTION_ITEM } from '@theia/core/lib/browser';\nimport { NotebookCellToolbarItem } from './notebook-cell-toolbar-factory';\nimport { DisposableCollection, Event } from '@theia/core';\nimport { ContextKeyChangeEvent } from '@theia/core/lib/browser/context-key-service';\n\nexport interface NotebookCellToolbarProps {\n    getMenuItems: () => NotebookCellToolbarItem[];\n    onContextKeysChanged: Event<ContextKeyChangeEvent>;\n}\n\ninterface NotebookCellToolbarState {\n    inlineItems: NotebookCellToolbarItem[];\n}\n\nabstract class NotebookCellActionBar extends React.Component<NotebookCellToolbarProps, NotebookCellToolbarState> {\n\n    protected toDispose = new DisposableCollection();\n\n    constructor(props: NotebookCellToolbarProps) {\n        super(props);\n        this.toDispose.push(props.onContextKeysChanged(e => {\n            const menuItems = this.props.getMenuItems();\n            if (menuItems.some(item => item.contextKeys ? e.affects(item.contextKeys) : false)) {\n                this.setState({ inlineItems: menuItems });\n            }\n        }));\n        this.state = { inlineItems: this.props.getMenuItems() };\n    }\n\n    override componentWillUnmount(): void {\n        this.toDispose.dispose();\n    }\n\n    protected renderItem(item: NotebookCellToolbarItem): React.ReactNode {\n        return <div key={item.id} title={item.label} onClick={item.onClick} className={`${item.icon} ${ACTION_ITEM} theia-notebook-cell-toolbar-item`} />;\n    }\n\n}\n\nexport class NotebookCellToolbar extends NotebookCellActionBar {\n\n    override render(): React.ReactNode {\n        return <div className='theia-notebook-cell-toolbar'>\n            {this.state.inlineItems.filter(e => e.isVisible()).map(item => this.renderItem(item))}\n        </div>;\n    }\n\n}\n\nexport class NotebookCellSidebar extends NotebookCellActionBar {\n\n    override render(): React.ReactNode {\n        return <div className='theia-notebook-cell-sidebar-toolbar'>\n            {this.state.inlineItems.filter(e => e.isVisible()).map(item => this.renderItem(item))}\n        </div>;\n    }\n}\n\n","// *****************************************************************************\n// Copyright (C) 2023 TypeFox and others.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\n\nimport { inject, injectable } from '@theia/core/shared/inversify';\nimport * as React from '@theia/core/shared/react';\nimport { MonacoEditorServices } from '@theia/monaco/lib/browser/monaco-editor';\nimport { CellOutputWebviewFactory, CellOutputWebview } from '../renderers/cell-output-webview';\nimport { NotebookRendererRegistry } from '../notebook-renderer-registry';\nimport { NotebookCellModel } from '../view-model/notebook-cell-model';\nimport { NotebookModel } from '../view-model/notebook-model';\nimport { CellEditor } from './notebook-cell-editor';\nimport { CellRenderer } from './notebook-cell-list-view';\nimport { NotebookCellToolbarFactory } from './notebook-cell-toolbar-factory';\nimport { NotebookCellActionContribution, NotebookCellCommands } from '../contributions/notebook-cell-actions-contribution';\nimport { CellExecution, NotebookExecutionStateService } from '../service/notebook-execution-state-service';\nimport { codicon } from '@theia/core/lib/browser';\nimport { NotebookCellExecutionState } from '../../common';\nimport { CommandRegistry, DisposableCollection, nls } from '@theia/core';\nimport { NotebookContextManager } from '../service/notebook-context-manager';\nimport { NotebookViewportService } from './notebook-viewport-service';\nimport { EditorPreferences } from '@theia/editor/lib/browser';\nimport { NotebookOptionsService } from '../service/notebook-options';\nimport { MarkdownRenderer } from '@theia/core/lib/browser/markdown-rendering/markdown-renderer';\nimport { MarkdownString } from '@theia/monaco-editor-core/esm/vs/base/common/htmlContent';\n\n@injectable()\nexport class NotebookCodeCellRenderer implements CellRenderer {\n    @inject(MonacoEditorServices)\n    protected readonly monacoServices: MonacoEditorServices;\n\n    @inject(NotebookRendererRegistry)\n    protected readonly notebookRendererRegistry: NotebookRendererRegistry;\n\n    @inject(CellOutputWebviewFactory)\n    protected readonly cellOutputWebviewFactory: CellOutputWebviewFactory;\n\n    @inject(NotebookCellToolbarFactory)\n    protected readonly notebookCellToolbarFactory: NotebookCellToolbarFactory;\n\n    @inject(NotebookExecutionStateService)\n    protected readonly executionStateService: NotebookExecutionStateService;\n\n    @inject(NotebookContextManager)\n    protected readonly notebookContextManager: NotebookContextManager;\n\n    @inject(NotebookViewportService)\n    protected readonly notebookViewportService: NotebookViewportService;\n\n    @inject(EditorPreferences)\n    protected readonly editorPreferences: EditorPreferences;\n\n    @inject(CommandRegistry)\n    protected readonly commandRegistry: CommandRegistry;\n\n    @inject(NotebookOptionsService)\n    protected readonly notebookOptionsService: NotebookOptionsService;\n\n    @inject(MarkdownRenderer)\n    protected readonly markdownRenderer: MarkdownRenderer;\n\n    render(notebookModel: NotebookModel, cell: NotebookCellModel, handle: number): React.ReactNode {\n        return <div>\n            <div className='theia-notebook-cell-with-sidebar'>\n                <div className='theia-notebook-cell-sidebar'>\n                    {this.notebookCellToolbarFactory.renderSidebar(NotebookCellActionContribution.CODE_CELL_SIDEBAR_MENU, cell, {\n                        contextMenuArgs: () => [cell], commandArgs: () => [notebookModel, cell]\n                    })\n                    }\n                    <CodeCellExecutionOrder cell={cell} />\n                </div>\n                <div className='theia-notebook-cell-editor-container'>\n                    <CellEditor notebookModel={notebookModel} cell={cell}\n                        monacoServices={this.monacoServices}\n                        notebookContextManager={this.notebookContextManager}\n                        notebookViewportService={this.notebookViewportService}\n                        fontInfo={this.notebookOptionsService.editorFontInfo} />\n                    <NotebookCodeCellStatus cell={cell} notebook={notebookModel}\n                        commandRegistry={this.commandRegistry}\n                        executionStateService={this.executionStateService}\n                        onClick={() => cell.requestFocusEditor()} />\n                </div >\n            </div >\n            <div className='theia-notebook-cell-with-sidebar'>\n                <NotebookCodeCellOutputs cell={cell} notebook={notebookModel} outputWebviewFactory={this.cellOutputWebviewFactory}\n                    renderSidebar={() =>\n                        this.notebookCellToolbarFactory.renderSidebar(NotebookCellActionContribution.OUTPUT_SIDEBAR_MENU, cell, {\n                            contextMenuArgs: () => [notebookModel, cell, cell.outputs[0]]\n                        })\n                    } />\n            </div>\n        </div >;\n    }\n\n    renderDragImage(cell: NotebookCellModel): HTMLElement {\n        const dragImage = document.createElement('div');\n        dragImage.className = 'theia-notebook-drag-image';\n        dragImage.style.width = this.notebookContextManager.context?.clientWidth + 'px';\n        dragImage.style.height = '100px';\n        dragImage.style.display = 'flex';\n\n        const fakeRunButton = document.createElement('span');\n        fakeRunButton.className = `${codicon('play')} theia-notebook-cell-status-item`;\n        dragImage.appendChild(fakeRunButton);\n\n        const fakeEditor = document.createElement('div');\n        dragImage.appendChild(fakeEditor);\n        const lines = cell.source.split('\\n').slice(0, 5).join('\\n');\n        const codeSequence = this.getMarkdownCodeSequence(lines);\n        const firstLine = new MarkdownString(`${codeSequence}${cell.language}\\n${lines}\\n${codeSequence}`, { supportHtml: true, isTrusted: false });\n        fakeEditor.appendChild(this.markdownRenderer.render(firstLine).element);\n        fakeEditor.classList.add('theia-notebook-cell-editor-container');\n        fakeEditor.style.padding = '10px';\n        return dragImage;\n    }\n\n    protected getMarkdownCodeSequence(input: string): string {\n        // We need a minimum of 3 backticks to start a code block.\n        let longest = 2;\n        let current = 0;\n        for (let i = 0; i < input.length; i++) {\n            const char = input.charAt(i);\n            if (char === '`') {\n                current++;\n                if (current > longest) {\n                    longest = current;\n                }\n            } else {\n                current = 0;\n            }\n        }\n        return Array(longest + 1).fill('`').join('');\n    }\n\n}\n\nexport interface NotebookCodeCellStatusProps {\n    notebook: NotebookModel;\n    cell: NotebookCellModel;\n    commandRegistry: CommandRegistry;\n    executionStateService: NotebookExecutionStateService;\n    onClick: () => void;\n}\n\nexport interface NotebookCodeCellStatusState {\n    currentExecution?: CellExecution;\n    executionTime: number;\n}\n\nexport class NotebookCodeCellStatus extends React.Component<NotebookCodeCellStatusProps, NotebookCodeCellStatusState> {\n\n    protected toDispose = new DisposableCollection();\n\n    constructor(props: NotebookCodeCellStatusProps) {\n        super(props);\n\n        this.state = {\n            executionTime: 0\n        };\n\n        let currentInterval: NodeJS.Timeout | undefined;\n        this.toDispose.push(props.executionStateService.onDidChangeExecution(event => {\n            if (event.affectsCell(this.props.cell.uri)) {\n                this.setState({ currentExecution: event.changed, executionTime: 0 });\n                clearInterval(currentInterval);\n                if (event.changed?.state === NotebookCellExecutionState.Executing) {\n                    const startTime = Date.now();\n                    // The resolution of the time display is only a single digit after the decimal point.\n                    // Therefore, we only need to update the display every 100ms.\n                    currentInterval = setInterval(() => {\n                        this.setState({\n                            executionTime: Date.now() - startTime\n                        });\n                    }, 100);\n                }\n            }\n        }));\n\n        this.toDispose.push(props.cell.onDidChangeLanguage(() => {\n            this.forceUpdate();\n        }));\n    }\n\n    override componentWillUnmount(): void {\n        this.toDispose.dispose();\n    }\n\n    override render(): React.ReactNode {\n        return <div className='notebook-cell-status' onClick={() => this.props.onClick()}>\n            <div className='notebook-cell-status-left'>\n                {this.renderExecutionState()}\n            </div>\n            <div className='notebook-cell-status-right'>\n                <span className='notebook-cell-language-label' onClick={() => {\n                    this.props.commandRegistry.executeCommand(NotebookCellCommands.CHANGE_CELL_LANGUAGE.id, this.props.notebook, this.props.cell);\n                }}>{this.props.cell.languageName}</span>\n            </div>\n        </div>;\n    }\n\n    private renderExecutionState(): React.ReactNode {\n        const state = this.state.currentExecution?.state;\n        const { lastRunSuccess } = this.props.cell.internalMetadata;\n\n        let iconClasses: string | undefined = undefined;\n        let color: string | undefined = undefined;\n        if (!state && lastRunSuccess) {\n            iconClasses = codicon('check');\n            color = 'green';\n        } else if (!state && lastRunSuccess === false) {\n            iconClasses = codicon('error');\n            color = 'red';\n        } else if (state === NotebookCellExecutionState.Pending || state === NotebookCellExecutionState.Unconfirmed) {\n            iconClasses = codicon('clock');\n        } else if (state === NotebookCellExecutionState.Executing) {\n            iconClasses = `${codicon('sync')} theia-animation-spin`;\n        }\n        return <>\n            {iconClasses &&\n                <>\n                    <span className={`${iconClasses} notebook-cell-status-item`} style={{ color }}></span>\n                    <div className='notebook-cell-status-item'>{this.renderTime(this.getExecutionTime())}</div>\n                </>}\n        </>;\n    }\n\n    private getExecutionTime(): number {\n        const { runStartTime, runEndTime } = this.props.cell.internalMetadata;\n        const { executionTime } = this.state;\n        if (runStartTime !== undefined && runEndTime !== undefined) {\n            return runEndTime - runStartTime;\n        }\n        return executionTime;\n    }\n\n    private renderTime(ms: number): string {\n        return `${(ms / 1000).toLocaleString(undefined, { maximumFractionDigits: 1, minimumFractionDigits: 1 })}s`;\n    }\n}\n\ninterface NotebookCellOutputProps {\n    cell: NotebookCellModel;\n    notebook: NotebookModel;\n    outputWebviewFactory: CellOutputWebviewFactory;\n    renderSidebar: () => React.ReactNode;\n}\n\nexport class NotebookCodeCellOutputs extends React.Component<NotebookCellOutputProps> {\n\n    protected outputsWebview: CellOutputWebview | undefined;\n    protected outputsWebviewPromise: Promise<CellOutputWebview> | undefined;\n\n    protected toDispose = new DisposableCollection();\n\n    constructor(props: NotebookCellOutputProps) {\n        super(props);\n    }\n\n    override async componentDidMount(): Promise<void> {\n        const { cell, notebook, outputWebviewFactory } = this.props;\n        this.toDispose.push(cell.onDidChangeOutputs(() => this.updateOutputs()));\n        this.toDispose.push(cell.onDidChangeOutputVisibility(visible => {\n            if (!visible && this.outputsWebview) {\n                this.outputsWebview?.dispose();\n                this.outputsWebview = undefined;\n                this.outputsWebviewPromise = undefined;\n                this.forceUpdate();\n            } else {\n                this.updateOutputs();\n            }\n        }));\n        if (cell.outputs.length > 0) {\n            this.outputsWebviewPromise = outputWebviewFactory(cell, notebook).then(webview => {\n                this.outputsWebview = webview;\n                this.forceUpdate();\n                return webview;\n            });\n        }\n    }\n\n    protected async updateOutputs(): Promise<void> {\n        const { cell, notebook, outputWebviewFactory } = this.props;\n        if (!this.outputsWebviewPromise && cell.outputs.length > 0) {\n            this.outputsWebviewPromise = outputWebviewFactory(cell, notebook).then(webview => {\n                this.outputsWebview = webview;\n                this.forceUpdate();\n                return webview;\n            });\n            this.forceUpdate();\n        } else if (this.outputsWebviewPromise && cell.outputs.length === 0 && cell.internalMetadata.runEndTime) {\n            (await this.outputsWebviewPromise).dispose();\n            this.outputsWebview = undefined;\n            this.outputsWebviewPromise = undefined;\n            this.forceUpdate();\n        }\n    }\n\n    override async componentDidUpdate(): Promise<void> {\n        if (!(await this.outputsWebviewPromise)?.isAttached()) {\n            (await this.outputsWebviewPromise)?.attachWebview();\n        }\n    }\n\n    override async componentWillUnmount(): Promise<void> {\n        this.toDispose.dispose();\n        (await this.outputsWebviewPromise)?.dispose();\n    }\n\n    override render(): React.ReactNode {\n        return this.outputsWebview && this.props.cell.outputVisible ?\n            <>\n                {this.props.renderSidebar()}\n                {this.outputsWebview.render()}\n            </> :\n            this.props.cell.outputs?.length ? <i className='theia-notebook-collapsed-output'>{nls.localizeByDefault('Outputs are collapsed')}</i> : <></>;\n\n    }\n\n}\n\ninterface NotebookCellExecutionOrderProps {\n    cell: NotebookCellModel;\n}\n\nfunction CodeCellExecutionOrder({ cell }: NotebookCellExecutionOrderProps): React.JSX.Element {\n    const [executionOrder, setExecutionOrder] = React.useState(cell.internalMetadata.executionOrder ?? ' ');\n\n    React.useEffect(() => {\n        const listener = cell.onDidChangeInternalMetadata(e => {\n            setExecutionOrder(cell.internalMetadata.executionOrder ?? ' ');\n        });\n        return () => listener.dispose();\n    }, []);\n\n    return <span className='theia-notebook-code-cell-execution-order'>{`[${executionOrder}]`}</span>;\n}\n","// *****************************************************************************\n// Copyright (C) 2023 TypeFox and others.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\nimport { ArrayUtils, CommandRegistry, CompoundMenuNodeRole, DisposableCollection, MenuModelRegistry, MenuNode, nls } from '@theia/core';\nimport * as React from '@theia/core/shared/react';\nimport { codicon, ContextMenuRenderer } from '@theia/core/lib/browser';\nimport { NotebookCommands, NotebookMenus } from '../contributions/notebook-actions-contribution';\nimport { NotebookModel } from '../view-model/notebook-model';\nimport { NotebookKernelService } from '../service/notebook-kernel-service';\nimport { inject, injectable } from '@theia/core/shared/inversify';\nimport { ContextKeyService } from '@theia/core/lib/browser/context-key-service';\nimport { NotebookCommand } from '../../common';\nimport { NotebookContextManager } from '../service/notebook-context-manager';\n\nexport interface NotebookMainToolbarProps {\n    notebookModel: NotebookModel\n    menuRegistry: MenuModelRegistry;\n    notebookKernelService: NotebookKernelService;\n    commandRegistry: CommandRegistry;\n    contextKeyService: ContextKeyService;\n    editorNode: HTMLElement;\n    notebookContextManager: NotebookContextManager;\n    contextMenuRenderer: ContextMenuRenderer;\n}\n\n@injectable()\nexport class NotebookMainToolbarRenderer {\n    @inject(NotebookKernelService) protected readonly notebookKernelService: NotebookKernelService;\n    @inject(CommandRegistry) protected readonly commandRegistry: CommandRegistry;\n    @inject(MenuModelRegistry) protected readonly menuRegistry: MenuModelRegistry;\n    @inject(ContextKeyService) protected readonly contextKeyService: ContextKeyService;\n    @inject(NotebookContextManager) protected readonly notebookContextManager: NotebookContextManager;\n    @inject(ContextMenuRenderer) protected readonly contextMenuRenderer: ContextMenuRenderer;\n\n    render(notebookModel: NotebookModel, editorNode: HTMLElement): React.ReactNode {\n        return <NotebookMainToolbar notebookModel={notebookModel}\n            menuRegistry={this.menuRegistry}\n            notebookKernelService={this.notebookKernelService}\n            commandRegistry={this.commandRegistry}\n            contextKeyService={this.contextKeyService}\n            editorNode={editorNode}\n            notebookContextManager={this.notebookContextManager}\n            contextMenuRenderer={this.contextMenuRenderer} />;\n    }\n}\n\ninterface NotebookMainToolbarState {\n    selectedKernelLabel?: string;\n    numberOfHiddenItems: number;\n}\n\nexport class NotebookMainToolbar extends React.Component<NotebookMainToolbarProps, NotebookMainToolbarState> {\n\n    // The minimum area between items and kernel select before hiding items in a context menu\n    static readonly MIN_FREE_AREA = 10;\n\n    protected toDispose = new DisposableCollection();\n\n    protected nativeSubmenus = [\n        NotebookMenus.NOTEBOOK_MAIN_TOOLBAR_CELL_ADD_GROUP[NotebookMenus.NOTEBOOK_MAIN_TOOLBAR_CELL_ADD_GROUP.length - 1],\n        NotebookMenus.NOTEBOOK_MAIN_TOOLBAR_EXECUTION_GROUP[NotebookMenus.NOTEBOOK_MAIN_TOOLBAR_EXECUTION_GROUP.length - 1]];\n\n    protected gapElement: HTMLDivElement | undefined;\n    protected lastGapElementWidth: number = 0;\n\n    protected resizeObserver: ResizeObserver = new ResizeObserver(() => this.calculateItemsToHide());\n\n    constructor(props: NotebookMainToolbarProps) {\n        super(props);\n\n        this.state = {\n            selectedKernelLabel: props.notebookKernelService.getSelectedOrSuggestedKernel(props.notebookModel)?.label,\n            numberOfHiddenItems: 0,\n        };\n        this.toDispose.push(props.notebookKernelService.onDidChangeSelectedKernel(event => {\n            if (props.notebookModel.uri.isEqual(event.notebook)) {\n                this.setState({ selectedKernelLabel: props.notebookKernelService.getKernel(event.newKernel ?? '')?.label });\n            }\n        }));\n        // in case the selected kernel is added after the notebook is loaded\n        this.toDispose.push(props.notebookKernelService.onDidAddKernel(() => {\n            if (!this.state.selectedKernelLabel) {\n                this.setState({ selectedKernelLabel: props.notebookKernelService.getSelectedOrSuggestedKernel(props.notebookModel)?.label });\n            }\n        }));\n\n        // TODO maybe we need a mechanism to check for changes in the menu to update this toolbar\n        const contextKeys = new Set<string>();\n        this.getAllContextKeys(this.getMenuItems(), contextKeys);\n        props.notebookContextManager.onDidChangeContext(e => {\n            if (e.affects(contextKeys)) {\n                this.forceUpdate();\n            }\n        });\n        props.contextKeyService.onDidChange(e => {\n            if (e.affects(contextKeys)) {\n                this.forceUpdate();\n            }\n        });\n\n    }\n\n    override componentWillUnmount(): void {\n        this.toDispose.dispose();\n    }\n\n    override componentDidUpdate(): void {\n        this.calculateItemsToHide();\n    }\n\n    override componentDidMount(): void {\n        this.calculateItemsToHide();\n    }\n\n    protected calculateItemsToHide(): void {\n        const numberOfMenuItems = this.getMenuItems().length;\n        if (this.gapElement && this.gapElement.getBoundingClientRect().width < NotebookMainToolbar.MIN_FREE_AREA && this.state.numberOfHiddenItems < numberOfMenuItems) {\n            this.setState({ ...this.state, numberOfHiddenItems: this.state.numberOfHiddenItems + 1 });\n            this.lastGapElementWidth = this.gapElement.getBoundingClientRect().width;\n        } else if (this.gapElement && this.gapElement.getBoundingClientRect().width > this.lastGapElementWidth && this.state.numberOfHiddenItems > 0) {\n            this.setState({ ...this.state, numberOfHiddenItems: 0 });\n            this.lastGapElementWidth = this.gapElement.getBoundingClientRect().width;\n        }\n    }\n\n    protected renderContextMenu(event: MouseEvent, menuItems: readonly MenuNode[]): void {\n        const hiddenItems = menuItems.slice(menuItems.length - this.calculateNumberOfHiddenItems(menuItems));\n        const contextMenu = this.props.menuRegistry.getMenu([NotebookMenus.NOTEBOOK_MAIN_TOOLBAR_HIDDEN_ITEMS_CONTEXT_MENU]);\n\n        contextMenu.children.map(item => item.id).forEach(id => contextMenu.removeNode(id));\n        hiddenItems.forEach(item => contextMenu.addNode(item));\n\n        this.props.contextMenuRenderer.render({\n            anchor: event,\n            menuPath: [NotebookMenus.NOTEBOOK_MAIN_TOOLBAR_HIDDEN_ITEMS_CONTEXT_MENU],\n            context: this.props.editorNode,\n            args: [this.props.notebookModel.uri]\n        });\n    }\n\n    override render(): React.ReactNode {\n        const menuItems = this.getMenuItems();\n        return <div className='theia-notebook-main-toolbar'>\n            {menuItems.slice(0, menuItems.length - this.calculateNumberOfHiddenItems(menuItems)).map(item => this.renderMenuItem(item))}\n            {\n                this.state.numberOfHiddenItems > 0 &&\n                <span className={`${codicon('ellipsis')} action-label theia-notebook-main-toolbar-item`} onClick={e => this.renderContextMenu(e.nativeEvent, menuItems)} />\n            }\n            <div ref={element => this.gapElementChanged(element)} style={{ flexGrow: 1 }}></div>\n            <div className='theia-notebook-main-toolbar-item action-label'\n                onClick={() => this.props.commandRegistry.executeCommand(NotebookCommands.SELECT_KERNEL_COMMAND.id, this.props.notebookModel)}>\n                <span className={codicon('server-environment')} />\n                <span className=' theia-notebook-main-toolbar-item-text'>\n                    {this.state.selectedKernelLabel ?? nls.localizeByDefault('Select Kernel')}\n                </span>\n            </div>\n        </div >;\n    }\n\n    protected gapElementChanged(element: HTMLDivElement | null): void {\n        if (this.gapElement) {\n            this.resizeObserver.unobserve(this.gapElement);\n        }\n        this.gapElement = element ?? undefined;\n        if (this.gapElement) {\n            this.lastGapElementWidth = this.gapElement.getBoundingClientRect().width;\n            this.resizeObserver.observe(this.gapElement);\n        }\n    }\n\n    protected renderMenuItem(item: MenuNode, submenu?: string): React.ReactNode {\n        if (item.role === CompoundMenuNodeRole.Group) {\n            const itemNodes = ArrayUtils.coalesce(item.children?.map(child => this.renderMenuItem(child, item.id)) ?? []);\n            return <React.Fragment key={item.id}>\n                {itemNodes}\n                {itemNodes && itemNodes.length > 0 && <span key={`${item.id}-separator`} className='theia-notebook-toolbar-separator'></span>}\n            </React.Fragment>;\n        } else if ((this.nativeSubmenus.includes(submenu ?? '')) || !item.when || this.props.contextKeyService.match(item.when, this.props.editorNode)) {\n            const visibleCommand = Boolean(this.props.commandRegistry.getVisibleHandler(item.command ?? '', this.props.notebookModel));\n            if (!visibleCommand) {\n                return undefined;\n            }\n            const command = this.props.commandRegistry.getCommand(item.command ?? '') as NotebookCommand | undefined;\n            const label = command?.shortTitle ?? item.label;\n            const title = command?.tooltip ?? item.label;\n            return <div key={item.id} title={title} className={`theia-notebook-main-toolbar-item action-label${this.getAdditionalClasses(item)}`}\n                onClick={() => {\n                    if (item.command && (!item.when || this.props.contextKeyService.match(item.when, this.props.editorNode))) {\n                        this.props.commandRegistry.executeCommand(item.command, this.props.notebookModel.uri);\n                    }\n                }}>\n                <span className={item.icon} />\n                <span className='theia-notebook-main-toolbar-item-text'>{label}</span>\n            </div>;\n        }\n        return undefined;\n    }\n\n    protected getMenuItems(): readonly MenuNode[] {\n        const menuPath = NotebookMenus.NOTEBOOK_MAIN_TOOLBAR;\n        const pluginCommands = this.props.menuRegistry.getMenuNode(menuPath).children;\n        const theiaCommands = this.props.menuRegistry.getMenu([menuPath]).children;\n        return theiaCommands.concat(pluginCommands);\n    }\n\n    protected getAdditionalClasses(item: MenuNode): string {\n        return !item.when || this.props.contextKeyService.match(item.when, this.props.editorNode) ? '' : ' theia-mod-disabled';\n    }\n\n    protected getAllContextKeys(menus: readonly MenuNode[], keySet: Set<string>): void {\n        menus.filter(item => item.when)\n            .forEach(item => this.props.contextKeyService.parseKeys(item.when!)?.forEach(key => keySet.add(key)));\n\n        menus.filter(item => item.children && item.children.length > 0)\n            .forEach(item => this.getAllContextKeys(item.children!, keySet));\n    }\n\n    protected calculateNumberOfHiddenItems(allMenuItems: readonly MenuNode[]): number {\n        return this.state.numberOfHiddenItems >= allMenuItems.length ?\n            allMenuItems.length :\n            this.state.numberOfHiddenItems % allMenuItems.length;\n    }\n}\n","// *****************************************************************************\n// Copyright (C) 2023 TypeFox and others.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\n\nimport * as React from '@theia/core/shared/react';\nimport { MarkdownRenderer } from '@theia/core/lib/browser/markdown-rendering/markdown-renderer';\nimport { MarkdownStringImpl } from '@theia/core/lib/common/markdown-rendering/markdown-string';\nimport { NotebookModel } from '../view-model/notebook-model';\nimport { CellRenderer } from './notebook-cell-list-view';\nimport { NotebookCellModel } from '../view-model/notebook-cell-model';\nimport { CellEditor } from './notebook-cell-editor';\nimport { inject, injectable } from '@theia/core/shared/inversify';\nimport { MonacoEditorServices } from '@theia/monaco/lib/browser/monaco-editor';\nimport { nls } from '@theia/core';\nimport { NotebookContextManager } from '../service/notebook-context-manager';\n\n@injectable()\nexport class NotebookMarkdownCellRenderer implements CellRenderer {\n\n    @inject(MarkdownRenderer)\n    private readonly markdownRenderer: MarkdownRenderer;\n    @inject(MonacoEditorServices)\n    protected readonly monacoServices: MonacoEditorServices;\n\n    @inject(NotebookContextManager)\n    protected readonly notebookContextManager: NotebookContextManager;\n\n    render(notebookModel: NotebookModel, cell: NotebookCellModel): React.ReactNode {\n        return <MarkdownCell markdownRenderer={this.markdownRenderer} monacoServices={this.monacoServices}\n            cell={cell} notebookModel={notebookModel} notebookContextManager={this.notebookContextManager} />;\n    }\n\n    renderDragImage(cell: NotebookCellModel): HTMLElement {\n        const dragImage = document.createElement('div');\n        dragImage.style.width = this.notebookContextManager.context?.clientWidth + 'px';\n        const markdownString = new MarkdownStringImpl(cell.source, { supportHtml: true, isTrusted: true });\n        const markdownElement = this.markdownRenderer.render(markdownString).element;\n        dragImage.appendChild(markdownElement);\n        return dragImage;\n    }\n}\n\ninterface MarkdownCellProps {\n    markdownRenderer: MarkdownRenderer,\n    monacoServices: MonacoEditorServices\n\n    cell: NotebookCellModel,\n    notebookModel: NotebookModel\n    notebookContextManager: NotebookContextManager;\n}\n\nfunction MarkdownCell({ markdownRenderer, monacoServices, cell, notebookModel, notebookContextManager }: MarkdownCellProps): React.JSX.Element {\n    const [editMode, setEditMode] = React.useState(cell.editing);\n\n    React.useEffect(() => {\n        const listener = cell.onDidRequestCellEditChange(cellEdit => setEditMode(cellEdit));\n        return () => listener.dispose();\n    }, [editMode]);\n\n    let markdownContent: HTMLElement = React.useMemo(() => {\n        const markdownString = new MarkdownStringImpl(cell.source, { supportHtml: true, isTrusted: true });\n        return markdownRenderer.render(markdownString).element;\n    }, [cell, editMode]);\n\n    if (!markdownContent.hasChildNodes()) {\n        const italic = document.createElement('i');\n        italic.className = 'theia-notebook-empty-markdown';\n        italic.innerText = nls.localizeByDefault('Empty markdown cell, double-click or press enter to edit.');\n        italic.style.pointerEvents = 'none';\n        markdownContent = italic;\n    }\n\n    return editMode ?\n        <CellEditor cell={cell} notebookModel={notebookModel} monacoServices={monacoServices} notebookContextManager={notebookContextManager} /> :\n        <div className='theia-notebook-markdown-content'\n            onDoubleClick={() => cell.requestEdit()}\n            ref={node => node?.replaceChildren(markdownContent)}\n        />;\n}\n","// *****************************************************************************\n// Copyright (C) 2024 TypeFox and others.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\n\nimport { Disposable } from '@theia/core';\nimport { injectable } from '@theia/core/shared/inversify';\nimport { Emitter } from '@theia/core/shared/vscode-languageserver-protocol';\n\n/**\n * this service is for managing the viewport and scroll state of a notebook editor.\n * its used both for restoring scroll state after reopening an editor and for cell to check if they are in the viewport.\n */\n@injectable()\nexport class NotebookViewportService implements Disposable {\n\n    protected onDidChangeViewportEmitter = new Emitter<void>();\n    readonly onDidChangeViewport = this.onDidChangeViewportEmitter.event;\n\n    protected _viewportElement: HTMLDivElement | undefined;\n\n    protected resizeObserver: ResizeObserver;\n\n    set viewportElement(element: HTMLDivElement | undefined) {\n        this._viewportElement = element;\n        if (element) {\n            this.onDidChangeViewportEmitter.fire();\n            this.resizeObserver?.disconnect();\n            this.resizeObserver = new ResizeObserver(() => this.onDidChangeViewportEmitter.fire());\n            this.resizeObserver.observe(element);\n        }\n    }\n\n    isElementInViewport(element: HTMLElement): boolean {\n        if (this._viewportElement) {\n            const rect = element.getBoundingClientRect();\n            const viewRect = this._viewportElement.getBoundingClientRect();\n            return rect.top < viewRect.top ? rect.bottom > viewRect.top : rect.top < viewRect.bottom;\n        }\n        return false;\n    }\n\n    onScroll(e: HTMLDivElement): void {\n        this.onDidChangeViewportEmitter.fire();\n    }\n\n    dispose(): void {\n        this.resizeObserver.disconnect();\n    }\n}\n","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _scrollbar = require('./scrollbar');\n\nvar _scrollbar2 = _interopRequireDefault(_scrollbar);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nexports.default = _scrollbar2.default;\nmodule.exports = exports['default'];","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _react = require('react');\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _propTypes = require('prop-types');\n\nvar _perfectScrollbar = require('perfect-scrollbar');\n\nvar _perfectScrollbar2 = _interopRequireDefault(_perfectScrollbar);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _objectWithoutProperties(obj, keys) { var target = {}; for (var i in obj) { if (keys.indexOf(i) >= 0) continue; if (!Object.prototype.hasOwnProperty.call(obj, i)) continue; target[i] = obj[i]; } return target; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar handlerNameByEvent = {\n  'ps-scroll-y': 'onScrollY',\n  'ps-scroll-x': 'onScrollX',\n  'ps-scroll-up': 'onScrollUp',\n  'ps-scroll-down': 'onScrollDown',\n  'ps-scroll-left': 'onScrollLeft',\n  'ps-scroll-right': 'onScrollRight',\n  'ps-y-reach-start': 'onYReachStart',\n  'ps-y-reach-end': 'onYReachEnd',\n  'ps-x-reach-start': 'onXReachStart',\n  'ps-x-reach-end': 'onXReachEnd'\n};\nObject.freeze(handlerNameByEvent);\n\nvar ScrollBar = function (_Component) {\n  _inherits(ScrollBar, _Component);\n\n  function ScrollBar(props) {\n    _classCallCheck(this, ScrollBar);\n\n    var _this = _possibleConstructorReturn(this, (ScrollBar.__proto__ || Object.getPrototypeOf(ScrollBar)).call(this, props));\n\n    _this.handleRef = _this.handleRef.bind(_this);\n    _this._handlerByEvent = {};\n    return _this;\n  }\n\n  _createClass(ScrollBar, [{\n    key: 'componentDidMount',\n    value: function componentDidMount() {\n      if (this.props.option) {\n        console.warn('react-perfect-scrollbar: the \"option\" prop has been deprecated in favor of \"options\"');\n      }\n\n      this._ps = new _perfectScrollbar2.default(this._container, this.props.options || this.props.option);\n      // hook up events\n      this._updateEventHook();\n      this._updateClassName();\n    }\n  }, {\n    key: 'componentDidUpdate',\n    value: function componentDidUpdate(prevProps) {\n      this._updateEventHook(prevProps);\n\n      this.updateScroll();\n\n      if (prevProps.className !== this.props.className) {\n        this._updateClassName();\n      }\n    }\n  }, {\n    key: 'componentWillUnmount',\n    value: function componentWillUnmount() {\n      var _this2 = this;\n\n      // unhook up evens\n      Object.keys(this._handlerByEvent).forEach(function (key) {\n        var value = _this2._handlerByEvent[key];\n\n        if (value) {\n          _this2._container.removeEventListener(key, value, false);\n        }\n      });\n      this._handlerByEvent = {};\n      this._ps.destroy();\n      this._ps = null;\n    }\n  }, {\n    key: '_updateEventHook',\n    value: function _updateEventHook() {\n      var _this3 = this;\n\n      var prevProps = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n      // hook up events\n      Object.keys(handlerNameByEvent).forEach(function (key) {\n        var callback = _this3.props[handlerNameByEvent[key]];\n        var prevCallback = prevProps[handlerNameByEvent[key]];\n        if (callback !== prevCallback) {\n          if (prevCallback) {\n            var prevHandler = _this3._handlerByEvent[key];\n            _this3._container.removeEventListener(key, prevHandler, false);\n            _this3._handlerByEvent[key] = null;\n          }\n          if (callback) {\n            var handler = function handler() {\n              return callback(_this3._container);\n            };\n            _this3._container.addEventListener(key, handler, false);\n            _this3._handlerByEvent[key] = handler;\n          }\n        }\n      });\n    }\n  }, {\n    key: '_updateClassName',\n    value: function _updateClassName() {\n      var className = this.props.className;\n\n\n      var psClassNames = this._container.className.split(' ').filter(function (name) {\n        return name.match(/^ps([-_].+|)$/);\n      }).join(' ');\n\n      if (this._container) {\n        this._container.className = 'scrollbar-container' + (className ? ' ' + className : '') + (psClassNames ? ' ' + psClassNames : '');\n      }\n    }\n  }, {\n    key: 'updateScroll',\n    value: function updateScroll() {\n      this.props.onSync(this._ps);\n    }\n  }, {\n    key: 'handleRef',\n    value: function handleRef(ref) {\n      this._container = ref;\n      this.props.containerRef(ref);\n    }\n  }, {\n    key: 'render',\n    value: function render() {\n      var _props = this.props,\n          className = _props.className,\n          style = _props.style,\n          option = _props.option,\n          options = _props.options,\n          containerRef = _props.containerRef,\n          onScrollY = _props.onScrollY,\n          onScrollX = _props.onScrollX,\n          onScrollUp = _props.onScrollUp,\n          onScrollDown = _props.onScrollDown,\n          onScrollLeft = _props.onScrollLeft,\n          onScrollRight = _props.onScrollRight,\n          onYReachStart = _props.onYReachStart,\n          onYReachEnd = _props.onYReachEnd,\n          onXReachStart = _props.onXReachStart,\n          onXReachEnd = _props.onXReachEnd,\n          component = _props.component,\n          onSync = _props.onSync,\n          children = _props.children,\n          remainProps = _objectWithoutProperties(_props, ['className', 'style', 'option', 'options', 'containerRef', 'onScrollY', 'onScrollX', 'onScrollUp', 'onScrollDown', 'onScrollLeft', 'onScrollRight', 'onYReachStart', 'onYReachEnd', 'onXReachStart', 'onXReachEnd', 'component', 'onSync', 'children']);\n\n      var Comp = component;\n\n      return _react2.default.createElement(\n        Comp,\n        _extends({ style: style, ref: this.handleRef }, remainProps),\n        children\n      );\n    }\n  }]);\n\n  return ScrollBar;\n}(_react.Component);\n\nexports.default = ScrollBar;\n\n\nScrollBar.defaultProps = {\n  className: '',\n  style: undefined,\n  option: undefined,\n  options: undefined,\n  containerRef: function containerRef() {},\n  onScrollY: undefined,\n  onScrollX: undefined,\n  onScrollUp: undefined,\n  onScrollDown: undefined,\n  onScrollLeft: undefined,\n  onScrollRight: undefined,\n  onYReachStart: undefined,\n  onYReachEnd: undefined,\n  onXReachStart: undefined,\n  onXReachEnd: undefined,\n  onSync: function onSync(ps) {\n    return ps.update();\n  },\n  component: 'div'\n};\n\nScrollBar.propTypes = {\n  children: _propTypes.PropTypes.node.isRequired,\n  className: _propTypes.PropTypes.string,\n  style: _propTypes.PropTypes.object,\n  option: _propTypes.PropTypes.object,\n  options: _propTypes.PropTypes.object,\n  containerRef: _propTypes.PropTypes.func,\n  onScrollY: _propTypes.PropTypes.func,\n  onScrollX: _propTypes.PropTypes.func,\n  onScrollUp: _propTypes.PropTypes.func,\n  onScrollDown: _propTypes.PropTypes.func,\n  onScrollLeft: _propTypes.PropTypes.func,\n  onScrollRight: _propTypes.PropTypes.func,\n  onYReachStart: _propTypes.PropTypes.func,\n  onYReachEnd: _propTypes.PropTypes.func,\n  onXReachStart: _propTypes.PropTypes.func,\n  onXReachEnd: _propTypes.PropTypes.func,\n  onSync: _propTypes.PropTypes.func,\n  component: _propTypes.PropTypes.string\n};\nmodule.exports = exports['default'];"],"names":[],"sourceRoot":""}